var tn,hn;function Tn(){return hn||(hn=1,tn=(function(e){var hr={};function h(b){if(hr[b])return hr[b].exports;var g=hr[b]={i:b,l:!1,exports:{}};return e[b].call(g.exports,g,g.exports,h),g.l=!0,g.exports}return h.m=e,h.c=hr,h.d=function(b,g,V){h.o(b,g)||Object.defineProperty(b,g,{enumerable:!0,get:V})},h.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})},h.t=function(b,g){if(1&g&&(b=h(b)),8&g||4&g&&typeof b=="object"&&b&&b.__esModule)return b;var V=Object.create(null);if(h.r(V),Object.defineProperty(V,"default",{enumerable:!0,value:b}),2&g&&typeof b!="string")for(var K in b)h.d(V,K,(function(_e){return b[_e]}).bind(null,K));return V},h.n=function(b){var g=b&&b.__esModule?function(){return b.default}:function(){return b};return h.d(g,"a",g),g},h.o=function(b,g){return Object.prototype.hasOwnProperty.call(b,g)},h.p="",h(h.s=34)})([function(e,hr,h){const b=h(5);e.exports.FENGARI_AUTHORS=b.FENGARI_AUTHORS,e.exports.FENGARI_COPYRIGHT=b.FENGARI_COPYRIGHT,e.exports.FENGARI_RELEASE=b.FENGARI_RELEASE,e.exports.FENGARI_VERSION=b.FENGARI_VERSION,e.exports.FENGARI_VERSION_MAJOR=b.FENGARI_VERSION_MAJOR,e.exports.FENGARI_VERSION_MINOR=b.FENGARI_VERSION_MINOR,e.exports.FENGARI_VERSION_NUM=b.FENGARI_VERSION_NUM,e.exports.FENGARI_VERSION_RELEASE=b.FENGARI_VERSION_RELEASE,e.exports.luastring_eq=b.luastring_eq,e.exports.luastring_indexOf=b.luastring_indexOf,e.exports.luastring_of=b.luastring_of,e.exports.to_jsstring=b.to_jsstring,e.exports.to_luastring=b.to_luastring,e.exports.to_uristring=b.to_uristring;const g=h(3),V=h(2),K=h(7),_e=h(17);e.exports.luaconf=g,e.exports.lua=V,e.exports.lauxlib=K,e.exports.lualib=_e},function(e,hr,h){let b,g,V;if(b=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(j){let se=0,$=j.length,Ve=new Uint8Array($);for(;$>se;)Ve[se]=j[se++];return Ve},typeof new Uint8Array().indexOf=="function")g=function(j,se,$){return j.indexOf(se,$)};else{let j=[].indexOf;if(j.call(new Uint8Array(1),0)!==0)throw Error("missing .indexOf");g=function(se,$,Ve){return j.call(se,$,Ve)}}V=typeof Uint8Array.of=="function"?Uint8Array.of.bind(Uint8Array):function(){return b(arguments)};const K=function(j){return j instanceof Uint8Array},_e="cannot convert invalid utf8 to javascript string",He=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce(function(j,se){return j[se.charCodeAt(0)]=!0,j},{}),H={},fe=function(j,se){if(typeof j!="string")throw new TypeError("to_luastring expects a javascript string");if(se){let Ge=H[j];if(K(Ge))return Ge}let $=j.length,Ve=Array($),ye=0;for(let Ge=0;Ge<$;++Ge){let Me=j.charCodeAt(Ge);if(Me<=127)Ve[ye++]=Me;else if(Me<=2047)Ve[ye++]=192|Me>>6,Ve[ye++]=128|63&Me;else{if(Me>=55296&&Me<=56319&&Ge+1<$){let Ye=j.charCodeAt(Ge+1);Ye>=56320&&Ye<=57343&&(Ge++,Me=1024*(Me-55296)+Ye+9216)}Me<=65535?(Ve[ye++]=224|Me>>12,Ve[ye++]=128|Me>>6&63,Ve[ye++]=128|63&Me):(Ve[ye++]=240|Me>>18,Ve[ye++]=128|Me>>12&63,Ve[ye++]=128|Me>>6&63,Ve[ye++]=128|63&Me)}}return Ve=b(Ve),se&&(H[j]=Ve),Ve};e.exports.luastring_from=b,e.exports.luastring_indexOf=g,e.exports.luastring_of=V,e.exports.is_luastring=K,e.exports.luastring_eq=function(j,se){if(j!==se){let $=j.length;if($!==se.length)return!1;for(let Ve=0;Ve<$;Ve++)if(j[Ve]!==se[Ve])return!1}return!0},e.exports.to_jsstring=function(j,se,$,Ve){if(!K(j))throw new TypeError("to_jsstring expects a Uint8Array");$=$===void 0?j.length:Math.min(j.length,$);let ye="";for(let Ge=se!==void 0?se:0;Ge<$;){let Me=j[Ge++];if(Me<128)ye+=String.fromCharCode(Me);else if(Me<194||Me>244){if(!Ve)throw RangeError(_e);ye+="�"}else if(Me<=223){if(Ge>=$){if(!Ve)throw RangeError(_e);ye+="�";continue}let Ye=j[Ge++];if((192&Ye)!=128){if(!Ve)throw RangeError(_e);ye+="�";continue}ye+=String.fromCharCode(((31&Me)<<6)+(63&Ye))}else if(Me<=239){if(Ge+1>=$){if(!Ve)throw RangeError(_e);ye+="�";continue}let Ye=j[Ge++];if((192&Ye)!=128){if(!Ve)throw RangeError(_e);ye+="�";continue}let x=j[Ge++];if((192&x)!=128){if(!Ve)throw RangeError(_e);ye+="�";continue}let w=((15&Me)<<12)+((63&Ye)<<6)+(63&x);if(w<=65535)ye+=String.fromCharCode(w);else{let Y=55296+((w-=65536)>>10),X=w%1024+56320;ye+=String.fromCharCode(Y,X)}}else{if(Ge+2>=$){if(!Ve)throw RangeError(_e);ye+="�";continue}let Ye=j[Ge++];if((192&Ye)!=128){if(!Ve)throw RangeError(_e);ye+="�";continue}let x=j[Ge++];if((192&x)!=128){if(!Ve)throw RangeError(_e);ye+="�";continue}let w=j[Ge++];if((192&w)!=128){if(!Ve)throw RangeError(_e);ye+="�";continue}let Y=((7&Me)<<18)+((63&Ye)<<12)+((63&x)<<6)+(63&w),X=55296+((Y-=65536)>>10),ee=Y%1024+56320;ye+=String.fromCharCode(X,ee)}}return ye},e.exports.to_uristring=function(j){if(!K(j))throw new TypeError("to_uristring expects a Uint8Array");let se="";for(let $=0;$<j.length;$++){let Ve=j[$];He[Ve]?se+=String.fromCharCode(Ve):se+="%"+(Ve<16?"0":"")+Ve.toString(16)}return se},e.exports.to_luastring=fe,e.exports.from_userstring=function(j){if(!K(j)){if(typeof j!="string")throw new TypeError("expects an array of bytes or javascript string");j=fe(j)}return j};const B=fe("\x1BLua");e.exports.LUA_SIGNATURE=B,e.exports.LUA_VERSION_MAJOR="5",e.exports.LUA_VERSION_MINOR="3",e.exports.LUA_VERSION_NUM=503,e.exports.LUA_VERSION_RELEASE="4",e.exports.LUA_VERSION="Lua 5.3",e.exports.LUA_RELEASE="Lua 5.3.4",e.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",e.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";const we={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};we.LUA_TSHRSTR=0|we.LUA_TSTRING,we.LUA_TLNGSTR=16|we.LUA_TSTRING,we.LUA_TNUMFLT=0|we.LUA_TNUMBER,we.LUA_TNUMINT=16|we.LUA_TNUMBER,we.LUA_TLCL=0|we.LUA_TFUNCTION,we.LUA_TLCF=16|we.LUA_TFUNCTION,we.LUA_TCCL=32|we.LUA_TFUNCTION;const{LUAI_MAXSTACK:pe}=h(3),he=-pe-1e3;e.exports.LUA_HOOKCALL=0,e.exports.LUA_HOOKCOUNT=3,e.exports.LUA_HOOKLINE=2,e.exports.LUA_HOOKRET=1,e.exports.LUA_HOOKTAILCALL=4,e.exports.LUA_MASKCALL=1,e.exports.LUA_MASKCOUNT=8,e.exports.LUA_MASKLINE=4,e.exports.LUA_MASKRET=2,e.exports.LUA_MINSTACK=20,e.exports.LUA_MULTRET=-1,e.exports.LUA_OPADD=0,e.exports.LUA_OPBAND=7,e.exports.LUA_OPBNOT=13,e.exports.LUA_OPBOR=8,e.exports.LUA_OPBXOR=9,e.exports.LUA_OPDIV=5,e.exports.LUA_OPEQ=0,e.exports.LUA_OPIDIV=6,e.exports.LUA_OPLE=2,e.exports.LUA_OPLT=1,e.exports.LUA_OPMOD=3,e.exports.LUA_OPMUL=2,e.exports.LUA_OPPOW=4,e.exports.LUA_OPSHL=10,e.exports.LUA_OPSHR=11,e.exports.LUA_OPSUB=1,e.exports.LUA_OPUNM=12,e.exports.LUA_REGISTRYINDEX=he,e.exports.LUA_RIDX_GLOBALS=2,e.exports.LUA_RIDX_LAST=2,e.exports.LUA_RIDX_MAINTHREAD=1,e.exports.constant_types=we,e.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},e.exports.lua_upvalueindex=function(j){return he-j},e.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(e,hr,h){const b=h(1),g=h(18),V=h(11),K=h(8),_e=h(12);e.exports.LUA_AUTHORS=b.LUA_AUTHORS,e.exports.LUA_COPYRIGHT=b.LUA_COPYRIGHT,e.exports.LUA_ERRERR=b.thread_status.LUA_ERRERR,e.exports.LUA_ERRGCMM=b.thread_status.LUA_ERRGCMM,e.exports.LUA_ERRMEM=b.thread_status.LUA_ERRMEM,e.exports.LUA_ERRRUN=b.thread_status.LUA_ERRRUN,e.exports.LUA_ERRSYNTAX=b.thread_status.LUA_ERRSYNTAX,e.exports.LUA_HOOKCALL=b.LUA_HOOKCALL,e.exports.LUA_HOOKCOUNT=b.LUA_HOOKCOUNT,e.exports.LUA_HOOKLINE=b.LUA_HOOKLINE,e.exports.LUA_HOOKRET=b.LUA_HOOKRET,e.exports.LUA_HOOKTAILCALL=b.LUA_HOOKTAILCALL,e.exports.LUA_MASKCALL=b.LUA_MASKCALL,e.exports.LUA_MASKCOUNT=b.LUA_MASKCOUNT,e.exports.LUA_MASKLINE=b.LUA_MASKLINE,e.exports.LUA_MASKRET=b.LUA_MASKRET,e.exports.LUA_MINSTACK=b.LUA_MINSTACK,e.exports.LUA_MULTRET=b.LUA_MULTRET,e.exports.LUA_NUMTAGS=b.constant_types.LUA_NUMTAGS,e.exports.LUA_OK=b.thread_status.LUA_OK,e.exports.LUA_OPADD=b.LUA_OPADD,e.exports.LUA_OPBAND=b.LUA_OPBAND,e.exports.LUA_OPBNOT=b.LUA_OPBNOT,e.exports.LUA_OPBOR=b.LUA_OPBOR,e.exports.LUA_OPBXOR=b.LUA_OPBXOR,e.exports.LUA_OPDIV=b.LUA_OPDIV,e.exports.LUA_OPEQ=b.LUA_OPEQ,e.exports.LUA_OPIDIV=b.LUA_OPIDIV,e.exports.LUA_OPLE=b.LUA_OPLE,e.exports.LUA_OPLT=b.LUA_OPLT,e.exports.LUA_OPMOD=b.LUA_OPMOD,e.exports.LUA_OPMUL=b.LUA_OPMUL,e.exports.LUA_OPPOW=b.LUA_OPPOW,e.exports.LUA_OPSHL=b.LUA_OPSHL,e.exports.LUA_OPSHR=b.LUA_OPSHR,e.exports.LUA_OPSUB=b.LUA_OPSUB,e.exports.LUA_OPUNM=b.LUA_OPUNM,e.exports.LUA_REGISTRYINDEX=b.LUA_REGISTRYINDEX,e.exports.LUA_RELEASE=b.LUA_RELEASE,e.exports.LUA_RIDX_GLOBALS=b.LUA_RIDX_GLOBALS,e.exports.LUA_RIDX_LAST=b.LUA_RIDX_LAST,e.exports.LUA_RIDX_MAINTHREAD=b.LUA_RIDX_MAINTHREAD,e.exports.LUA_SIGNATURE=b.LUA_SIGNATURE,e.exports.LUA_TNONE=b.constant_types.LUA_TNONE,e.exports.LUA_TNIL=b.constant_types.LUA_TNIL,e.exports.LUA_TBOOLEAN=b.constant_types.LUA_TBOOLEAN,e.exports.LUA_TLIGHTUSERDATA=b.constant_types.LUA_TLIGHTUSERDATA,e.exports.LUA_TNUMBER=b.constant_types.LUA_TNUMBER,e.exports.LUA_TSTRING=b.constant_types.LUA_TSTRING,e.exports.LUA_TTABLE=b.constant_types.LUA_TTABLE,e.exports.LUA_TFUNCTION=b.constant_types.LUA_TFUNCTION,e.exports.LUA_TUSERDATA=b.constant_types.LUA_TUSERDATA,e.exports.LUA_TTHREAD=b.constant_types.LUA_TTHREAD,e.exports.LUA_VERSION=b.LUA_VERSION,e.exports.LUA_VERSION_MAJOR=b.LUA_VERSION_MAJOR,e.exports.LUA_VERSION_MINOR=b.LUA_VERSION_MINOR,e.exports.LUA_VERSION_NUM=b.LUA_VERSION_NUM,e.exports.LUA_VERSION_RELEASE=b.LUA_VERSION_RELEASE,e.exports.LUA_YIELD=b.thread_status.LUA_YIELD,e.exports.lua_Debug=b.lua_Debug,e.exports.lua_upvalueindex=b.lua_upvalueindex,e.exports.lua_absindex=g.lua_absindex,e.exports.lua_arith=g.lua_arith,e.exports.lua_atpanic=g.lua_atpanic,e.exports.lua_atnativeerror=g.lua_atnativeerror,e.exports.lua_call=g.lua_call,e.exports.lua_callk=g.lua_callk,e.exports.lua_checkstack=g.lua_checkstack,e.exports.lua_close=_e.lua_close,e.exports.lua_compare=g.lua_compare,e.exports.lua_concat=g.lua_concat,e.exports.lua_copy=g.lua_copy,e.exports.lua_createtable=g.lua_createtable,e.exports.lua_dump=g.lua_dump,e.exports.lua_error=g.lua_error,e.exports.lua_gc=g.lua_gc,e.exports.lua_getallocf=g.lua_getallocf,e.exports.lua_getextraspace=g.lua_getextraspace,e.exports.lua_getfield=g.lua_getfield,e.exports.lua_getglobal=g.lua_getglobal,e.exports.lua_gethook=V.lua_gethook,e.exports.lua_gethookcount=V.lua_gethookcount,e.exports.lua_gethookmask=V.lua_gethookmask,e.exports.lua_geti=g.lua_geti,e.exports.lua_getinfo=V.lua_getinfo,e.exports.lua_getlocal=V.lua_getlocal,e.exports.lua_getmetatable=g.lua_getmetatable,e.exports.lua_getstack=V.lua_getstack,e.exports.lua_gettable=g.lua_gettable,e.exports.lua_gettop=g.lua_gettop,e.exports.lua_getupvalue=g.lua_getupvalue,e.exports.lua_getuservalue=g.lua_getuservalue,e.exports.lua_insert=g.lua_insert,e.exports.lua_isboolean=g.lua_isboolean,e.exports.lua_iscfunction=g.lua_iscfunction,e.exports.lua_isfunction=g.lua_isfunction,e.exports.lua_isinteger=g.lua_isinteger,e.exports.lua_islightuserdata=g.lua_islightuserdata,e.exports.lua_isnil=g.lua_isnil,e.exports.lua_isnone=g.lua_isnone,e.exports.lua_isnoneornil=g.lua_isnoneornil,e.exports.lua_isnumber=g.lua_isnumber,e.exports.lua_isproxy=g.lua_isproxy,e.exports.lua_isstring=g.lua_isstring,e.exports.lua_istable=g.lua_istable,e.exports.lua_isthread=g.lua_isthread,e.exports.lua_isuserdata=g.lua_isuserdata,e.exports.lua_isyieldable=K.lua_isyieldable,e.exports.lua_len=g.lua_len,e.exports.lua_load=g.lua_load,e.exports.lua_newstate=_e.lua_newstate,e.exports.lua_newtable=g.lua_newtable,e.exports.lua_newthread=_e.lua_newthread,e.exports.lua_newuserdata=g.lua_newuserdata,e.exports.lua_next=g.lua_next,e.exports.lua_pcall=g.lua_pcall,e.exports.lua_pcallk=g.lua_pcallk,e.exports.lua_pop=g.lua_pop,e.exports.lua_pushboolean=g.lua_pushboolean,e.exports.lua_pushcclosure=g.lua_pushcclosure,e.exports.lua_pushcfunction=g.lua_pushcfunction,e.exports.lua_pushfstring=g.lua_pushfstring,e.exports.lua_pushglobaltable=g.lua_pushglobaltable,e.exports.lua_pushinteger=g.lua_pushinteger,e.exports.lua_pushjsclosure=g.lua_pushjsclosure,e.exports.lua_pushjsfunction=g.lua_pushjsfunction,e.exports.lua_pushlightuserdata=g.lua_pushlightuserdata,e.exports.lua_pushliteral=g.lua_pushliteral,e.exports.lua_pushlstring=g.lua_pushlstring,e.exports.lua_pushnil=g.lua_pushnil,e.exports.lua_pushnumber=g.lua_pushnumber,e.exports.lua_pushstring=g.lua_pushstring,e.exports.lua_pushthread=g.lua_pushthread,e.exports.lua_pushvalue=g.lua_pushvalue,e.exports.lua_pushvfstring=g.lua_pushvfstring,e.exports.lua_rawequal=g.lua_rawequal,e.exports.lua_rawget=g.lua_rawget,e.exports.lua_rawgeti=g.lua_rawgeti,e.exports.lua_rawgetp=g.lua_rawgetp,e.exports.lua_rawlen=g.lua_rawlen,e.exports.lua_rawset=g.lua_rawset,e.exports.lua_rawseti=g.lua_rawseti,e.exports.lua_rawsetp=g.lua_rawsetp,e.exports.lua_register=g.lua_register,e.exports.lua_remove=g.lua_remove,e.exports.lua_replace=g.lua_replace,e.exports.lua_resume=K.lua_resume,e.exports.lua_rotate=g.lua_rotate,e.exports.lua_setallof=K.lua_setallof,e.exports.lua_setfield=g.lua_setfield,e.exports.lua_setglobal=g.lua_setglobal,e.exports.lua_sethook=V.lua_sethook,e.exports.lua_seti=g.lua_seti,e.exports.lua_setlocal=V.lua_setlocal,e.exports.lua_setmetatable=g.lua_setmetatable,e.exports.lua_settable=g.lua_settable,e.exports.lua_settop=g.lua_settop,e.exports.lua_setupvalue=g.lua_setupvalue,e.exports.lua_setuservalue=g.lua_setuservalue,e.exports.lua_status=g.lua_status,e.exports.lua_stringtonumber=g.lua_stringtonumber,e.exports.lua_toboolean=g.lua_toboolean,e.exports.lua_todataview=g.lua_todataview,e.exports.lua_tointeger=g.lua_tointeger,e.exports.lua_tointegerx=g.lua_tointegerx,e.exports.lua_tojsstring=g.lua_tojsstring,e.exports.lua_tolstring=g.lua_tolstring,e.exports.lua_tonumber=g.lua_tonumber,e.exports.lua_tonumberx=g.lua_tonumberx,e.exports.lua_topointer=g.lua_topointer,e.exports.lua_toproxy=g.lua_toproxy,e.exports.lua_tostring=g.lua_tostring,e.exports.lua_tothread=g.lua_tothread,e.exports.lua_touserdata=g.lua_touserdata,e.exports.lua_type=g.lua_type,e.exports.lua_typename=g.lua_typename,e.exports.lua_upvalueid=g.lua_upvalueid,e.exports.lua_upvaluejoin=g.lua_upvaluejoin,e.exports.lua_version=g.lua_version,e.exports.lua_xmove=g.lua_xmove,e.exports.lua_yield=K.lua_yield,e.exports.lua_yieldk=K.lua_yieldk,e.exports.lua_tocfunction=g.lua_tocfunction},function(e,hr,h){const b={},{LUA_VERSION_MAJOR:g,LUA_VERSION_MINOR:V,to_luastring:K}=h(1);e.exports.LUA_PATH_SEP=";",e.exports.LUA_PATH_MARK="?",e.exports.LUA_EXEC_DIR="!";const _e=g+"."+V;e.exports.LUA_VDIR=_e;{e.exports.LUA_DIRSEP="/";const he="./lua/"+_e+"/";e.exports.LUA_LDIR=he;const j=he;e.exports.LUA_JSDIR=j;const se=K(he+"?.lua;"+he+"?/init.lua;./?.lua;./?/init.lua");e.exports.LUA_PATH_DEFAULT=se;const $=K(j+"?.js;"+j+"loadall.js;./?.js");e.exports.LUA_JSPATH_DEFAULT=$}const He=b.LUA_COMPAT_FLOATSTRING||!1,H=b.LUAI_MAXSTACK||1e6,fe=b.LUA_IDSIZE||59,B=b.LUAL_BUFFERSIZE||8192,we=function(pe,he){for(var j=Math.min(3,Math.ceil(Math.abs(he)/1023)),se=pe,$=0;$<j;$++)se*=Math.pow(2,Math.floor((he+$)/j));return se};e.exports.LUAI_MAXSTACK=H,e.exports.LUA_COMPAT_FLOATSTRING=He,e.exports.LUA_IDSIZE=fe,e.exports.LUA_INTEGER_FMT="%d",e.exports.LUA_INTEGER_FRMLEN="",e.exports.LUA_MAXINTEGER=2147483647,e.exports.LUA_MININTEGER=-2147483648,e.exports.LUA_NUMBER_FMT="%.14g",e.exports.LUA_NUMBER_FRMLEN="",e.exports.LUAL_BUFFERSIZE=B,e.exports.frexp=function(pe){if(pe===0)return[pe,0];var he=new DataView(new ArrayBuffer(8));he.setFloat64(0,pe);var j=he.getUint32(0)>>>20&2047;j===0&&(he.setFloat64(0,pe*Math.pow(2,64)),j=(he.getUint32(0)>>>20&2047)-64);var se=j-1022;return[we(pe,-se),se]},e.exports.ldexp=we,e.exports.lua_getlocaledecpoint=function(){return 46},e.exports.lua_integer2str=function(pe){return String(pe)},e.exports.lua_number2str=function(pe){return String(Number(pe.toPrecision(14)))},e.exports.lua_numbertointeger=function(pe){return pe>=-2147483648&&pe<2147483648&&pe},e.exports.luai_apicheck=function(pe,he){if(!he)throw Error(he)}},function(e,hr,h){const{luai_apicheck:b}=h(3),g=function(V){if(!V)throw Error("assertion failed")};e.exports.lua_assert=g,e.exports.luai_apicheck=b||function(V,K){return g(K)},e.exports.api_check=function(V,K,_e){return b(V,K&&_e)},e.exports.LUAI_MAXCCALLS=200,e.exports.LUA_MINBUFFER=32,e.exports.luai_nummod=function(V,K,_e){let He=K%_e;return He*_e<0&&(He+=_e),He},e.exports.MAX_INT=2147483647,e.exports.MIN_INT=-2147483648},function(e,hr,h){const b=h(1),g=`Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator
Based on: `+b.LUA_COPYRIGHT;e.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",e.exports.FENGARI_COPYRIGHT=g,e.exports.FENGARI_RELEASE="Fengari 0.1.4",e.exports.FENGARI_VERSION="Fengari 0.1",e.exports.FENGARI_VERSION_MAJOR="0",e.exports.FENGARI_VERSION_MINOR="1",e.exports.FENGARI_VERSION_NUM=1,e.exports.FENGARI_VERSION_RELEASE="4",e.exports.is_luastring=b.is_luastring,e.exports.luastring_eq=b.luastring_eq,e.exports.luastring_from=b.luastring_from,e.exports.luastring_indexOf=b.luastring_indexOf,e.exports.luastring_of=b.luastring_of,e.exports.to_jsstring=b.to_jsstring,e.exports.to_luastring=b.to_luastring,e.exports.to_uristring=b.to_uristring,e.exports.from_userstring=b.from_userstring},function(e,hr,h){const{LUA_OPADD:b,LUA_OPBAND:g,LUA_OPBNOT:V,LUA_OPBOR:K,LUA_OPBXOR:_e,LUA_OPDIV:He,LUA_OPIDIV:H,LUA_OPMOD:fe,LUA_OPMUL:B,LUA_OPPOW:we,LUA_OPSHL:pe,LUA_OPSHR:he,LUA_OPSUB:j,LUA_OPUNM:se,constant_types:{LUA_NUMTAGS:$,LUA_TBOOLEAN:Ve,LUA_TCCL:ye,LUA_TFUNCTION:Ge,LUA_TLCF:Me,LUA_TLCL:Ye,LUA_TLIGHTUSERDATA:x,LUA_TLNGSTR:w,LUA_TNIL:Y,LUA_TNUMBER:X,LUA_TNUMFLT:ee,LUA_TNUMINT:Ne,LUA_TSHRSTR:Ke,LUA_TSTRING:je,LUA_TTABLE:I,LUA_TTHREAD:Z,LUA_TUSERDATA:me},from_userstring:W,luastring_indexOf:Fe,luastring_of:d,to_jsstring:k,to_luastring:U}=h(1),{lisdigit:oe,lisprint:ce,lisspace:nr,lisxdigit:ze}=h(22),rr=h(11),tr=h(8),R=h(12),{luaS_bless:N,luaS_new:de}=h(10),q=h(9),{LUA_COMPAT_FLOATSTRING:Re,ldexp:ar,lua_integer2str:Je,lua_number2str:ke}=h(3),S=h(15),{MAX_INT:ue,luai_nummod:p,lua_assert:F}=h(4),Le=h(14),A=$,z=$+1;class le{constructor(n,l){this.type=n,this.value=l}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(n){return this.type===n}checktype(n){return this.ttnov()===n}ttisnumber(){return this.checktype(X)}ttisfloat(){return this.checktag(ee)}ttisinteger(){return this.checktag(Ne)}ttisnil(){return this.checktag(Y)}ttisboolean(){return this.checktag(Ve)}ttislightuserdata(){return this.checktag(x)}ttisstring(){return this.checktype(je)}ttisshrstring(){return this.checktag(Ke)}ttislngstring(){return this.checktag(w)}ttistable(){return this.checktag(I)}ttisfunction(){return this.checktype(Ge)}ttisclosure(){return(31&this.type)===Ge}ttisCclosure(){return this.checktag(ye)}ttisLclosure(){return this.checktag(Ye)}ttislcf(){return this.checktag(Me)}ttisfulluserdata(){return this.checktag(me)}ttisthread(){return this.checktag(Z)}ttisdeadkey(){return this.checktag(z)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&this.value===!1}setfltvalue(n){this.type=ee,this.value=n}chgfltvalue(n){F(this.type==ee),this.value=n}setivalue(n){this.type=Ne,this.value=n}chgivalue(n){F(this.type==Ne),this.value=n}setnilvalue(){this.type=Y,this.value=null}setfvalue(n){this.type=Me,this.value=n}setpvalue(n){this.type=x,this.value=n}setbvalue(n){this.type=Ve,this.value=n}setsvalue(n){this.type=w,this.value=n}setuvalue(n){this.type=me,this.value=n}setthvalue(n){this.type=Z,this.value=n}setclLvalue(n){this.type=Ye,this.value=n}setclCvalue(n){this.type=ye,this.value=n}sethvalue(n){this.type=I,this.value=n}setdeadvalue(){this.type=z,this.value=null}setfrom(n){this.type=n.type,this.value=n.value}tsvalue(){return F(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(n,l){return k(this.svalue(),n,l,!0)}}const sr=function(r,n,l){r.stack[n].setsvalue(l)},or=new le(Y,null);Object.freeze(or),e.exports.luaO_nilobject=or;class ir{constructor(n,l){this.id=n.l_G.id_counter++,this.p=null,this.nupvalues=l,this.upvals=new Array(l)}}class Ur{constructor(n,l,a){for(this.id=n.l_G.id_counter++,this.f=l,this.nupvalues=a,this.upvalue=new Array(a);a--;)this.upvalue[a]=new le(Y,null)}}class Sr{constructor(n,l){this.id=n.l_G.id_counter++,this.metatable=null,this.uservalue=new le(Y,null),this.len=l,this.data=Object.create(null)}}const Rr=U("..."),Cr=U('[string "'),_=U('"]'),Oe=function(r){return oe(r)?r-48:(223&r)-55},be=function(r,n){let l=1;if(F(n<=1114111),n<128)r[7]=n;else{let a=63;do r[8-l++]=128|63&n,n>>=6,a>>=1;while(n>a);r[8-l]=~a<<1|n}return l},ge=function(r,n){let l=n==="x"?(function(a){let u,f=0,s=0,m=0,xe=0,Be=0,Ar=!1;for(;nr(a[f]);)f++;if(((u=a[f]===45)||a[f]===43)&&f++,a[f]!==48||a[f+1]!==120&&a[f+1]!==88)return null;for(f+=2;;f++)if(a[f]===46){if(Ar)break;Ar=!0}else{if(!ze(a[f]))break;m===0&&a[f]===48?xe++:++m<=30?s=16*s+Oe(a[f]):Be++,Ar&&Be--}if(xe+m===0)return null;if(Be*=4,a[f]===112||a[f]===80){let Tr,y=0;if(((Tr=a[++f]===45)||a[f]===43)&&f++,!oe(a[f]))return null;for(;oe(a[f]);)y=10*y+a[f++]-48;Tr&&(y=-y),Be+=y}return u&&(s=-s),{n:ar(s,Be),i:f}})(r):(function(a){try{a=k(a)}catch{return null}let u=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(a);if(!u)return null;let f=parseFloat(u[0]);return isNaN(f)?null:{n:f,i:u[0].length}})(r);if(l===null)return null;for(;nr(r[l.i]);)l.i++;return l.i===r.length||r[l.i]===0?l:null},ae=[46,120,88,110,78],ie={46:".",120:"x",88:"x",110:"n",78:"n"},Ce=Math.floor(ue/10),Lr=ue%10,dr=function(r,n){let l;if(n.ttisinteger())l=U(Je(n.value));else{let a=ke(n.value);!Re&&/^[-0123456789]+$/.test(a)&&(a+=".0"),l=U(a)}n.setsvalue(N(r,l))},xr=function(r,n){tr.luaD_inctop(r),sr(r,r.top-1,de(r,n))},Mr=function(r,n,l){let a,u=0,f=0,s=0;for(;(a=Fe(n,37,f))!=-1;){switch(xr(r,n.subarray(f,a)),n[a+1]){case 115:{let m=l[s++];if(m===null)m=U("(null)",!0);else{m=W(m);let xe=Fe(m,0);xe!==-1&&(m=m.subarray(0,xe))}xr(r,m);break}case 99:{let m=l[s++];ce(m)?xr(r,d(m)):Qe(r,U("<\\%d>",!0),m);break}case 100:case 73:tr.luaD_inctop(r),r.stack[r.top-1].setivalue(l[s++]),dr(r,r.stack[r.top-1]);break;case 102:tr.luaD_inctop(r),r.stack[r.top-1].setfltvalue(l[s++]),dr(r,r.stack[r.top-1]);break;case 112:{let m=l[s++];if(m instanceof R.lua_State||m instanceof q.Table||m instanceof Sr||m instanceof ir||m instanceof Ur)xr(r,U("0x"+m.id.toString(16)));else switch(typeof m){case"undefined":xr(r,U("undefined"));break;case"number":xr(r,U("Number("+m+")"));break;case"string":xr(r,U("String("+JSON.stringify(m)+")"));break;case"boolean":xr(r,U(m?"Boolean(true)":"Boolean(false)"));break;case"object":if(m===null){xr(r,U("null"));break}case"function":{let xe=r.l_G.ids.get(m);xe||(xe=r.l_G.id_counter++,r.l_G.ids.set(m,xe)),xr(r,U("0x"+xe.toString(16)));break}default:xr(r,U("<id NYI>"))}break}case 85:{let m=new Uint8Array(8),xe=be(m,l[s++]);xr(r,m.subarray(8-xe));break}case 37:xr(r,U("%",!0));break;default:rr.luaG_runerror(r,U("invalid option '%%%c' to 'lua_pushfstring'"),n[a+1])}u+=2,f=a+2}return tr.luaD_checkstack(r,1),xr(r,n.subarray(f)),u>0&&S.luaV_concat(r,u+1),r.stack[r.top-1].svalue()},Qe=function(r,n,...l){return Mr(r,n,l)},lr=function(r,n,l,a){switch(n){case b:return l+a|0;case j:return l-a|0;case B:return S.luaV_imul(l,a);case fe:return S.luaV_mod(r,l,a);case H:return S.luaV_div(r,l,a);case g:return l&a;case K:return l|a;case _e:return l^a;case pe:return S.luaV_shiftl(l,a);case he:return S.luaV_shiftl(l,-a);case se:return 0-l|0;case V:return-1^l;default:F(0)}},br=function(r,n,l,a){switch(n){case b:return l+a;case j:return l-a;case B:return l*a;case He:return l/a;case we:return Math.pow(l,a);case H:return Math.floor(l/a);case se:return-l;case fe:return p(r,l,a);default:F(0)}};e.exports.CClosure=Ur,e.exports.LClosure=ir,e.exports.LUA_TDEADKEY=z,e.exports.LUA_TPROTO=A,e.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},e.exports.TValue=le,e.exports.Udata=Sr,e.exports.UTF8BUFFSZ=8,e.exports.luaO_arith=function(r,n,l,a,u){let f=typeof u=="number"?r.stack[u]:u;switch(n){case g:case K:case _e:case pe:case he:case V:{let s,m;if((s=S.tointeger(l))!==!1&&(m=S.tointeger(a))!==!1)return void f.setivalue(lr(r,n,s,m));break}case He:case we:{let s,m;if((s=S.tonumber(l))!==!1&&(m=S.tonumber(a))!==!1)return void f.setfltvalue(br(r,n,s,m));break}default:{let s,m;if(l.ttisinteger()&&a.ttisinteger())return void f.setivalue(lr(r,n,l.value,a.value));if((s=S.tonumber(l))!==!1&&(m=S.tonumber(a))!==!1)return void f.setfltvalue(br(r,n,s,m));break}}F(r!==null),Le.luaT_trybinTM(r,l,a,u,n-b+Le.TMS.TM_ADD)},e.exports.luaO_chunkid=function(r,n){let l,a=r.length;if(r[0]===61)a<n?(l=new Uint8Array(a-1)).set(r.subarray(1)):(l=new Uint8Array(n)).set(r.subarray(1,n+1));else if(r[0]===64)a<=n?(l=new Uint8Array(a-1)).set(r.subarray(1)):((l=new Uint8Array(n)).set(Rr),n-=Rr.length,l.set(r.subarray(a-n),Rr.length));else{l=new Uint8Array(n);let u=Fe(r,10);l.set(Cr);let f=Cr.length;a<(n-=Cr.length+Rr.length+_.length)&&u===-1?(l.set(r,f),f+=r.length):(u!==-1&&(a=u),a>n&&(a=n),l.set(r.subarray(0,a),f),f+=a,l.set(Rr,f),f+=Rr.length),l.set(_,f),f+=_.length,l=l.subarray(0,f)}return l},e.exports.luaO_hexavalue=Oe,e.exports.luaO_int2fb=function(r){let n=0;if(r<8)return r;for(;r>=128;)r=r+15>>4,n+=4;for(;r>=16;)r=r+1>>1,n++;return n+1<<3|r-8},e.exports.luaO_pushfstring=Qe,e.exports.luaO_pushvfstring=Mr,e.exports.luaO_str2num=function(r,n){let l=(function(a){let u,f=0,s=0,m=!0;for(;nr(a[f]);)f++;if(((u=a[f]===45)||a[f]===43)&&f++,a[f]!==48||a[f+1]!==120&&a[f+1]!==88)for(;f<a.length&&oe(a[f]);f++){let xe=a[f]-48;if(s>=Ce&&(s>Ce||xe>Lr+u))return null;s=10*s+xe|0,m=!1}else for(f+=2;f<a.length&&ze(a[f]);f++)s=16*s+Oe(a[f])|0,m=!1;for(;f<a.length&&nr(a[f]);)f++;return m||f!==a.length&&a[f]!==0?null:{n:0|(u?-s:s),i:f}})(r);return l!==null?(n.setivalue(l.n),l.i+1):(l=(function(a){let u=a.length,f=0;for(let m=0;m<u;m++){let xe=a[m];if(ae.indexOf(xe)!==-1){f=xe;break}}let s=ie[f];return s==="n"?null:ge(a,s)})(r))!==null?(n.setfltvalue(l.n),l.i+1):0},e.exports.luaO_tostring=dr,e.exports.luaO_utf8esc=be,e.exports.numarith=br,e.exports.pushobj2s=function(r,n){r.stack[r.top++]=new le(n.type,n.value)},e.exports.pushsvalue2s=function(r,n){r.stack[r.top++]=new le(w,n)},e.exports.setobjs2s=function(r,n,l){r.stack[n].setfrom(r.stack[l])},e.exports.setobj2s=function(r,n,l){r.stack[n].setfrom(l)},e.exports.setsvalue2s=sr},function(e,hr,h){const{LUAL_BUFFERSIZE:b}=h(3),{LUA_ERRERR:g,LUA_MULTRET:V,LUA_REGISTRYINDEX:K,LUA_SIGNATURE:_e,LUA_TBOOLEAN:He,LUA_TLIGHTUSERDATA:H,LUA_TNIL:fe,LUA_TNONE:B,LUA_TNUMBER:we,LUA_TSTRING:pe,LUA_TTABLE:he,LUA_VERSION_NUM:j,lua_Debug:se,lua_absindex:$,lua_atpanic:Ve,lua_call:ye,lua_checkstack:Ge,lua_concat:Me,lua_copy:Ye,lua_createtable:x,lua_error:w,lua_getfield:Y,lua_getinfo:X,lua_getmetatable:ee,lua_getstack:Ne,lua_gettop:Ke,lua_insert:je,lua_isinteger:I,lua_isnil:Z,lua_isnumber:me,lua_isstring:W,lua_istable:Fe,lua_len:d,lua_load:k,lua_newstate:U,lua_newtable:oe,lua_next:ce,lua_pcall:nr,lua_pop:ze,lua_pushboolean:rr,lua_pushcclosure:tr,lua_pushcfunction:R,lua_pushfstring:N,lua_pushinteger:de,lua_pushliteral:q,lua_pushlstring:Re,lua_pushnil:ar,lua_pushstring:Je,lua_pushvalue:ke,lua_pushvfstring:S,lua_rawequal:ue,lua_rawget:p,lua_rawgeti:F,lua_rawlen:Le,lua_rawseti:A,lua_remove:z,lua_setfield:le,lua_setglobal:sr,lua_setmetatable:or,lua_settop:ir,lua_toboolean:Ur,lua_tointeger:Sr,lua_tointegerx:Rr,lua_tojsstring:Cr,lua_tolstring:_,lua_tonumber:Oe,lua_tonumberx:be,lua_topointer:ge,lua_tostring:ae,lua_touserdata:ie,lua_type:Ce,lua_typename:Lr,lua_version:dr}=h(2),{from_userstring:xr,luastring_eq:Mr,to_luastring:Qe,to_uristring:lr}=h(5),br=g+1,r=Qe("_LOADED"),n=Qe("_PRELOAD"),l=Qe("FILE*"),a=Qe("__name"),u=Qe("__tostring"),f=new Uint8Array(0);class s{constructor(){this.L=null,this.b=f,this.n=0}}const m=function(o,T,Q){if(Q===0||!Fe(o,-1))return 0;for(ar(o);ce(o,-2);){if(Ce(o,-2)===pe){if(ue(o,T,-1))return ze(o,1),1;if(m(o,T,Q-1))return z(o,-2),q(o,"."),je(o,-2),Me(o,3),1}ze(o,1)}return 0},xe=function(o,T){let Q=Ke(o);if(X(o,Qe("f"),T),Y(o,K,r),m(o,Q+1,2)){let qe=ae(o,-1);return qe[0]===95&&qe[1]===71&&qe[2]===46&&(Je(o,qe.subarray(3)),z(o,-2)),Ye(o,-1,Q+1),ze(o,2),1}return ir(o,Q),0},Be=function(o,T){xe(o,T)?(N(o,Qe("function '%s'"),ae(o,-1)),z(o,-2)):T.namewhat.length!==0?N(o,Qe("%s '%s'"),T.namewhat,T.name):T.what&&T.what[0]===109?q(o,"main chunk"):T.what&&T.what[0]===76?N(o,Qe("function <%s:%d>"),T.short_src,T.linedefined):q(o,"?")},Ar=function(o){let T="PANIC: unprotected error in call to Lua API ("+Cr(o,-1)+")";throw new Error(T)},Tr=function(o,T,Q){let qe=new se;return Ne(o,0,qe)?(X(o,Qe("n"),qe),Mr(qe.namewhat,Qe("method"))&&--T===0?L(o,Qe("calling '%s' on bad self (%s)"),qe.name,Q):(qe.name===null&&(qe.name=xe(o,qe)?ae(o,-1):Qe("?")),L(o,Qe("bad argument #%d to '%s' (%s)"),T,qe.name,Q))):L(o,Qe("bad argument #%d (%s)"),T,Q)},y=function(o,T,Q){let qe;qe=ve(o,T,a)===pe?ae(o,-1):Ce(o,T)===H?Qe("light userdata",!0):_r(o,T);let Or=N(o,Qe("%s expected, got %s"),Q,qe);return Tr(o,T,Or)},Ue=function(o,T){let Q=new se;Ne(o,T,Q)&&(X(o,Qe("Sl",!0),Q),Q.currentline>0)?N(o,Qe("%s:%d: "),Q.short_src,Q.currentline):Je(o,Qe(""))},L=function(o,T,...Q){return Ue(o,1),S(o,T,Q),Me(o,2),w(o)},ne=function(o,T,Q,qe){if(T)return rr(o,1),1;{let Or,yr;return ar(o),qe?(Or=qe.message,yr=-qe.errno):(Or="Success",yr=0),Q?N(o,Qe("%s: %s"),Q,Qe(Or)):Je(o,Qe(Or)),de(o,yr),3}},M=function(o,T){return Y(o,K,T)},Pe=function(o,T,Q){let qe=ie(o,T);return qe!==null&&ee(o,T)?(M(o,Q),ue(o,-1,-2)||(qe=null),ze(o,2),qe):null},cr=function(o,T,Q){y(o,T,Lr(o,Q))},_r=function(o,T){return Lr(o,Ce(o,T))},ur=function(o,T){let Q=_(o,T);return Q!=null||cr(o,T,pe),Q},kr=ur,Vr=function(o,T,Q){return Ce(o,T)<=0?Q===null?null:xr(Q):ur(o,T)},pr=Vr,Er=function(o,T){let Q=be(o,T);return Q===!1&&cr(o,T,we),Q},vr=function(o,T){let Q=Rr(o,T);return Q===!1&&(function(qe,Or){me(qe,Or)?Tr(qe,Or,Qe("number has no integer representation",!0)):cr(qe,Or,we)})(o,T),Q},wr=function(o,T){let Q=o.n+T;if(o.b.length<Q){let qe=Math.max(2*o.b.length,Q),Or=new Uint8Array(qe);Or.set(o.b),o.b=Or}return o.b.subarray(o.n,Q)},Ir=function(o,T){T.L=o,T.b=f},Fr=function(o,T,Q){Q>0&&(T=xr(T),wr(o,Q).set(T.subarray(0,Q)),Gr(o,Q))},Dr=function(o,T){T=xr(T),Fr(o,T,T.length)},jr=function(o){Re(o.L,o.b,o.n),o.n=0,o.b=f},Gr=function(o,T){o.n+=T},c=function(o,T,Q,qe){return Ce(o,Q)<=0?qe:T(o,Q)},P=function(o,T){let Q=T.string;return T.string=null,Q},Ee=function(o,T,Q,qe,Or){return k(o,P,{string:T},qe,Or)},Ie=function(o,T,Q,qe){return Ee(o,T,0,qe,null)},Ze=function(o,T){return Ie(o,T,T.length,T)},ve=function(o,T,Q){if(ee(o,T)){Je(o,Q);let qe=p(o,-2);return qe===fe?ze(o,2):z(o,-2),qe}return fe},Se=function(o,T,Q){return T=$(o,T),ve(o,T,Q)!==fe&&(ke(o,T),ye(o,1,1),!0)},Ae=Qe("%I"),Xe=Qe("%f"),er=function(o,T,Q){var qe=Q>>>0,Or=T.length,yr=o.length+1-Or;e:for(;qe<yr;qe++){for(let Kr=0;Kr<Or;Kr++)if(o[qe+Kr]!==T[Kr])continue e;return qe}return-1},t=function(o,T,Q){return Y(o,T,Q)===he||(ze(o,1),T=$(o,T),oe(o),ke(o,-1),le(o,T,Q),!1)},v=function(o,T,Q){O(o,Q,Qe("too many upvalues",!0));for(let qe in T){for(let Or=0;Or<Q;Or++)ke(o,-Q);tr(o,T[qe],Q),le(o,-(Q+2),Qe(qe))}ze(o,Q)},O=function(o,T,Q){Ge(o,T)||(Q?L(o,Qe("stack overflow (%s)"),Q):L(o,Qe("stack overflow",!0)))},G=function(o,T,Q,qe){let Or=qe.message,yr=ae(o,Q).subarray(1);return N(o,Qe("cannot %s %s: %s"),Qe(T),yr,Qe(Or)),z(o,Q),br};let C;const D=[239,187,191],$e=function(o){let T=(function(Q){let qe;Q.n=0;let Or=0;do{if((qe=C(Q))===null||qe!==D[Or])return qe;Or++,Q.buff[Q.n++]=qe}while(Or<D.length);return Q.n=0,C(Q)})(o);if(T===35){do T=C(o);while(T&&T!==10);return{skipped:!0,c:C(o)}}return{skipped:!1,c:T}};let fr;{class o{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}}const T=function(Q,qe){let Or=qe;if(Or.f!==null&&Or.n>0){let Kr=Or.n;return Or.n=0,Or.f=Or.f.subarray(Or.pos),Or.buff.subarray(0,Kr)}let yr=Or.f;return Or.f=null,yr};C=function(Q){return Q.pos<Q.f.length?Q.f[Q.pos++]:null},fr=function(Q,qe,Or){let yr=new o,Kr=Ke(Q)+1;if(qe===null)throw new Error("Can't read stdin in the browser");{N(Q,Qe("@%s"),qe);let Xr=lr(qe),Br=new XMLHttpRequest;if(Br.open("GET",Xr,!1),typeof window>"u"&&(Br.responseType="arraybuffer"),Br.send(),!(Br.status>=200&&Br.status<=299))return yr.err=Br.status,G(Q,"open",Kr,{message:`${Br.status}: ${Br.statusText}`});typeof Br.response=="string"?yr.f=Qe(Br.response):yr.f=new Uint8Array(Br.response)}let Jr=$e(yr);Jr.c===_e[0]&&qe||Jr.skipped&&(yr.buff[yr.n++]=10),Jr.c!==null&&(yr.buff[yr.n++]=Jr.c);let qr=k(Q,T,yr,ae(Q,-1),Or),Zr=yr.err;return Zr?(ir(Q,Kr),G(Q,"read",Kr,Zr)):(z(Q,Kr),qr)}}const gr=function(o,T){return fr(o,T,null)},Nr=function(o,T,Q){let qe=dr(o);Q!=72&&L(o,Qe("core and library have incompatible numeric types")),qe!=dr(null)?L(o,Qe("multiple Lua VMs detected")):qe!==T&&L(o,Qe("version mismatch: app. needs %f, Lua core provides %f"),T,qe)};e.exports.LUA_ERRFILE=br,e.exports.LUA_FILEHANDLE=l,e.exports.LUA_LOADED_TABLE=r,e.exports.LUA_NOREF=-2,e.exports.LUA_PRELOAD_TABLE=n,e.exports.LUA_REFNIL=-1,e.exports.luaL_Buffer=s,e.exports.luaL_addchar=function(o,T){wr(o,1),o.b[o.n++]=T},e.exports.luaL_addlstring=Fr,e.exports.luaL_addsize=Gr,e.exports.luaL_addstring=Dr,e.exports.luaL_addvalue=function(o){let T=o.L,Q=ae(T,-1);Fr(o,Q,Q.length),ze(T,1)},e.exports.luaL_argcheck=function(o,T,Q,qe){T||Tr(o,Q,qe)},e.exports.luaL_argerror=Tr,e.exports.luaL_buffinit=Ir,e.exports.luaL_buffinitsize=function(o,T,Q){return Ir(o,T),wr(T,Q)},e.exports.luaL_callmeta=Se,e.exports.luaL_checkany=function(o,T){Ce(o,T)===B&&Tr(o,T,Qe("value expected",!0))},e.exports.luaL_checkinteger=vr,e.exports.luaL_checklstring=ur,e.exports.luaL_checknumber=Er,e.exports.luaL_checkoption=function(o,T,Q,qe){let Or=Q!==null?pr(o,T,Q):kr(o,T);for(let yr=0;qe[yr];yr++)if(Mr(qe[yr],Or))return yr;return Tr(o,T,N(o,Qe("invalid option '%s'"),Or))},e.exports.luaL_checkstack=O,e.exports.luaL_checkstring=kr,e.exports.luaL_checktype=function(o,T,Q){Ce(o,T)!==Q&&cr(o,T,Q)},e.exports.luaL_checkudata=function(o,T,Q){let qe=Pe(o,T,Q);return qe===null&&y(o,T,Q),qe},e.exports.luaL_checkversion=function(o){Nr(o,j,72)},e.exports.luaL_checkversion_=Nr,e.exports.luaL_dofile=function(o,T){return gr(o,T)||nr(o,0,V,0)},e.exports.luaL_dostring=function(o,T){return Ze(o,T)||nr(o,0,V,0)},e.exports.luaL_error=L,e.exports.luaL_execresult=function(o,T){let Q,qe;if(T===null)return rr(o,1),q(o,"exit"),de(o,0),3;if(T.status)Q="exit",qe=T.status;else{if(!T.signal)return ne(o,0,null,T);Q="signal",qe=T.signal}return ar(o),q(o,Q),de(o,qe),3},e.exports.luaL_fileresult=ne,e.exports.luaL_getmetafield=ve,e.exports.luaL_getmetatable=M,e.exports.luaL_getsubtable=t,e.exports.luaL_gsub=function(o,T,Q,qe){let Or,yr=new s;for(Ir(o,yr);(Or=er(T,Q))>=0;)Fr(yr,T,Or),Dr(yr,qe),T=T.subarray(Or+Q.length);return Dr(yr,T),jr(yr),ae(o,-1)},e.exports.luaL_len=function(o,T){d(o,T);let Q=Rr(o,-1);return Q===!1&&L(o,Qe("object length is not an integer",!0)),ze(o,1),Q},e.exports.luaL_loadbuffer=Ie,e.exports.luaL_loadbufferx=Ee,e.exports.luaL_loadfile=gr,e.exports.luaL_loadfilex=fr,e.exports.luaL_loadstring=Ze,e.exports.luaL_newlib=function(o,T){x(o),v(o,T,0)},e.exports.luaL_newlibtable=function(o){x(o)},e.exports.luaL_newmetatable=function(o,T){return M(o,T)!==fe?0:(ze(o,1),x(o,0,2),Je(o,T),le(o,-2,a),ke(o,-1),le(o,K,T),1)},e.exports.luaL_newstate=function(){let o=U();return o&&Ve(o,Ar),o},e.exports.luaL_opt=c,e.exports.luaL_optinteger=function(o,T,Q){return c(o,vr,T,Q)},e.exports.luaL_optlstring=Vr,e.exports.luaL_optnumber=function(o,T,Q){return c(o,Er,T,Q)},e.exports.luaL_optstring=pr,e.exports.luaL_prepbuffer=function(o){return wr(o,b)},e.exports.luaL_prepbuffsize=wr,e.exports.luaL_pushresult=jr,e.exports.luaL_pushresultsize=function(o,T){Gr(o,T),jr(o)},e.exports.luaL_ref=function(o,T){let Q;return Z(o,-1)?(ze(o,1),-1):(T=$(o,T),F(o,T,0),Q=Sr(o,-1),ze(o,1),Q!==0?(F(o,T,Q),A(o,T,0)):Q=Le(o,T)+1,A(o,T,Q),Q)},e.exports.luaL_requiref=function(o,T,Q,qe){t(o,K,r),Y(o,-1,T),Ur(o,-1)||(ze(o,1),R(o,Q),Je(o,T),ye(o,1,1),ke(o,-1),le(o,-3,T)),z(o,-2),qe&&(ke(o,-1),sr(o,T))},e.exports.luaL_setfuncs=v,e.exports.luaL_setmetatable=function(o,T){M(o,T),or(o,-2)},e.exports.luaL_testudata=Pe,e.exports.luaL_tolstring=function(o,T){if(Se(o,T,u))W(o,-1)||L(o,Qe("'__tostring' must return a string"));else switch(Ce(o,T)){case we:I(o,T)?N(o,Ae,Sr(o,T)):N(o,Xe,Oe(o,T));break;case pe:ke(o,T);break;case He:q(o,Ur(o,T)?"true":"false");break;case fe:q(o,"nil");break;default:{let Q=ve(o,T,a),qe=Q===pe?ae(o,-1):_r(o,T);N(o,Qe("%s: %p"),qe,ge(o,T)),Q!==fe&&z(o,-2);break}}return _(o,-1)},e.exports.luaL_traceback=function(o,T,Q,qe){let Or=new se,yr=Ke(o),Kr=(function(qr){let Zr=new se,Xr=1,Br=1;for(;Ne(qr,Br,Zr);)Xr=Br,Br*=2;for(;Xr<Br;){let zr=Math.floor((Xr+Br)/2);Ne(qr,zr,Zr)?Xr=zr+1:Br=zr}return Br-1})(T),Jr=Kr-qe>21?10:-1;for(Q&&N(o,Qe(`%s
`),Q),O(o,10,null),q(o,"stack traceback:");Ne(T,qe++,Or);)Jr--==0?(q(o,`
	...`),qe=Kr-11+1):(X(T,Qe("Slnt",!0),Or),N(o,Qe(`
	%s:`),Or.short_src),Or.currentline>0&&q(o,`${Or.currentline}:`),q(o," in "),Be(o,Or),Or.istailcall&&q(o,`
	(...tail calls..)`),Me(o,Ke(o)-yr));Me(o,Ke(o)-yr)},e.exports.luaL_typename=_r,e.exports.luaL_unref=function(o,T,Q){Q>=0&&(T=$(o,T),F(o,T,0),A(o,T,Q),de(o,Q),A(o,T,0))},e.exports.luaL_where=Ue,e.exports.lua_writestringerror=function(){for(let o=0;o<arguments.length;o++){let T=arguments[o];do{let Q=/([^\n]*)\n?([\d\D]*)/.exec(T);console.error(Q[1]),T=Q[2]}while(T!=="")}}},function(e,hr,h){const{LUA_HOOKCALL:b,LUA_HOOKRET:g,LUA_HOOKTAILCALL:V,LUA_MASKCALL:K,LUA_MASKLINE:_e,LUA_MASKRET:He,LUA_MINSTACK:H,LUA_MULTRET:fe,LUA_SIGNATURE:B,constant_types:{LUA_TCCL:we,LUA_TLCF:pe,LUA_TLCL:he,LUA_TNIL:j},thread_status:{LUA_ERRMEM:se,LUA_ERRERR:$,LUA_ERRRUN:Ve,LUA_ERRSYNTAX:ye,LUA_OK:Ge,LUA_YIELD:Me},lua_Debug:Ye,luastring_indexOf:x,to_luastring:w}=h(1),Y=h(18),X=h(11),ee=h(13),{api_check:Ne,lua_assert:Ke,LUAI_MAXCCALLS:je}=h(4),I=h(6),Z=h(16),me=h(23),W=h(12),{luaS_newliteral:Fe}=h(10),d=h(14),{LUAI_MAXSTACK:k}=h(3),U=h(36),oe=h(15),{MBuffer:ce}=h(19),nr=function(_,Oe){if(_.top<Oe)for(;_.top<Oe;)_.stack[_.top++]=new I.TValue(j,null);else for(;_.top>Oe;)delete _.stack[--_.top]},ze=function(_,Oe,be){let ge=_.top;for(;_.top<be+1;)_.stack[_.top++]=new I.TValue(j,null);switch(Oe){case se:I.setsvalue2s(_,be,Fe(_,"not enough memory"));break;case $:I.setsvalue2s(_,be,Fe(_,"error in error handling"));break;default:I.setobjs2s(_,be,ge-1)}for(;_.top>be+1;)delete _.stack[--_.top]},rr=k+200,tr=function(_,Oe){Ke(Oe<=k||Oe==rr),Ke(_.stack_last==_.stack.length-W.EXTRA_STACK),_.stack.length=Oe,_.stack_last=Oe-W.EXTRA_STACK},R=function(_,Oe){let be=_.stack.length;if(be>k)F(_,$);else{let ge=_.top+Oe+W.EXTRA_STACK,ae=2*be;ae>k&&(ae=k),ae<ge&&(ae=ge),ae>k?(tr(_,rr),X.luaG_runerror(_,w("stack overflow",!0))):tr(_,ae)}},N=function(_,Oe){_.stack_last-_.top<=Oe&&R(_,Oe)},de=function(_){let Oe=(function(ge){let ae=ge.top;for(let ie=ge.ci;ie!==null;ie=ie.previous)ae<ie.top&&(ae=ie.top);return Ke(ae<=ge.stack_last),ae+1})(_),be=Oe+Math.floor(Oe/8)+2*W.EXTRA_STACK;be>k&&(be=k),_.stack.length>k&&W.luaE_freeCI(_),Oe<=k-W.EXTRA_STACK&&be<_.stack.length&&tr(_,be)},q=function(_,Oe,be){let ge=_.stack[Oe];switch(ge.type){case we:case pe:{let ae=ge.type===we?ge.value.f:ge.value;N(_,H);let ie=W.luaE_extendCI(_);ie.funcOff=Oe,ie.nresults=be,ie.func=ge,ie.top=_.top+H,Ke(ie.top<=_.stack_last),ie.callstatus=0,_.hookmask&K&&Je(_,b,-1);let Ce=ae(_);if(typeof Ce!="number"||Ce<0||(0|Ce)!==Ce)throw Error("invalid return value from JS function (expected integer)");return Y.api_checknelems(_,Ce),Re(_,ie,_.top-Ce,Ce),!0}case he:{let ae,ie=ge.value.p,Ce=_.top-Oe-1,Lr=ie.maxstacksize;if(N(_,Lr),ie.is_vararg)ae=S(_,ie,Ce);else{for(;Ce<ie.numparams;Ce++)_.stack[_.top++]=new I.TValue(j,null);ae=Oe+1}let dr=W.luaE_extendCI(_);return dr.funcOff=Oe,dr.nresults=be,dr.func=ge,dr.l_base=ae,dr.top=ae+Lr,nr(_,dr.top),dr.l_code=ie.code,dr.l_savedpc=0,dr.callstatus=W.CIST_LUA,_.hookmask&K&&ke(_,dr),!1}default:return N(_,1),ue(_,Oe,ge),q(_,Oe,be)}},Re=function(_,Oe,be,ge){let ae=Oe.nresults;_.hookmask&(He|_e)&&(_.hookmask&He&&Je(_,g,-1),_.oldpc=Oe.previous.l_savedpc);let ie=Oe.funcOff;return _.ci=Oe.previous,_.ci.next=null,ar(_,be,ie,ge,ae)},ar=function(_,Oe,be,ge,ae){switch(ae){case 0:break;case 1:ge===0?_.stack[be].setnilvalue():I.setobjs2s(_,be,Oe);break;case fe:for(let Ce=0;Ce<ge;Ce++)I.setobjs2s(_,be+Ce,Oe+Ce);for(let Ce=_.top;Ce>=be+ge;Ce--)delete _.stack[Ce];return _.top=be+ge,!1;default:{let Ce;if(ae<=ge)for(Ce=0;Ce<ae;Ce++)I.setobjs2s(_,be+Ce,Oe+Ce);else{for(Ce=0;Ce<ge;Ce++)I.setobjs2s(_,be+Ce,Oe+Ce);for(;Ce<ae;Ce++)be+Ce>=_.top?_.stack[be+Ce]=new I.TValue(j,null):_.stack[be+Ce].setnilvalue()}break}}let ie=be+ae;for(let Ce=_.top;Ce>=ie;Ce--)delete _.stack[Ce];return _.top=ie,!0},Je=function(_,Oe,be){let ge=_.hook;if(ge&&_.allowhook){let ae=_.ci,ie=_.top,Ce=ae.top,Lr=new Ye;Lr.event=Oe,Lr.currentline=be,Lr.i_ci=ae,N(_,H),ae.top=_.top+H,Ke(ae.top<=_.stack_last),_.allowhook=0,ae.callstatus|=W.CIST_HOOKED,ge(_,Lr),Ke(!_.allowhook),_.allowhook=1,ae.top=Ce,nr(_,ie),ae.callstatus&=~W.CIST_HOOKED}},ke=function(_,Oe){let be=b;Oe.l_savedpc++,Oe.previous.callstatus&W.CIST_LUA&&Oe.previous.l_code[Oe.previous.l_savedpc-1].opcode==Z.OpCodesI.OP_TAILCALL&&(Oe.callstatus|=W.CIST_TAIL,be=V),Je(_,be,-1),Oe.l_savedpc--},S=function(_,Oe,be){let ge,ae=Oe.numparams,ie=_.top-be,Ce=_.top;for(ge=0;ge<ae&&ge<be;ge++)I.pushobj2s(_,_.stack[ie+ge]),_.stack[ie+ge].setnilvalue();for(;ge<ae;ge++)_.stack[_.top++]=new I.TValue(j,null);return Ce},ue=function(_,Oe,be){let ge=d.luaT_gettmbyobj(_,be,d.TMS.TM_CALL);ge.ttisfunction(ge)||X.luaG_typeerror(_,be,w("call",!0)),I.pushobj2s(_,_.stack[_.top-1]);for(let ae=_.top-2;ae>Oe;ae--)I.setobjs2s(_,ae,ae-1);I.setobj2s(_,Oe,ge)},p=function(_,Oe,be){++_.nCcalls>=je&&(function(ge){ge.nCcalls===je?X.luaG_runerror(ge,w("JS stack overflow",!0)):ge.nCcalls>=je+(je>>3)&&F(ge,$)})(_),q(_,Oe,be)||oe.luaV_execute(_),_.nCcalls--},F=function(_,Oe){if(_.errorJmp)throw _.errorJmp.status=Oe,_.errorJmp;{let be=_.l_G;if(_.status=Oe,!be.mainthread.errorJmp){let ge=be.panic;throw ge&&(ze(_,Oe,_.top),_.ci.top<_.top&&(_.ci.top=_.top),ge(_)),new Error(`Aborted ${Oe}`)}be.mainthread.stack[be.mainthread.top++]=_.stack[_.top-1],F(be.mainthread,Oe)}},Le=function(_,Oe,be){let ge=_.nCcalls,ae={status:Ge,previous:_.errorJmp};_.errorJmp=ae;try{Oe(_,be)}catch(ie){if(ae.status===Ge){let Ce=_.l_G.atnativeerror;if(Ce)try{if(ae.status=Ge,Y.lua_pushcfunction(_,Ce),Y.lua_pushlightuserdata(_,ie),Sr(_,_.top-2,1),_.errfunc!==0){let Lr=_.errfunc;I.pushobj2s(_,_.stack[_.top-1]),I.setobjs2s(_,_.top-2,Lr),Sr(_,_.top-2,1)}ae.status=Ve}catch{ae.status===Ge&&(ae.status=-1)}else ae.status=-1}}return _.errorJmp=ae.previous,_.nCcalls=ge,ae.status},A=function(_,Oe){let be=_.ci;Ke(be.c_k!==null&&_.nny===0),Ke(be.callstatus&W.CIST_YPCALL||Oe===Me),be.callstatus&W.CIST_YPCALL&&(be.callstatus&=~W.CIST_YPCALL,_.errfunc=be.c_old_errfunc),be.nresults===fe&&_.ci.top<_.top&&(_.ci.top=_.top);let ge=(0,be.c_k)(_,Oe,be.c_ctx);Y.api_checknelems(_,ge),Re(_,be,_.top-ge,ge)},z=function(_,Oe){for(Oe!==null&&A(_,Oe);_.ci!==_.base_ci;)_.ci.callstatus&W.CIST_LUA?(oe.luaV_finishOp(_),oe.luaV_execute(_)):A(_,Me)},le=function(_,Oe){let be=(function(ae){for(let ie=ae.ci;ie!==null;ie=ie.previous)if(ie.callstatus&W.CIST_YPCALL)return ie;return null})(_);if(be===null)return 0;let ge=be.extra;return ee.luaF_close(_,ge),ze(_,Oe,ge),_.ci=be,_.allowhook=be.callstatus&W.CIST_OAH,_.nny=0,de(_),_.errfunc=be.c_old_errfunc,1},sr=function(_,Oe,be){let ge=Fe(_,Oe);if(be===0)I.pushsvalue2s(_,ge),Ne(_,_.top<=_.ci.top,"stack overflow");else{for(let ae=1;ae<be;ae++)delete _.stack[--_.top];I.setsvalue2s(_,_.top-1,ge)}return Ve},or=function(_,Oe){let be=_.top-Oe,ge=_.ci;_.status===Ge?q(_,be-1,fe)||oe.luaV_execute(_):(Ke(_.status===Me),_.status=Ge,ge.funcOff=ge.extra,ge.func=_.stack[ge.funcOff],ge.callstatus&W.CIST_LUA?oe.luaV_execute(_):(ge.c_k!==null&&(Oe=ge.c_k(_,Me,ge.c_ctx),Y.api_checknelems(_,Oe),be=_.top-Oe),Re(_,ge,be,Oe)),z(_,null))},ir=function(_,Oe,be,ge){let ae=_.ci;return Y.api_checknelems(_,Oe),_.nny>0&&(_!==_.l_G.mainthread?X.luaG_runerror(_,w("attempt to yield across a JS-call boundary",!0)):X.luaG_runerror(_,w("attempt to yield from outside a coroutine",!0))),_.status=Me,ae.extra=ae.funcOff,ae.callstatus&W.CIST_LUA?Ne(_,ge===null,"hooks cannot continue after yielding"):(ae.c_k=ge,ge!==null&&(ae.c_ctx=be),ae.funcOff=_.top-Oe-1,ae.func=_.stack[ae.funcOff],F(_,Me)),Ke(ae.callstatus&W.CIST_HOOKED),0},Ur=function(_,Oe,be,ge,ae){let ie=_.ci,Ce=_.allowhook,Lr=_.nny,dr=_.errfunc;_.errfunc=ae;let xr=Le(_,Oe,be);return xr!==Ge&&(ee.luaF_close(_,ge),ze(_,xr,ge),_.ci=ie,_.allowhook=Ce,_.nny=Lr,de(_)),_.errfunc=dr,xr},Sr=function(_,Oe,be){_.nny++,p(_,Oe,be),_.nny--},Rr=function(_,Oe,be){Oe&&x(Oe,be[0])===-1&&(I.luaO_pushfstring(_,w("attempt to load a %s chunk (mode is '%s')"),be,Oe),F(_,ye))},Cr=function(_,Oe){let be,ge=Oe.z.zgetc();ge===B[0]?(Rr(_,Oe.mode,w("binary",!0)),be=U.luaU_undump(_,Oe.z,Oe.name)):(Rr(_,Oe.mode,w("text",!0)),be=me.luaY_parser(_,Oe.z,Oe.buff,Oe.dyd,Oe.name,ge)),Ke(be.nupvalues===be.p.upvalues.length),ee.luaF_initupvals(_,be)};e.exports.adjust_top=nr,e.exports.luaD_call=p,e.exports.luaD_callnoyield=Sr,e.exports.luaD_checkstack=N,e.exports.luaD_growstack=R,e.exports.luaD_hook=Je,e.exports.luaD_inctop=function(_){N(_,1),_.stack[_.top++]=new I.TValue(j,null)},e.exports.luaD_pcall=Ur,e.exports.luaD_poscall=Re,e.exports.luaD_precall=q,e.exports.luaD_protectedparser=function(_,Oe,be,ge){let ae=new class{constructor(Ce,Lr,dr){this.z=Ce,this.buff=new ce,this.dyd=new me.Dyndata,this.mode=dr,this.name=Lr}}(Oe,be,ge);_.nny++;let ie=Ur(_,Cr,ae,_.top,_.errfunc);return _.nny--,ie},e.exports.luaD_rawrunprotected=Le,e.exports.luaD_reallocstack=tr,e.exports.luaD_throw=F,e.exports.lua_isyieldable=function(_){return _.nny===0},e.exports.lua_resume=function(_,Oe,be){let ge=_.nny;if(_.status===Ge){if(_.ci!==_.base_ci)return sr(_,"cannot resume non-suspended coroutine",be)}else if(_.status!==Me)return sr(_,"cannot resume dead coroutine",be);if(_.nCcalls=Oe?Oe.nCcalls+1:1,_.nCcalls>=je)return sr(_,"JS stack overflow",be);_.nny=0,Y.api_checknelems(_,_.status===Ge?be+1:be);let ae=Le(_,or,be);if(ae===-1)ae=Ve;else{for(;ae>Me&&le(_,ae);)ae=Le(_,z,ae);ae>Me?(_.status=ae,ze(_,ae,_.top),_.ci.top=_.top):Ke(ae===_.status)}return _.nny=ge,_.nCcalls--,Ke(_.nCcalls===(Oe?Oe.nCcalls:0)),ae},e.exports.lua_yield=function(_,Oe){ir(_,Oe,0,null)},e.exports.lua_yieldk=ir},function(e,hr,h){const{constant_types:{LUA_TBOOLEAN:b,LUA_TCCL:g,LUA_TLCF:V,LUA_TLCL:K,LUA_TLIGHTUSERDATA:_e,LUA_TLNGSTR:He,LUA_TNIL:H,LUA_TNUMFLT:fe,LUA_TNUMINT:B,LUA_TSHRSTR:we,LUA_TTABLE:pe,LUA_TTHREAD:he,LUA_TUSERDATA:j},to_luastring:se}=h(1),{lua_assert:$}=h(4),Ve=h(11),ye=h(6),{luaS_hashlongstr:Ge,TString:Me}=h(10),Ye=h(12);let x=new WeakMap;const w=function(I){let Z=x.get(I);return Z||(Z={},x.set(I,Z)),Z},Y=function(I,Z){switch(Z.type){case H:return Ve.luaG_runerror(I,se("table index is nil",!0));case fe:if(isNaN(Z.value))return Ve.luaG_runerror(I,se("table index is NaN",!0));case B:case b:case pe:case K:case V:case g:case j:case he:return Z.value;case we:case He:return Ge(Z.tsvalue());case _e:{let me=Z.value;switch(typeof me){case"string":return"*"+me;case"number":return"#"+me;case"boolean":return me?"?true":"?false";case"function":return w(me);case"object":if(me instanceof Ye.lua_State&&me.l_G===I.l_G||me instanceof X||me instanceof ye.Udata||me instanceof ye.LClosure||me instanceof ye.CClosure)return w(me);default:return me}}default:throw new Error("unknown key type: "+Z.type)}};class X{constructor(Z){this.id=Z.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}}const ee=function(I,Z,me,W){I.dead_strong.clear(),I.dead_weak=void 0;let Fe=null,d={key:me,value:W,p:Fe=I.l,n:void 0};I.f||(I.f=d),Fe&&(Fe.n=d),I.strong.set(Z,d),I.l=d},Ne=function(I,Z){let me=I.strong.get(Z);if(me){me.key.setdeadvalue(),me.value=void 0;let W=me.n,Fe=me.p;me.p=void 0,Fe&&(Fe.n=W),W&&(W.p=Fe),I.f===me&&(I.f=W),I.l===me&&(I.l=Fe),I.strong.delete(Z),(function(d){return typeof d=="object"?d!==null:typeof d=="function"})(Z)?(I.dead_weak||(I.dead_weak=new WeakMap),I.dead_weak.set(Z,me)):I.dead_strong.set(Z,me)}},Ke=function(I,Z){let me=I.strong.get(Z);return me?me.value:ye.luaO_nilobject},je=function(I,Z){return $(typeof Z=="number"&&(0|Z)===Z),Ke(I,Z)};e.exports.invalidateTMcache=function(I){I.flags=0},e.exports.luaH_get=function(I,Z,me){return $(me instanceof ye.TValue),me.ttisnil()||me.ttisfloat()&&isNaN(me.value)?ye.luaO_nilobject:Ke(Z,Y(I,me))},e.exports.luaH_getint=je,e.exports.luaH_getn=function(I){let Z=0,me=I.strong.size+1;for(;me-Z>1;){let W=Math.floor((Z+me)/2);je(I,W).ttisnil()?me=W:Z=W}return Z},e.exports.luaH_getstr=function(I,Z){return $(Z instanceof Me),Ke(I,Ge(Z))},e.exports.luaH_setfrom=function(I,Z,me,W){$(me instanceof ye.TValue);let Fe=Y(I,me);if(W.ttisnil())return void Ne(Z,Fe);let d=Z.strong.get(Fe);if(d)d.value.setfrom(W);else{let k,U=me.value;k=me.ttisfloat()&&(0|U)===U?new ye.TValue(B,U):new ye.TValue(me.type,U);let oe=new ye.TValue(W.type,W.value);ee(Z,Fe,k,oe)}},e.exports.luaH_setint=function(I,Z,me){$(typeof Z=="number"&&(0|Z)===Z&&me instanceof ye.TValue);let W=Z;if(me.ttisnil())return void Ne(I,W);let Fe=I.strong.get(W);if(Fe)Fe.value.setfrom(me);else{let d=new ye.TValue(B,Z),k=new ye.TValue(me.type,me.value);ee(I,W,d,k)}},e.exports.luaH_new=function(I){return new X(I)},e.exports.luaH_next=function(I,Z,me){let W,Fe=I.stack[me];if(Fe.type===H){if(!(W=Z.f))return!1}else{let d=Y(I,Fe);if(W=Z.strong.get(d)){if(!(W=W.n))return!1}else{if(!(W=Z.dead_weak&&Z.dead_weak.get(d)||Z.dead_strong.get(d)))return Ve.luaG_runerror(I,se("invalid key to 'next'"));do if(!(W=W.n))return!1;while(W.key.ttisdeadkey())}}return ye.setobj2s(I,me,W.key),ye.setobj2s(I,me+1,W.value),!0},e.exports.Table=X},function(e,hr,h){const{is_luastring:b,luastring_eq:g,luastring_from:V,to_luastring:K}=h(1),{lua_assert:_e}=h(4);class He{constructor(we,pe){this.hash=null,this.realstring=pe}getstr(){return this.realstring}tsslen(){return this.realstring.length}}const H=function(B){_e(b(B));let we=B.length,pe="|";for(let he=0;he<we;he++)pe+=B[he].toString(16);return pe},fe=function(B,we){return _e(we instanceof Uint8Array),new He(B,we)};e.exports.luaS_eqlngstr=function(B,we){return _e(B instanceof He),_e(we instanceof He),B==we||g(B.realstring,we.realstring)},e.exports.luaS_hash=H,e.exports.luaS_hashlongstr=function(B){return _e(B instanceof He),B.hash===null&&(B.hash=H(B.getstr())),B.hash},e.exports.luaS_bless=fe,e.exports.luaS_new=function(B,we){return fe(B,V(we))},e.exports.luaS_newliteral=function(B,we){return fe(B,K(we))},e.exports.TString=He},function(e,hr,h){const{LUA_HOOKCOUNT:b,LUA_HOOKLINE:g,LUA_MASKCOUNT:V,LUA_MASKLINE:K,constant_types:{LUA_TBOOLEAN:_e,LUA_TNIL:He,LUA_TTABLE:H},thread_status:{LUA_ERRRUN:fe,LUA_YIELD:B},from_userstring:we,luastring_eq:pe,luastring_indexOf:he,to_luastring:j}=h(1),{api_check:se,lua_assert:$}=h(4),{LUA_IDSIZE:Ve}=h(3),ye=h(18),Ge=h(8),Me=h(13),Ye=h(20),x=h(6),w=h(16),Y=h(12),X=h(9),ee=h(14),Ne=h(15),Ke=function(R){return $(R.callstatus&Y.CIST_LUA),R.l_savedpc-1},je=function(R){return R.func.value.p.lineinfo.length!==0?R.func.value.p.lineinfo[Ke(R)]:-1},I=function(R){if(R.status===B){let N=R.ci,de=N.funcOff;N.func=R.stack[N.extra],N.funcOff=N.extra,N.extra=de}},Z=function(R,N){$(N<R.upvalues.length);let de=R.upvalues[N].name;return de===null?j("?",!0):de.getstr()},me=function(R,N,de){let q,Re=null;if(N.callstatus&Y.CIST_LUA){if(de<0)return(function(ar,Je){let ke=ar.func.value.p.numparams;return Je>=ar.l_base-ar.funcOff-ke?null:{pos:ar.funcOff+ke+Je,name:j("(*vararg)",!0)}})(N,-de);q=N.l_base,Re=Me.luaF_getlocalname(N.func.value.p,de,Ke(N))}else q=N.funcOff+1;if(Re===null){if(!((N===R.ci?R.top:N.next.funcOff)-q>=de&&de>0))return null;Re=j("(*temporary)",!0)}return{pos:q+(de-1),name:Re}},W=function(R,N){if(N===null||N instanceof x.CClosure)R.source=j("=[JS]",!0),R.linedefined=-1,R.lastlinedefined=-1,R.what=j("J",!0);else{let de=N.p;R.source=de.source?de.source.getstr():j("=?",!0),R.linedefined=de.linedefined,R.lastlinedefined=de.lastlinedefined,R.what=R.linedefined===0?j("main",!0):j("Lua",!0)}R.short_src=x.luaO_chunkid(R.source,Ve)},Fe=function(R,N){let de={name:null,funcname:null};return N===null?null:N.callstatus&Y.CIST_FIN?(de.name=j("__gc",!0),de.funcname=j("metamethod",!0),de):!(N.callstatus&Y.CIST_TAIL)&&N.previous.callstatus&Y.CIST_LUA?oe(R,N.previous):null},d=function(R,N,de){let q={name:null,funcname:null};if(w.ISK(de)){let Re=R.k[w.INDEXK(de)];if(Re.ttisstring())return q.name=Re.svalue(),q}else{let Re=U(R,N,de);if(Re&&Re.funcname[0]===99)return Re}return q.name=j("?",!0),q},k=function(R,N){return R<N?-1:R},U=function(R,N,de){let q={name:Me.luaF_getlocalname(R,de+1,N),funcname:null};if(q.name)return q.funcname=j("local",!0),q;let Re=(function(Je,ke,S){let ue=-1,p=0,F=w.OpCodesI;for(let Le=0;Le<ke;Le++){let A=Je.code[Le],z=A.A;switch(A.opcode){case F.OP_LOADNIL:{let le=A.B;z<=S&&S<=z+le&&(ue=k(Le,p));break}case F.OP_TFORCALL:S>=z+2&&(ue=k(Le,p));break;case F.OP_CALL:case F.OP_TAILCALL:S>=z&&(ue=k(Le,p));break;case F.OP_JMP:{let le=Le+1+A.sBx;Le<le&&le<=ke&&le>p&&(p=le);break}default:w.testAMode(A.opcode)&&S===z&&(ue=k(Le,p))}}return ue})(R,N,de),ar=w.OpCodesI;if(Re!==-1){let Je=R.code[Re];switch(Je.opcode){case ar.OP_MOVE:{let ke=Je.B;if(ke<Je.A)return U(R,Re,ke);break}case ar.OP_GETTABUP:case ar.OP_GETTABLE:{let ke=Je.C,S=Je.B,ue=Je.opcode===ar.OP_GETTABLE?Me.luaF_getlocalname(R,S+1,Re):Z(R,S);return q.name=d(R,Re,ke).name,q.funcname=ue&&pe(ue,Ye.LUA_ENV)?j("global",!0):j("field",!0),q}case ar.OP_GETUPVAL:return q.name=Z(R,Je.B),q.funcname=j("upvalue",!0),q;case ar.OP_LOADK:case ar.OP_LOADKX:{let ke=Je.opcode===ar.OP_LOADK?Je.Bx:R.code[Re+1].Ax;if(R.k[ke].ttisstring())return q.name=R.k[ke].svalue(),q.funcname=j("constant",!0),q;break}case ar.OP_SELF:{let ke=Je.C;return q.name=d(R,Re,ke).name,q.funcname=j("method",!0),q}}}return null},oe=function(R,N){let de={name:null,funcname:null},q=0,Re=N.func.value.p,ar=Ke(N),Je=Re.code[ar],ke=w.OpCodesI;if(N.callstatus&Y.CIST_HOOKED)return de.name=j("?",!0),de.funcname=j("hook",!0),de;switch(Je.opcode){case ke.OP_CALL:case ke.OP_TAILCALL:return U(Re,ar,Je.A);case ke.OP_TFORCALL:return de.name=j("for iterator",!0),de.funcname=j("for iterator",!0),de;case ke.OP_SELF:case ke.OP_GETTABUP:case ke.OP_GETTABLE:q=ee.TMS.TM_INDEX;break;case ke.OP_SETTABUP:case ke.OP_SETTABLE:q=ee.TMS.TM_NEWINDEX;break;case ke.OP_ADD:q=ee.TMS.TM_ADD;break;case ke.OP_SUB:q=ee.TMS.TM_SUB;break;case ke.OP_MUL:q=ee.TMS.TM_MUL;break;case ke.OP_MOD:q=ee.TMS.TM_MOD;break;case ke.OP_POW:q=ee.TMS.TM_POW;break;case ke.OP_DIV:q=ee.TMS.TM_DIV;break;case ke.OP_IDIV:q=ee.TMS.TM_IDIV;break;case ke.OP_BAND:q=ee.TMS.TM_BAND;break;case ke.OP_BOR:q=ee.TMS.TM_BOR;break;case ke.OP_BXOR:q=ee.TMS.TM_BXOR;break;case ke.OP_SHL:q=ee.TMS.TM_SHL;break;case ke.OP_SHR:q=ee.TMS.TM_SHR;break;case ke.OP_UNM:q=ee.TMS.TM_UNM;break;case ke.OP_BNOT:q=ee.TMS.TM_BNOT;break;case ke.OP_LEN:q=ee.TMS.TM_LEN;break;case ke.OP_CONCAT:q=ee.TMS.TM_CONCAT;break;case ke.OP_EQ:q=ee.TMS.TM_EQ;break;case ke.OP_LT:q=ee.TMS.TM_LT;break;case ke.OP_LE:q=ee.TMS.TM_LE;break;default:return null}return de.name=R.l_G.tmname[q].getstr(),de.funcname=j("metamethod",!0),de},ce=function(R,N){let de=R.ci,q=null;if(de.callstatus&Y.CIST_LUA){q=(function(ar,Je,ke){let S=Je.func.value;for(let ue=0;ue<S.nupvalues;ue++)if(S.upvals[ue]===ke)return{name:Z(S.p,ue),funcname:j("upvalue",!0)};return null})(0,de,N);let Re=(function(ar,Je,ke){for(let S=Je.l_base;S<Je.top;S++)if(ar.stack[S]===ke)return S;return!1})(R,de,N);!q&&Re&&(q=U(de.func.value.p,Ke(de),Re-de.l_base))}return q?x.luaO_pushfstring(R,j(" (%s '%s')",!0),q.funcname,q.name):j("",!0)},nr=function(R,N,de){let q=ee.luaT_objtypename(R,N);rr(R,j("attempt to %s a %s value%s",!0),de,q,ce(R,N))},ze=function(R,N,de,q){let Re;return Re=de?x.luaO_chunkid(de.getstr(),Ve):j("?",!0),x.luaO_pushfstring(R,j("%s:%d: %s",!0),Re,q,N)},rr=function(R,N,...de){let q=R.ci,Re=x.luaO_pushvfstring(R,N,de);q.callstatus&Y.CIST_LUA&&ze(R,Re,q.func.value.p.source,je(q)),tr(R)},tr=function(R){if(R.errfunc!==0){let N=R.errfunc;x.pushobj2s(R,R.stack[R.top-1]),x.setobjs2s(R,R.top-2,N),Ge.luaD_callnoyield(R,R.top-2,1)}Ge.luaD_throw(R,fe)};e.exports.luaG_addinfo=ze,e.exports.luaG_concaterror=function(R,N,de){(N.ttisstring()||Ne.cvt2str(N))&&(N=de),nr(R,N,j("concatenate",!0))},e.exports.luaG_errormsg=tr,e.exports.luaG_opinterror=function(R,N,de,q){Ne.tonumber(N)===!1&&(de=N),nr(R,de,q)},e.exports.luaG_ordererror=function(R,N,de){let q=ee.luaT_objtypename(R,N),Re=ee.luaT_objtypename(R,de);pe(q,Re)?rr(R,j("attempt to compare two %s values",!0),q):rr(R,j("attempt to compare %s with %s",!0),q,Re)},e.exports.luaG_runerror=rr,e.exports.luaG_tointerror=function(R,N,de){Ne.tointeger(N)===!1&&(de=N),rr(R,j("number%s has no integer representation",!0),ce(R,de))},e.exports.luaG_traceexec=function(R){let N=R.ci,de=R.hookmask,q=--R.hookcount==0&&de&V;if(q)R.hookcount=R.basehookcount;else if(!(de&K))return;if(N.callstatus&Y.CIST_HOOKYIELD)N.callstatus&=~Y.CIST_HOOKYIELD;else{if(q&&Ge.luaD_hook(R,b,-1),de&K){let Re=N.func.value.p,ar=N.l_savedpc-1,Je=Re.lineinfo.length!==0?Re.lineinfo[ar]:-1;(ar===0||N.l_savedpc<=R.oldpc||Je!==(Re.lineinfo.length!==0?Re.lineinfo[R.oldpc-1]:-1))&&Ge.luaD_hook(R,g,Je)}R.oldpc=N.l_savedpc,R.status===B&&(q&&(R.hookcount=1),N.l_savedpc--,N.callstatus|=Y.CIST_HOOKYIELD,N.funcOff=R.top-1,N.func=R.stack[N.funcOff],Ge.luaD_throw(R,B))}},e.exports.luaG_typeerror=nr,e.exports.lua_gethook=function(R){return R.hook},e.exports.lua_gethookcount=function(R){return R.basehookcount},e.exports.lua_gethookmask=function(R){return R.hookmask},e.exports.lua_getinfo=function(R,N,de){let q,Re,ar,Je;return N=we(N),I(R),N[0]===62?(ar=null,Je=R.stack[R.top-1],se(R,Je.ttisfunction(),"function expected"),N=N.subarray(1),R.top--):(Je=(ar=de.i_ci).func,$(ar.func.ttisfunction())),q=(function(ke,S,ue,p,F){let Le=1;for(;S.length>0;S=S.subarray(1))switch(S[0]){case 83:W(ue,p);break;case 108:ue.currentline=F&&F.callstatus&Y.CIST_LUA?je(F):-1;break;case 117:ue.nups=p===null?0:p.nupvalues,p===null||p instanceof x.CClosure?(ue.isvararg=!0,ue.nparams=0):(ue.isvararg=p.p.is_vararg,ue.nparams=p.p.numparams);break;case 116:ue.istailcall=F?F.callstatus&Y.CIST_TAIL:0;break;case 110:{let A=Fe(ke,F);A===null?(ue.namewhat=j("",!0),ue.name=null):(ue.namewhat=A.funcname,ue.name=A.name);break}case 76:case 102:break;default:Le=0}return Le})(R,N,de,Re=Je.ttisclosure()?Je.value:null,ar),he(N,102)>=0&&(x.pushobj2s(R,Je),se(R,R.top<=R.ci.top,"stack overflow")),I(R),he(N,76)>=0&&(function(ke,S){if(S===null||S instanceof x.CClosure)ke.stack[ke.top]=new x.TValue(He,null),ye.api_incr_top(ke);else{let ue=S.p.lineinfo,p=X.luaH_new(ke);ke.stack[ke.top]=new x.TValue(H,p),ye.api_incr_top(ke);let F=new x.TValue(_e,!0);for(let Le=0;Le<ue.length;Le++)X.luaH_setint(p,ue[Le],F)}})(R,Re),q},e.exports.lua_getlocal=function(R,N,de){let q;if(I(R),N===null)q=R.stack[R.top-1].ttisLclosure()?Me.luaF_getlocalname(R.stack[R.top-1].value.p,de,0):null;else{let Re=me(R,N.i_ci,de);Re?(q=Re.name,x.pushobj2s(R,R.stack[Re.pos]),se(R,R.top<=R.ci.top,"stack overflow")):q=null}return I(R),q},e.exports.lua_getstack=function(R,N,de){let q,Re;if(N<0)return 0;for(q=R.ci;N>0&&q!==R.base_ci;q=q.previous)N--;return N===0&&q!==R.base_ci?(Re=1,de.i_ci=q):Re=0,Re},e.exports.lua_sethook=function(R,N,de,q){N!==null&&de!==0||(de=0,N=null),R.ci.callstatus&Y.CIST_LUA&&(R.oldpc=R.ci.l_savedpc),R.hook=N,R.basehookcount=q,R.hookcount=R.basehookcount,R.hookmask=de},e.exports.lua_setlocal=function(R,N,de){let q;I(R);let Re=me(R,N.i_ci,de);return Re?(q=Re.name,x.setobjs2s(R,Re.pos,R.top-1),delete R.stack[--R.top]):q=null,I(R),q}},function(e,hr,h){const{LUA_MINSTACK:b,LUA_RIDX_GLOBALS:g,LUA_RIDX_MAINTHREAD:V,constant_types:{LUA_NUMTAGS:K,LUA_TNIL:_e,LUA_TTABLE:He,LUA_TTHREAD:H},thread_status:{LUA_OK:fe}}=h(1),B=h(6),we=h(8),pe=h(18),he=h(9),j=h(14),se=2*b;class ${constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}}class Ve{constructor(w){this.id=w.id_counter++,this.base_ci=new $,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=w,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=fe,this.errfunc=0}}const ye=function(x){x.ci.next=null},Ge=function(x,w){x.stack=new Array(se),x.top=0,x.stack_last=se-5;let Y=x.base_ci;Y.next=Y.previous=null,Y.callstatus=0,Y.funcOff=x.top,Y.func=x.stack[x.top],x.stack[x.top++]=new B.TValue(_e,null),Y.top=x.top+b,x.ci=Y},Me=function(x){x.ci=x.base_ci,ye(x),x.stack=null},Ye=function(x){let w=x.l_G;Ge(x),(function(Y,X){let ee=he.luaH_new(Y);X.l_registry.sethvalue(ee),he.luaH_setint(ee,V,new B.TValue(H,Y)),he.luaH_setint(ee,g,new B.TValue(He,he.luaH_new(Y)))})(x,w),j.luaT_init(x),w.version=pe.lua_version(null)};e.exports.lua_State=Ve,e.exports.CallInfo=$,e.exports.CIST_OAH=1,e.exports.CIST_LUA=2,e.exports.CIST_HOOKED=4,e.exports.CIST_FRESH=8,e.exports.CIST_YPCALL=16,e.exports.CIST_TAIL=32,e.exports.CIST_HOOKYIELD=64,e.exports.CIST_LEQ=128,e.exports.CIST_FIN=256,e.exports.EXTRA_STACK=5,e.exports.lua_close=function(x){(function(w){Me(w)})(x=x.l_G.mainthread)},e.exports.lua_newstate=function(){let x=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new B.TValue(_e,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=new Array(j.TMS.TM_N),this.mt=new Array(K)}},w=new Ve(x);return x.mainthread=w,we.luaD_rawrunprotected(w,Ye,null)!==fe&&(w=null),w},e.exports.lua_newthread=function(x){let w=x.l_G,Y=new Ve(w);return x.stack[x.top]=new B.TValue(H,Y),pe.api_incr_top(x),Y.hookmask=x.hookmask,Y.basehookcount=x.basehookcount,Y.hook=x.hook,Y.hookcount=Y.basehookcount,Ge(Y),Y},e.exports.luaE_extendCI=function(x){let w=new $;return x.ci.next=w,w.previous=x.ci,w.next=null,x.ci=w,w},e.exports.luaE_freeCI=ye,e.exports.luaE_freethread=function(x,w){Me(w)}},function(e,hr,h){const{constant_types:{LUA_TNIL:b}}=h(1),g=h(6);e.exports.MAXUPVAL=255,e.exports.Proto=class{constructor(V){this.id=V.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},e.exports.luaF_findupval=function(V,K){return V.stack[K]},e.exports.luaF_close=function(V,K){for(let _e=K;_e<V.top;_e++){let He=V.stack[_e];V.stack[_e]=new g.TValue(He.type,He.value)}},e.exports.luaF_getlocalname=function(V,K,_e){for(let He=0;He<V.locvars.length&&V.locvars[He].startpc<=_e;He++)if(_e<V.locvars[He].endpc&&--K==0)return V.locvars[He].varname.getstr();return null},e.exports.luaF_initupvals=function(V,K){for(let _e=0;_e<K.nupvalues;_e++)K.upvals[_e]=new g.TValue(b,null)},e.exports.luaF_newLclosure=function(V,K){return new g.LClosure(V,K)}},function(e,hr,h){const{constant_types:{LUA_TTABLE:b,LUA_TUSERDATA:g},to_luastring:V}=h(1),{lua_assert:K}=h(4),_e=h(6),He=h(8),H=h(12),{luaS_bless:fe,luaS_new:B}=h(10),we=h(9),pe=h(11),he=h(15),j=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map(x=>V(x)),se=function(x){return j[x+1]},$={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},Ve=V("__name",!0),ye=function(x,w,Y,X,ee,Ne){let Ke=x.top;if(_e.pushobj2s(x,w),_e.pushobj2s(x,Y),_e.pushobj2s(x,X),Ne||_e.pushobj2s(x,ee),x.ci.callstatus&H.CIST_LUA?He.luaD_call(x,Ke,Ne):He.luaD_callnoyield(x,Ke,Ne),Ne){let je=x.stack[x.top-1];delete x.stack[--x.top],ee.setfrom(je)}},Ge=function(x,w,Y,X,ee){let Ne=Ye(x,w,ee);return Ne.ttisnil()&&(Ne=Ye(x,Y,ee)),!Ne.ttisnil()&&(ye(x,Ne,w,Y,X,1),!0)},Me=function(x,w,Y){const X=we.luaH_getstr(x,Y);return K(w<=$.TM_EQ),X.ttisnil()?(x.flags|=1<<w,null):X},Ye=function(x,w,Y){let X;switch(w.ttnov()){case b:case g:X=w.value.metatable;break;default:X=x.l_G.mt[w.ttnov()]}return X?we.luaH_getstr(X,x.l_G.tmname[Y]):_e.luaO_nilobject};e.exports.fasttm=function(x,w,Y){return w===null||w.flags&1<<Y?null:Me(w,Y,x.l_G.tmname[Y])},e.exports.TMS=$,e.exports.luaT_callTM=ye,e.exports.luaT_callbinTM=Ge,e.exports.luaT_trybinTM=function(x,w,Y,X,ee){if(!Ge(x,w,Y,X,ee))switch(ee){case $.TM_CONCAT:return pe.luaG_concaterror(x,w,Y);case $.TM_BAND:case $.TM_BOR:case $.TM_BXOR:case $.TM_SHL:case $.TM_SHR:case $.TM_BNOT:{let Ne=he.tonumber(w),Ke=he.tonumber(Y);return Ne!==!1&&Ke!==!1?pe.luaG_tointerror(x,w,Y):pe.luaG_opinterror(x,w,Y,V("perform bitwise operation on",!0))}default:return pe.luaG_opinterror(x,w,Y,V("perform arithmetic on",!0))}},e.exports.luaT_callorderTM=function(x,w,Y,X){let ee=new _e.TValue;return Ge(x,w,Y,ee,X)?!ee.l_isfalse():null},e.exports.luaT_gettm=Me,e.exports.luaT_gettmbyobj=Ye,e.exports.luaT_init=function(x){x.l_G.tmname[$.TM_INDEX]=new B(x,V("__index",!0)),x.l_G.tmname[$.TM_NEWINDEX]=new B(x,V("__newindex",!0)),x.l_G.tmname[$.TM_GC]=new B(x,V("__gc",!0)),x.l_G.tmname[$.TM_MODE]=new B(x,V("__mode",!0)),x.l_G.tmname[$.TM_LEN]=new B(x,V("__len",!0)),x.l_G.tmname[$.TM_EQ]=new B(x,V("__eq",!0)),x.l_G.tmname[$.TM_ADD]=new B(x,V("__add",!0)),x.l_G.tmname[$.TM_SUB]=new B(x,V("__sub",!0)),x.l_G.tmname[$.TM_MUL]=new B(x,V("__mul",!0)),x.l_G.tmname[$.TM_MOD]=new B(x,V("__mod",!0)),x.l_G.tmname[$.TM_POW]=new B(x,V("__pow",!0)),x.l_G.tmname[$.TM_DIV]=new B(x,V("__div",!0)),x.l_G.tmname[$.TM_IDIV]=new B(x,V("__idiv",!0)),x.l_G.tmname[$.TM_BAND]=new B(x,V("__band",!0)),x.l_G.tmname[$.TM_BOR]=new B(x,V("__bor",!0)),x.l_G.tmname[$.TM_BXOR]=new B(x,V("__bxor",!0)),x.l_G.tmname[$.TM_SHL]=new B(x,V("__shl",!0)),x.l_G.tmname[$.TM_SHR]=new B(x,V("__shr",!0)),x.l_G.tmname[$.TM_UNM]=new B(x,V("__unm",!0)),x.l_G.tmname[$.TM_BNOT]=new B(x,V("__bnot",!0)),x.l_G.tmname[$.TM_LT]=new B(x,V("__lt",!0)),x.l_G.tmname[$.TM_LE]=new B(x,V("__le",!0)),x.l_G.tmname[$.TM_CONCAT]=new B(x,V("__concat",!0)),x.l_G.tmname[$.TM_CALL]=new B(x,V("__call",!0))},e.exports.luaT_objtypename=function(x,w){let Y;if(w.ttistable()&&(Y=w.value.metatable)!==null||w.ttisfulluserdata()&&(Y=w.value.metatable)!==null){let X=we.luaH_getstr(Y,fe(x,Ve));if(X.ttisstring())return X.svalue()}return se(w.ttnov())},e.exports.ttypename=se},function(e,hr,h){const{LUA_MASKLINE:b,LUA_MASKCOUNT:g,LUA_MULTRET:V,constant_types:{LUA_TBOOLEAN:K,LUA_TLCF:_e,LUA_TLIGHTUSERDATA:He,LUA_TLNGSTR:H,LUA_TNIL:fe,LUA_TNUMBER:B,LUA_TNUMFLT:we,LUA_TNUMINT:pe,LUA_TSHRSTR:he,LUA_TTABLE:j,LUA_TUSERDATA:se},to_luastring:$}=h(1),{INDEXK:Ve,ISK:ye,LFIELDS_PER_FLUSH:Ge,OpCodesI:{OP_ADD:Me,OP_BAND:Ye,OP_BNOT:x,OP_BOR:w,OP_BXOR:Y,OP_CALL:X,OP_CLOSURE:ee,OP_CONCAT:Ne,OP_DIV:Ke,OP_EQ:je,OP_EXTRAARG:I,OP_FORLOOP:Z,OP_FORPREP:me,OP_GETTABLE:W,OP_GETTABUP:Fe,OP_GETUPVAL:d,OP_IDIV:k,OP_JMP:U,OP_LE:oe,OP_LEN:ce,OP_LOADBOOL:nr,OP_LOADK:ze,OP_LOADKX:rr,OP_LOADNIL:tr,OP_LT:R,OP_MOD:N,OP_MOVE:de,OP_MUL:q,OP_NEWTABLE:Re,OP_NOT:ar,OP_POW:Je,OP_RETURN:ke,OP_SELF:S,OP_SETLIST:ue,OP_SETTABLE:p,OP_SETTABUP:F,OP_SETUPVAL:Le,OP_SHL:A,OP_SHR:z,OP_SUB:le,OP_TAILCALL:sr,OP_TEST:or,OP_TESTSET:ir,OP_TFORCALL:Ur,OP_TFORLOOP:Sr,OP_UNM:Rr,OP_VARARG:Cr}}=h(16),{LUA_MAXINTEGER:_,LUA_MININTEGER:Oe,lua_numbertointeger:be}=h(3),{lua_assert:ge,luai_nummod:ae}=h(4),ie=h(6),Ce=h(13),Lr=h(12),{luaS_bless:dr,luaS_eqlngstr:xr,luaS_hashlongstr:Mr}=h(10),Qe=h(8),lr=h(14),br=h(9),r=h(11),n=function(c,P,Ee){return P+Ee.A},l=function(c,P,Ee){return P+Ee.B},a=function(c,P,Ee,Ie){return ye(Ie.B)?Ee[Ve(Ie.B)]:c.stack[P+Ie.B]},u=function(c,P,Ee,Ie){return ye(Ie.C)?Ee[Ve(Ie.C)]:c.stack[P+Ie.C]},f=function(c,P,Ee,Ie){let Ze=Ee.A;Ze!==0&&Ce.luaF_close(c,P.l_base+Ze-1),P.l_savedpc+=Ee.sBx+Ie},s=function(c,P){f(c,P,P.l_code[P.l_savedpc],1)},m=function(c,P,Ee){if(P.ttisnumber()&&Ee.ttisnumber())return L(P,Ee)?1:0;if(P.ttisstring()&&Ee.ttisstring())return M(P.tsvalue(),Ee.tsvalue())<0?1:0;{let Ie=lr.luaT_callorderTM(c,P,Ee,lr.TMS.TM_LT);return Ie===null&&r.luaG_ordererror(c,P,Ee),Ie?1:0}},xe=function(c,P,Ee){let Ie;return P.ttisnumber()&&Ee.ttisnumber()?ne(P,Ee)?1:0:P.ttisstring()&&Ee.ttisstring()?M(P.tsvalue(),Ee.tsvalue())<=0?1:0:(Ie=lr.luaT_callorderTM(c,P,Ee,lr.TMS.TM_LE))!==null?Ie?1:0:(c.ci.callstatus|=Lr.CIST_LEQ,Ie=lr.luaT_callorderTM(c,Ee,P,lr.TMS.TM_LT),c.ci.callstatus^=Lr.CIST_LEQ,Ie===null&&r.luaG_ordererror(c,P,Ee),Ie?0:1)},Be=function(c,P,Ee){if(P.ttype()!==Ee.ttype())return P.ttnov()!==Ee.ttnov()||P.ttnov()!==B?0:P.value===Ee.value?1:0;let Ie;switch(P.ttype()){case fe:return 1;case K:return P.value==Ee.value?1:0;case He:case pe:case we:case _e:return P.value===Ee.value?1:0;case he:case H:return xr(P.tsvalue(),Ee.tsvalue())?1:0;case se:case j:if(P.value===Ee.value)return 1;if(c===null)return 0;(Ie=lr.fasttm(c,P.value.metatable,lr.TMS.TM_EQ))===null&&(Ie=lr.fasttm(c,Ee.value.metatable,lr.TMS.TM_EQ));break;default:return P.value===Ee.value?1:0}if(Ie===null)return 0;let Ze=new ie.TValue;return lr.luaT_callTM(c,Ie,P,Ee,Ze,1),Ze.l_isfalse()?0:1},Ar=function(c,P){let Ee=!1,Ie=Tr(c,P<0?2:1);if(Ie===!1){let Ze=Ue(c);if(Ze===!1)return!1;0<Ze?(Ie=_,P<0&&(Ee=!0)):(Ie=Oe,P>=0&&(Ee=!0))}return{stopnow:Ee,ilimit:Ie}},Tr=function(c,P){if(c.ttisfloat()){let Ee=c.value,Ie=Math.floor(Ee);if(Ee!==Ie){if(P===0)return!1;P>1&&(Ie+=1)}return be(Ie)}if(c.ttisinteger())return c.value;if(vr(c)){let Ee=new ie.TValue;if(ie.luaO_str2num(c.svalue(),Ee)===c.vslen()+1)return Tr(Ee,P)}return!1},y=function(c){return c.ttisinteger()?c.value:Tr(c,0)},Ue=function(c){if(c.ttnov()===B)return c.value;if(vr(c)){let P=new ie.TValue;if(ie.luaO_str2num(c.svalue(),P)===c.vslen()+1)return P.value}return!1},L=function(c,P){return c.value<P.value},ne=function(c,P){return c.value<=P.value},M=function(c,P){let Ee=Mr(c),Ie=Mr(P);return Ee===Ie?0:Ee<Ie?-1:1},Pe=function(c,P,Ee){let Ie;switch(Ee.ttype()){case j:{let Ze=Ee.value;if((Ie=lr.fasttm(c,Ze.metatable,lr.TMS.TM_LEN))!==null)break;return void P.setivalue(br.luaH_getn(Ze))}case he:case H:return void P.setivalue(Ee.vslen());default:(Ie=lr.luaT_gettmbyobj(c,Ee,lr.TMS.TM_LEN)).ttisnil()&&r.luaG_typeerror(c,Ee,$("get length of",!0))}lr.luaT_callTM(c,Ie,Ee,Ee,P,1)},cr=Math.imul||function(c,P){let Ee=65535&c,Ie=65535&P;return Ee*Ie+((c>>>16&65535)*Ie+Ee*(P>>>16&65535)<<16>>>0)|0},_r=function(c,P,Ee){return Ee===0&&r.luaG_runerror(c,$("attempt to divide by zero")),0|Math.floor(P/Ee)},ur=function(c,P,Ee){return Ee===0&&r.luaG_runerror(c,$("attempt to perform 'n%%0'")),P-Math.floor(P/Ee)*Ee|0},kr=function(c,P){return P<0?P<=-32?0:c>>>-P:P>=32?0:c<<P},Vr=function(c,P,Ee,Ie){let Ze=c.cache;if(Ze!==null){let ve=c.upvalues,Se=ve.length;for(let Ae=0;Ae<Se;Ae++){let Xe=ve[Ae].instack?Ee[Ie+ve[Ae].idx]:P[ve[Ae].idx];if(Ze.upvals[Ae]!==Xe)return null}}return Ze},pr=function(c,P,Ee,Ie,Ze){let ve=P.upvalues.length,Se=P.upvalues,Ae=new ie.LClosure(c,ve);Ae.p=P,c.stack[Ze].setclLvalue(Ae);for(let Xe=0;Xe<ve;Xe++)Se[Xe].instack?Ae.upvals[Xe]=Ce.luaF_findupval(c,Ie+Se[Xe].idx):Ae.upvals[Xe]=Ee[Se[Xe].idx];P.cache=Ae},Er=function(c){return c.ttisnumber()},vr=function(c){return c.ttisstring()},wr=function(c,P){let Ee=c.stack[P];return!!Ee.ttisstring()||!!Er(Ee)&&(ie.luaO_tostring(c,Ee),!0)},Ir=function(c){return c.ttisstring()&&c.vslen()===0},Fr=function(c,P,Ee,Ie){let Ze=0;do{let ve=c.stack[P-Ee],Se=ve.vslen(),Ae=ve.svalue();Ie.set(Ae,Ze),Ze+=Se}while(--Ee>0)},Dr=function(c,P){ge(P>=2);do{let Ee=c.top,Ie=2;if((c.stack[Ee-2].ttisstring()||Er(c.stack[Ee-2]))&&wr(c,Ee-1))if(Ir(c.stack[Ee-1]))wr(c,Ee-2);else if(Ir(c.stack[Ee-2]))ie.setobjs2s(c,Ee-2,Ee-1);else{let Ze=c.stack[Ee-1].vslen();for(Ie=1;Ie<P&&wr(c,Ee-Ie-1);Ie++)Ze+=c.stack[Ee-Ie-1].vslen();let ve=new Uint8Array(Ze);Fr(c,Ee,Ie,ve);let Se=dr(c,ve);ie.setsvalue2s(c,Ee-Ie,Se)}else lr.luaT_trybinTM(c,c.stack[Ee-2],c.stack[Ee-1],c.stack[Ee-2],lr.TMS.TM_CONCAT);for(P-=Ie-1;c.top>Ee-(Ie-1);)delete c.stack[--c.top]}while(P>1)},jr=function(c,P,Ee,Ie){for(let Ze=0;Ze<2e3;Ze++){let ve;if(P.ttistable()){let Se=br.luaH_get(c,P.value,Ee);if(!Se.ttisnil())return void ie.setobj2s(c,Ie,Se);if((ve=lr.fasttm(c,P.value.metatable,lr.TMS.TM_INDEX))===null)return void c.stack[Ie].setnilvalue()}else(ve=lr.luaT_gettmbyobj(c,P,lr.TMS.TM_INDEX)).ttisnil()&&r.luaG_typeerror(c,P,$("index",!0));if(ve.ttisfunction())return void lr.luaT_callTM(c,ve,P,Ee,c.stack[Ie],1);P=ve}r.luaG_runerror(c,$("'__index' chain too long; possible loop",!0))},Gr=function(c,P,Ee,Ie){for(let Ze=0;Ze<2e3;Ze++){let ve;if(P.ttistable()){let Se=P.value;if(!br.luaH_get(c,Se,Ee).ttisnil()||(ve=lr.fasttm(c,Se.metatable,lr.TMS.TM_NEWINDEX))===null)return br.luaH_setfrom(c,Se,Ee,Ie),void br.invalidateTMcache(Se)}else(ve=lr.luaT_gettmbyobj(c,P,lr.TMS.TM_NEWINDEX)).ttisnil()&&r.luaG_typeerror(c,P,$("index",!0));if(ve.ttisfunction())return void lr.luaT_callTM(c,ve,P,Ee,Ie,0);P=ve}r.luaG_runerror(c,$("'__newindex' chain too long; possible loop",!0))};e.exports.cvt2str=Er,e.exports.cvt2num=vr,e.exports.luaV_gettable=jr,e.exports.luaV_concat=Dr,e.exports.luaV_div=_r,e.exports.luaV_equalobj=Be,e.exports.luaV_execute=function(c){let P=c.ci;P.callstatus|=Lr.CIST_FRESH;e:for(;;){ge(P===c.ci);let Ee=P.func.value,Ie=Ee.p.k,Ze=P.l_base,ve=P.l_code[P.l_savedpc++];c.hookmask&(b|g)&&r.luaG_traceexec(c);let Se=n(0,Ze,ve);switch(ve.opcode){case de:ie.setobjs2s(c,Se,l(0,Ze,ve));break;case ze:{let Ae=Ie[ve.Bx];ie.setobj2s(c,Se,Ae);break}case rr:{ge(P.l_code[P.l_savedpc].opcode===I);let Ae=Ie[P.l_code[P.l_savedpc++].Ax];ie.setobj2s(c,Se,Ae);break}case nr:c.stack[Se].setbvalue(ve.B!==0),ve.C!==0&&P.l_savedpc++;break;case tr:for(let Ae=0;Ae<=ve.B;Ae++)c.stack[Se+Ae].setnilvalue();break;case d:{let Ae=ve.B;ie.setobj2s(c,Se,Ee.upvals[Ae]);break}case Fe:{let Ae=Ee.upvals[ve.B],Xe=u(c,Ze,Ie,ve);jr(c,Ae,Xe,Se);break}case W:{let Ae=c.stack[l(0,Ze,ve)],Xe=u(c,Ze,Ie,ve);jr(c,Ae,Xe,Se);break}case F:{let Ae=Ee.upvals[ve.A],Xe=a(c,Ze,Ie,ve),er=u(c,Ze,Ie,ve);Gr(c,Ae,Xe,er);break}case Le:Ee.upvals[ve.B].setfrom(c.stack[Se]);break;case p:{let Ae=c.stack[Se],Xe=a(c,Ze,Ie,ve),er=u(c,Ze,Ie,ve);Gr(c,Ae,Xe,er);break}case Re:c.stack[Se].sethvalue(br.luaH_new(c));break;case S:{let Ae=l(0,Ze,ve),Xe=u(c,Ze,Ie,ve);ie.setobjs2s(c,Se+1,Ae),jr(c,c.stack[Ae],Xe,Se);break}case Me:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(er.value+t.value|0):(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(Ae+Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_ADD);break}case le:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(er.value-t.value|0):(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(Ae-Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_SUB);break}case q:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(cr(er.value,t.value)):(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(Ae*Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_MUL);break}case N:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(ur(c,er.value,t.value)):(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(ae(c,Ae,Xe)):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_MOD);break}case Je:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(Math.pow(Ae,Xe)):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_POW);break}case Ke:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(Ae/Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_DIV);break}case k:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(_r(c,er.value,t.value)):(Ae=Ue(er))!==!1&&(Xe=Ue(t))!==!1?c.stack[Se].setfltvalue(Math.floor(Ae/Xe)):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_IDIV);break}case Ye:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=y(er))!==!1&&(Xe=y(t))!==!1?c.stack[Se].setivalue(Ae&Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_BAND);break}case w:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=y(er))!==!1&&(Xe=y(t))!==!1?c.stack[Se].setivalue(Ae|Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_BOR);break}case Y:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=y(er))!==!1&&(Xe=y(t))!==!1?c.stack[Se].setivalue(Ae^Xe):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_BXOR);break}case A:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=y(er))!==!1&&(Xe=y(t))!==!1?c.stack[Se].setivalue(kr(Ae,Xe)):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_SHL);break}case z:{let Ae,Xe,er=a(c,Ze,Ie,ve),t=u(c,Ze,Ie,ve);(Ae=y(er))!==!1&&(Xe=y(t))!==!1?c.stack[Se].setivalue(kr(Ae,-Xe)):lr.luaT_trybinTM(c,er,t,c.stack[Se],lr.TMS.TM_SHR);break}case Rr:{let Ae,Xe=c.stack[l(0,Ze,ve)];Xe.ttisinteger()?c.stack[Se].setivalue(0|-Xe.value):(Ae=Ue(Xe))!==!1?c.stack[Se].setfltvalue(-Ae):lr.luaT_trybinTM(c,Xe,Xe,c.stack[Se],lr.TMS.TM_UNM);break}case x:{let Ae=c.stack[l(0,Ze,ve)];Ae.ttisinteger()?c.stack[Se].setivalue(~Ae.value):lr.luaT_trybinTM(c,Ae,Ae,c.stack[Se],lr.TMS.TM_BNOT);break}case ar:{let Ae=c.stack[l(0,Ze,ve)];c.stack[Se].setbvalue(Ae.l_isfalse());break}case ce:Pe(c,c.stack[Se],c.stack[l(0,Ze,ve)]);break;case Ne:{let Ae=ve.B,Xe=ve.C;c.top=Ze+Xe+1,Dr(c,Xe-Ae+1);let er=Ze+Ae;ie.setobjs2s(c,Se,er),Qe.adjust_top(c,P.top);break}case U:f(c,P,ve,0);break;case je:Be(c,a(c,Ze,Ie,ve),u(c,Ze,Ie,ve))!==ve.A?P.l_savedpc++:s(c,P);break;case R:m(c,a(c,Ze,Ie,ve),u(c,Ze,Ie,ve))!==ve.A?P.l_savedpc++:s(c,P);break;case oe:xe(c,a(c,Ze,Ie,ve),u(c,Ze,Ie,ve))!==ve.A?P.l_savedpc++:s(c,P);break;case or:(ve.C?c.stack[Se].l_isfalse():!c.stack[Se].l_isfalse())?P.l_savedpc++:s(c,P);break;case ir:{let Ae=l(0,Ze,ve),Xe=c.stack[Ae];(ve.C?Xe.l_isfalse():!Xe.l_isfalse())?P.l_savedpc++:(ie.setobjs2s(c,Se,Ae),s(c,P));break}case X:{let Ae=ve.B,Xe=ve.C-1;if(Ae!==0&&Qe.adjust_top(c,Se+Ae),!Qe.luaD_precall(c,Se,Xe)){P=c.ci;continue e}Xe>=0&&Qe.adjust_top(c,P.top);break}case sr:{let Ae=ve.B;if(Ae!==0&&Qe.adjust_top(c,Se+Ae),!Qe.luaD_precall(c,Se,V)){let Xe=c.ci,er=Xe.previous,t=Xe.func,v=Xe.funcOff,O=er.funcOff,G=Xe.l_base+t.value.p.numparams;Ee.p.p.length>0&&Ce.luaF_close(c,er.l_base);for(let C=0;v+C<G;C++)ie.setobjs2s(c,O+C,v+C);er.l_base=O+(Xe.l_base-v),er.top=O+(c.top-v),Qe.adjust_top(c,er.top),er.l_code=Xe.l_code,er.l_savedpc=Xe.l_savedpc,er.callstatus|=Lr.CIST_TAIL,er.next=null,P=c.ci=er,ge(c.top===er.l_base+c.stack[O].value.p.maxstacksize);continue e}break}case ke:{Ee.p.p.length>0&&Ce.luaF_close(c,Ze);let Ae=Qe.luaD_poscall(c,P,Se,ve.B!==0?ve.B-1:c.top-Se);if(P.callstatus&Lr.CIST_FRESH)return;P=c.ci,Ae&&Qe.adjust_top(c,P.top),ge(P.callstatus&Lr.CIST_LUA),ge(P.l_code[P.l_savedpc-1].opcode===X);continue e}case Z:if(c.stack[Se].ttisinteger()){let Ae=c.stack[Se+2].value,Xe=c.stack[Se].value+Ae|0,er=c.stack[Se+1].value;(0<Ae?Xe<=er:er<=Xe)&&(P.l_savedpc+=ve.sBx,c.stack[Se].chgivalue(Xe),c.stack[Se+3].setivalue(Xe))}else{let Ae=c.stack[Se+2].value,Xe=c.stack[Se].value+Ae,er=c.stack[Se+1].value;(0<Ae?Xe<=er:er<=Xe)&&(P.l_savedpc+=ve.sBx,c.stack[Se].chgfltvalue(Xe),c.stack[Se+3].setfltvalue(Xe))}break;case me:{let Ae,Xe=c.stack[Se],er=c.stack[Se+1],t=c.stack[Se+2];if(Xe.ttisinteger()&&t.ttisinteger()&&(Ae=Ar(er,t.value))){let v=Ae.stopnow?0:Xe.value;er.value=Ae.ilimit,Xe.value=v-t.value|0}else{let v,O,G;(v=Ue(er))===!1&&r.luaG_runerror(c,$("'for' limit must be a number",!0)),c.stack[Se+1].setfltvalue(v),(O=Ue(t))===!1&&r.luaG_runerror(c,$("'for' step must be a number",!0)),c.stack[Se+2].setfltvalue(O),(G=Ue(Xe))===!1&&r.luaG_runerror(c,$("'for' initial value must be a number",!0)),c.stack[Se].setfltvalue(G-O)}P.l_savedpc+=ve.sBx;break}case Ur:{let Ae=Se+3;ie.setobjs2s(c,Ae+2,Se+2),ie.setobjs2s(c,Ae+1,Se+1),ie.setobjs2s(c,Ae,Se),Qe.adjust_top(c,Ae+3),Qe.luaD_call(c,Ae,ve.C),Qe.adjust_top(c,P.top),ve=P.l_code[P.l_savedpc++],Se=n(0,Ze,ve),ge(ve.opcode===Sr)}case Sr:c.stack[Se+1].ttisnil()||(ie.setobjs2s(c,Se,Se+1),P.l_savedpc+=ve.sBx);break;case ue:{let Ae=ve.B,Xe=ve.C;Ae===0&&(Ae=c.top-Se-1),Xe===0&&(ge(P.l_code[P.l_savedpc].opcode===I),Xe=P.l_code[P.l_savedpc++].Ax);let er=c.stack[Se].value,t=(Xe-1)*Ge+Ae;for(;Ae>0;Ae--)br.luaH_setint(er,t--,c.stack[Se+Ae]);Qe.adjust_top(c,P.top);break}case ee:{let Ae=Ee.p.p[ve.Bx],Xe=Vr(Ae,Ee.upvals,c.stack,Ze);Xe===null?pr(c,Ae,Ee.upvals,Ze,Se):c.stack[Se].setclLvalue(Xe);break}case Cr:{let Ae,Xe=ve.B-1,er=Ze-P.funcOff-Ee.p.numparams-1;for(er<0&&(er=0),Xe<0&&(Xe=er,Qe.luaD_checkstack(c,er),Qe.adjust_top(c,Se+er)),Ae=0;Ae<Xe&&Ae<er;Ae++)ie.setobjs2s(c,Se+Ae,Ze-er+Ae);for(;Ae<Xe;Ae++)c.stack[Se+Ae].setnilvalue();break}case I:throw Error("invalid opcode")}}},e.exports.luaV_finishOp=function(c){let P=c.ci,Ee=P.l_base,Ie=P.l_code[P.l_savedpc-1],Ze=Ie.opcode;switch(Ze){case Me:case le:case q:case Ke:case k:case Ye:case w:case Y:case A:case z:case N:case Je:case Rr:case x:case ce:case Fe:case W:case S:ie.setobjs2s(c,Ee+Ie.A,c.top-1),delete c.stack[--c.top];break;case oe:case R:case je:{let ve=!c.stack[c.top-1].l_isfalse();delete c.stack[--c.top],P.callstatus&Lr.CIST_LEQ&&(ge(Ze===oe),P.callstatus^=Lr.CIST_LEQ,ve=!ve),ge(P.l_code[P.l_savedpc].opcode===U),ve!==!!Ie.A&&P.l_savedpc++;break}case Ne:{let ve=c.top-1,Se=ve-1-(Ee+Ie.B);ie.setobjs2s(c,ve-2,ve),Se>1&&(c.top=ve-1,Dr(c,Se)),ie.setobjs2s(c,P.l_base+Ie.A,c.top-1),Qe.adjust_top(c,P.top);break}case Ur:ge(P.l_code[P.l_savedpc].opcode===Sr),Qe.adjust_top(c,P.top);break;case X:Ie.C-1>=0&&Qe.adjust_top(c,P.top)}},e.exports.luaV_imul=cr,e.exports.luaV_lessequal=xe,e.exports.luaV_lessthan=m,e.exports.luaV_mod=ur,e.exports.luaV_objlen=Pe,e.exports.luaV_rawequalobj=function(c,P){return Be(null,c,P)},e.exports.luaV_shiftl=kr,e.exports.luaV_tointeger=Tr,e.exports.settable=Gr,e.exports.tointeger=y,e.exports.tonumber=Ue},function(e,hr,h){const b=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],g=function(H,fe){return~(-1<<H)<<fe},V=function(H,fe){return~g(H,fe)},K=function(H,fe,B,we){return H.code=H.code&V(we,B)|fe<<B&g(we,B),He(H)},_e=function(H,fe){return K(H,fe,14,18)},He=function(H){if(typeof H=="number")return{code:H,opcode:H>>0&g(6,0),A:H>>6&g(8,0),B:H>>23&g(9,0),C:H>>14&g(9,0),Bx:H>>14&g(18,0),Ax:H>>6&g(26,0),sBx:(H>>14&g(18,0))-131071};{let fe=H.code;return H.opcode=fe>>0&g(6,0),H.A=fe>>6&g(8,0),H.B=fe>>23&g(9,0),H.C=fe>>14&g(9,0),H.Bx=fe>>14&g(18,0),H.Ax=fe>>6&g(26,0),H.sBx=(fe>>14&g(18,0))-131071,H}};e.exports.BITRK=256,e.exports.CREATE_ABC=function(H,fe,B,we){return He(H<<0|fe<<6|B<<23|we<<14)},e.exports.CREATE_ABx=function(H,fe,B){return He(H<<0|fe<<6|B<<14)},e.exports.CREATE_Ax=function(H,fe){return He(H<<0|fe<<6)},e.exports.GET_OPCODE=function(H){return H.opcode},e.exports.GETARG_A=function(H){return H.A},e.exports.GETARG_B=function(H){return H.B},e.exports.GETARG_C=function(H){return H.C},e.exports.GETARG_Bx=function(H){return H.Bx},e.exports.GETARG_Ax=function(H){return H.Ax},e.exports.GETARG_sBx=function(H){return H.sBx},e.exports.INDEXK=function(H){return-257&H},e.exports.ISK=function(H){return 256&H},e.exports.LFIELDS_PER_FLUSH=50,e.exports.MAXARG_A=255,e.exports.MAXARG_Ax=67108863,e.exports.MAXARG_B=511,e.exports.MAXARG_Bx=262143,e.exports.MAXARG_C=511,e.exports.MAXARG_sBx=131071,e.exports.MAXINDEXRK=255,e.exports.NO_REG=255,e.exports.OpArgK=3,e.exports.OpArgN=0,e.exports.OpArgR=2,e.exports.OpArgU=1,e.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],e.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},e.exports.POS_A=6,e.exports.POS_Ax=6,e.exports.POS_B=23,e.exports.POS_Bx=14,e.exports.POS_C=14,e.exports.POS_OP=0,e.exports.RKASK=function(H){return 256|H},e.exports.SETARG_A=function(H,fe){return K(H,fe,6,8)},e.exports.SETARG_Ax=function(H,fe){return K(H,fe,6,26)},e.exports.SETARG_B=function(H,fe){return K(H,fe,23,9)},e.exports.SETARG_Bx=_e,e.exports.SETARG_C=function(H,fe){return K(H,fe,14,9)},e.exports.SETARG_sBx=function(H,fe){return _e(H,fe+131071)},e.exports.SET_OPCODE=function(H,fe){return H.code=H.code&V(6,0)|fe<<0&g(6,0),He(H)},e.exports.SIZE_A=8,e.exports.SIZE_Ax=26,e.exports.SIZE_B=9,e.exports.SIZE_Bx=18,e.exports.SIZE_C=9,e.exports.SIZE_OP=6,e.exports.fullins=He,e.exports.getBMode=function(H){return b[H]>>4&3},e.exports.getCMode=function(H){return b[H]>>2&3},e.exports.getOpMode=function(H){return 3&b[H]},e.exports.iABC=0,e.exports.iABx=1,e.exports.iAsBx=2,e.exports.iAx=3,e.exports.testAMode=function(H){return 64&b[H]},e.exports.testTMode=function(H){return 128&b[H]}},function(e,hr,h){const{LUA_VERSION_MAJOR:b,LUA_VERSION_MINOR:g}=h(2),V="_"+b+"_"+g;e.exports.LUA_VERSUFFIX=V,e.exports.lua_assert=function(_e){},e.exports.luaopen_base=h(24).luaopen_base,e.exports.LUA_COLIBNAME="coroutine",e.exports.luaopen_coroutine=h(25).luaopen_coroutine,e.exports.LUA_TABLIBNAME="table",e.exports.luaopen_table=h(26).luaopen_table,e.exports.LUA_OSLIBNAME="os",e.exports.luaopen_os=h(27).luaopen_os,e.exports.LUA_STRLIBNAME="string",e.exports.luaopen_string=h(28).luaopen_string,e.exports.LUA_UTF8LIBNAME="utf8",e.exports.luaopen_utf8=h(29).luaopen_utf8,e.exports.LUA_BITLIBNAME="bit32",e.exports.LUA_MATHLIBNAME="math",e.exports.luaopen_math=h(30).luaopen_math,e.exports.LUA_DBLIBNAME="debug",e.exports.luaopen_debug=h(31).luaopen_debug,e.exports.LUA_LOADLIBNAME="package",e.exports.luaopen_package=h(32).luaopen_package,e.exports.LUA_FENGARILIBNAME="fengari",e.exports.luaopen_fengari=h(33).luaopen_fengari;const K=h(39);e.exports.luaL_openlibs=K.luaL_openlibs},function(e,hr,h){const{LUA_MULTRET:b,LUA_OPBNOT:g,LUA_OPEQ:V,LUA_OPLE:K,LUA_OPLT:_e,LUA_OPUNM:He,LUA_REGISTRYINDEX:H,LUA_RIDX_GLOBALS:fe,LUA_VERSION_NUM:B,constant_types:{LUA_NUMTAGS:we,LUA_TBOOLEAN:pe,LUA_TCCL:he,LUA_TFUNCTION:j,LUA_TLCF:se,LUA_TLCL:$,LUA_TLIGHTUSERDATA:Ve,LUA_TLNGSTR:ye,LUA_TNIL:Ge,LUA_TNONE:Me,LUA_TNUMFLT:Ye,LUA_TNUMINT:x,LUA_TSHRSTR:w,LUA_TTABLE:Y,LUA_TTHREAD:X,LUA_TUSERDATA:ee},thread_status:{LUA_OK:Ne},from_userstring:Ke,to_luastring:je}=h(1),{api_check:I}=h(4),Z=h(11),me=h(8),{luaU_dump:W}=h(37),Fe=h(13),d=h(6),k=h(12),{luaS_bless:U,luaS_new:oe,luaS_newliteral:ce}=h(10),nr=h(14),{LUAI_MAXSTACK:ze}=h(3),rr=h(15),tr=h(9),{ZIO:R}=h(19),N=d.TValue,de=d.CClosure,q=function(r){r.top++,I(r,r.top<=r.ci.top,"stack overflow")},Re=function(r,n){I(r,n<r.top-r.ci.funcOff,"not enough elements in the stack")},ar=function(r){if(!r)throw TypeError("invalid argument")},Je=function(r){ar(typeof r=="number"&&(0|r)===r)},ke=function(r){return r!==d.luaO_nilobject},S=function(r,n){let l=r.ci;if(n>0){let a=l.funcOff+n;return I(r,n<=l.top-(l.funcOff+1),"unacceptable index"),a>=r.top?d.luaO_nilobject:r.stack[a]}return n>H?(I(r,n!==0&&-n<=r.top,"invalid index"),r.stack[r.top+n]):n===H?r.l_G.l_registry:(I(r,(n=H-n)<=Fe.MAXUPVAL+1,"upvalue index too large"),l.func.ttislcf()?d.luaO_nilobject:n<=l.func.value.nupvalues?l.func.value.upvalue[n-1]:d.luaO_nilobject)},ue=function(r,n){let l=r.ci;if(n>0){let a=l.funcOff+n;return I(r,n<=l.top-(l.funcOff+1),"unacceptable index"),a>=r.top?null:a}if(n>H)return I(r,n!==0&&-n<=r.top,"invalid index"),r.top+n;throw Error("attempt to use pseudo-index")},p=function(r,n){let l,a=r.ci.funcOff;n>=0?(I(r,n<=r.stack_last-(a+1),"new top too large"),l=a+1+n):(I(r,-(n+1)<=r.top-(a+1),"invalid new top"),l=r.top+n+1),me.adjust_top(r,l)},F=function(r,n){p(r,-n-1)},Le=function(r,n,l){for(;n<l;n++,l--){let a=r.stack[n],u=new N(a.type,a.value);d.setobjs2s(r,n,l),d.setobj2s(r,l,u)}},A=function(r,n,l){let a=r.top-1,u=ue(r,n),f=r.stack[u];I(r,ke(f)&&n>H,"index not in the stack"),I(r,(l>=0?l:-l)<=a-u+1,"invalid 'n'");let s=l>=0?a-l:u-l-1;Le(r,u,s),Le(r,s+1,r.top-1),Le(r,u,r.top-1)},z=function(r,n,l){let a=S(r,n);S(r,l).setfrom(a)},le=function(r,n,l){if(ar(typeof n=="function"),Je(l),l===0)r.stack[r.top]=new N(se,n);else{Re(r,l),I(r,l<=Fe.MAXUPVAL,"upvalue index too large");let a=new de(r,n,l);for(let u=0;u<l;u++)a.upvalue[u].setfrom(r.stack[r.top-l+u]);for(let u=1;u<l;u++)delete r.stack[--r.top];l>0&&--r.top,r.stack[r.top].setclCvalue(a)}q(r)},sr=le,or=function(r,n){le(r,n,0)},ir=or,Ur=function(r,n,l){let a=oe(r,Ke(l));Re(r,1),d.pushsvalue2s(r,a),I(r,r.top<=r.ci.top,"stack overflow"),rr.settable(r,n,r.stack[r.top-1],r.stack[r.top-2]),delete r.stack[--r.top],delete r.stack[--r.top]},Sr=function(r,n){Ur(r,tr.luaH_getint(r.l_G.l_registry.value,fe),n)},Rr=function(r,n,l){let a=oe(r,Ke(l));return d.pushsvalue2s(r,a),I(r,r.top<=r.ci.top,"stack overflow"),rr.luaV_gettable(r,n,r.stack[r.top-1],r.top-1),r.stack[r.top-1].ttnov()},Cr=function(r,n,l){let a=S(r,n);return Je(l),I(r,a.ttistable(),"table expected"),d.pushobj2s(r,tr.luaH_getint(a.value,l)),I(r,r.top<=r.ci.top,"stack overflow"),r.stack[r.top-1].ttnov()},_=function(r,n,l){let a=new d.TValue(Y,tr.luaH_new(r));r.stack[r.top]=a,q(r)},Oe=function(r,n,l){switch(Je(l),n.ttype()){case he:{let a=n.value;return 1<=l&&l<=a.nupvalues?{name:je("",!0),val:a.upvalue[l-1]}:null}case $:{let a=n.value,u=a.p;if(!(1<=l&&l<=u.upvalues.length))return null;let f=u.upvalues[l-1].name;return{name:f?f.getstr():je("(*no name)",!0),val:a.upvals[l-1]}}default:return null}},be=function(r,n){let l=S(r,n);if(!l.ttisstring()){if(!rr.cvt2str(l))return null;d.luaO_tostring(r,l)}return l.svalue()},ge=be,ae=function(r,n){return rr.tointeger(S(r,n))},ie=function(r,n){return rr.tonumber(S(r,n))},Ce=new WeakMap,Lr=function(r,n){me.luaD_callnoyield(r,n.funcOff,n.nresults)},dr=function(r,n){let l=S(r,n);return ke(l)?l.ttnov():Me},xr=je("?"),Mr=function(r,n,l){I(r,l===b||r.ci.top-r.top>=l-n,"results from function overflow current stack size")},Qe=function(r,n,l,a,u){I(r,u===null||!(r.ci.callstatus&k.CIST_LUA),"cannot use continuations inside hooks"),Re(r,n+1),I(r,r.status===Ne,"cannot do calls on non-normal thread"),Mr(r,n,l);let f=r.top-(n+1);u!==null&&r.nny===0?(r.ci.c_k=u,r.ci.c_ctx=a,me.luaD_call(r,f,l)):me.luaD_callnoyield(r,f,l),l===b&&r.ci.top<r.top&&(r.ci.top=r.top)},lr=function(r,n,l,a,u,f){let s,m;I(r,f===null||!(r.ci.callstatus&k.CIST_LUA),"cannot use continuations inside hooks"),Re(r,n+1),I(r,r.status===Ne,"cannot do calls on non-normal thread"),Mr(r,n,l),m=a===0?0:ue(r,a);let xe=r.top-(n+1);if(f===null||r.nny>0){let Be={funcOff:xe,nresults:l};s=me.luaD_pcall(r,Lr,Be,xe,m)}else{let Be=r.ci;Be.c_k=f,Be.c_ctx=u,Be.extra=xe,Be.c_old_errfunc=r.errfunc,r.errfunc=m,Be.callstatus&=~k.CIST_OAH|r.allowhook,Be.callstatus|=k.CIST_YPCALL,me.luaD_call(r,xe,l),Be.callstatus&=~k.CIST_YPCALL,r.errfunc=Be.c_old_errfunc,s=Ne}return l===b&&r.ci.top<r.top&&(r.ci.top=r.top),s},br=function(r,n,l){let a=S(r,n);I(r,a.ttisLclosure(),"Lua function expected");let u=a.value;return Je(l),I(r,1<=l&&l<=u.p.upvalues.length,"invalid upvalue index"),{f:u,i:l-1}};e.exports.api_incr_top=q,e.exports.api_checknelems=Re,e.exports.lua_absindex=function(r,n){return n>0||n<=H?n:r.top-r.ci.funcOff+n},e.exports.lua_arith=function(r,n){n!==He&&n!==g?Re(r,2):(Re(r,1),d.pushobj2s(r,r.stack[r.top-1]),I(r,r.top<=r.ci.top,"stack overflow")),d.luaO_arith(r,n,r.stack[r.top-2],r.stack[r.top-1],r.stack[r.top-2]),delete r.stack[--r.top]},e.exports.lua_atpanic=function(r,n){let l=r.l_G.panic;return r.l_G.panic=n,l},e.exports.lua_atnativeerror=function(r,n){let l=r.l_G.atnativeerror;return r.l_G.atnativeerror=n,l},e.exports.lua_call=function(r,n,l){Qe(r,n,l,0,null)},e.exports.lua_callk=Qe,e.exports.lua_checkstack=function(r,n){let l,a=r.ci;return I(r,n>=0,"negative 'n'"),r.stack_last-r.top>n?l=!0:r.top+k.EXTRA_STACK>ze-n?l=!1:(me.luaD_growstack(r,n),l=!0),l&&a.top<r.top+n&&(a.top=r.top+n),l},e.exports.lua_compare=function(r,n,l,a){let u=S(r,n),f=S(r,l),s=0;if(ke(u)&&ke(f))switch(a){case V:s=rr.luaV_equalobj(r,u,f);break;case _e:s=rr.luaV_lessthan(r,u,f);break;case K:s=rr.luaV_lessequal(r,u,f);break;default:I(r,!1,"invalid option")}return s},e.exports.lua_concat=function(r,n){Re(r,n),n>=2?rr.luaV_concat(r,n):n===0&&(d.pushsvalue2s(r,U(r,je("",!0))),I(r,r.top<=r.ci.top,"stack overflow"))},e.exports.lua_copy=z,e.exports.lua_createtable=_,e.exports.lua_dump=function(r,n,l,a){Re(r,1);let u=r.stack[r.top-1];return u.ttisLclosure()?W(r,u.value.p,n,l,a):1},e.exports.lua_error=function(r){Re(r,1),Z.luaG_errormsg(r)},e.exports.lua_gc=function(){},e.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},e.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},e.exports.lua_getfield=function(r,n,l){return Rr(r,S(r,n),l)},e.exports.lua_getglobal=function(r,n){return Rr(r,tr.luaH_getint(r.l_G.l_registry.value,fe),n)},e.exports.lua_geti=function(r,n,l){let a=S(r,n);return Je(l),r.stack[r.top]=new N(x,l),q(r),rr.luaV_gettable(r,a,r.stack[r.top-1],r.top-1),r.stack[r.top-1].ttnov()},e.exports.lua_getmetatable=function(r,n){let l,a=S(r,n),u=!1;switch(a.ttnov()){case Y:case ee:l=a.value.metatable;break;default:l=r.l_G.mt[a.ttnov()]}return l!=null&&(r.stack[r.top]=new N(Y,l),q(r),u=!0),u},e.exports.lua_gettable=function(r,n){let l=S(r,n);return rr.luaV_gettable(r,l,r.stack[r.top-1],r.top-1),r.stack[r.top-1].ttnov()},e.exports.lua_gettop=function(r){return r.top-(r.ci.funcOff+1)},e.exports.lua_getupvalue=function(r,n,l){let a=Oe(0,S(r,n),l);if(a){let u=a.name,f=a.val;return d.pushobj2s(r,f),I(r,r.top<=r.ci.top,"stack overflow"),u}return null},e.exports.lua_getuservalue=function(r,n){let l=S(r,n);I(r,l.ttisfulluserdata(),"full userdata expected");let a=l.value.uservalue;return r.stack[r.top]=new N(a.type,a.value),q(r),r.stack[r.top-1].ttnov()},e.exports.lua_insert=function(r,n){A(r,n,1)},e.exports.lua_isboolean=function(r,n){return dr(r,n)===pe},e.exports.lua_iscfunction=function(r,n){let l=S(r,n);return l.ttislcf(l)||l.ttisCclosure()},e.exports.lua_isfunction=function(r,n){return dr(r,n)===j},e.exports.lua_isinteger=function(r,n){return S(r,n).ttisinteger()},e.exports.lua_islightuserdata=function(r,n){return dr(r,n)===Ve},e.exports.lua_isnil=function(r,n){return dr(r,n)===Ge},e.exports.lua_isnone=function(r,n){return dr(r,n)===Me},e.exports.lua_isnoneornil=function(r,n){return dr(r,n)<=0},e.exports.lua_isnumber=function(r,n){return rr.tonumber(S(r,n))!==!1},e.exports.lua_isproxy=function(r,n){let l=Ce.get(r);return!!l&&(n===null||n.l_G===l)},e.exports.lua_isstring=function(r,n){let l=S(r,n);return l.ttisstring()||rr.cvt2str(l)},e.exports.lua_istable=function(r,n){return S(r,n).ttistable()},e.exports.lua_isthread=function(r,n){return dr(r,n)===X},e.exports.lua_isuserdata=function(r,n){let l=S(r,n);return l.ttisfulluserdata(l)||l.ttislightuserdata()},e.exports.lua_len=function(r,n){let l=S(r,n),a=new N;rr.luaV_objlen(r,a,l),r.stack[r.top]=a,q(r)},e.exports.lua_load=function(r,n,l,a,u){a=a?Ke(a):xr,u!==null&&(u=Ke(u));let f=new R(r,n,l),s=me.luaD_protectedparser(r,f,a,u);if(s===Ne){let m=r.stack[r.top-1].value;if(m.nupvalues>=1){let xe=tr.luaH_getint(r.l_G.l_registry.value,fe);m.upvals[0].setfrom(xe)}}return s},e.exports.lua_newtable=function(r){_(r)},e.exports.lua_newuserdata=function(r,n){let l=(function(a,u){return new d.Udata(a,u)})(r,n);return r.stack[r.top]=new d.TValue(ee,l),q(r),l.data},e.exports.lua_next=function(r,n){let l=S(r,n);return I(r,l.ttistable(),"table expected"),r.stack[r.top]=new N,tr.luaH_next(r,l.value,r.top-1)?(q(r),1):(delete r.stack[r.top],delete r.stack[--r.top],0)},e.exports.lua_pcall=function(r,n,l,a){return lr(r,n,l,a,0,null)},e.exports.lua_pcallk=lr,e.exports.lua_pop=F,e.exports.lua_pushboolean=function(r,n){r.stack[r.top]=new N(pe,!!n),q(r)},e.exports.lua_pushcclosure=le,e.exports.lua_pushcfunction=or,e.exports.lua_pushfstring=function(r,n,...l){return n=Ke(n),d.luaO_pushvfstring(r,n,l)},e.exports.lua_pushglobaltable=function(r){Cr(r,H,fe)},e.exports.lua_pushinteger=function(r,n){Je(n),r.stack[r.top]=new N(x,n),q(r)},e.exports.lua_pushjsclosure=sr,e.exports.lua_pushjsfunction=ir,e.exports.lua_pushlightuserdata=function(r,n){r.stack[r.top]=new N(Ve,n),q(r)},e.exports.lua_pushliteral=function(r,n){if(n==null)r.stack[r.top]=new N(Ge,null),r.top++;else{ar(typeof n=="string");let l=ce(r,n);d.pushsvalue2s(r,l),n=l.getstr()}return I(r,r.top<=r.ci.top,"stack overflow"),n},e.exports.lua_pushlstring=function(r,n,l){let a;return Je(l),l===0?(n=je("",!0),a=U(r,n)):(n=Ke(n),I(r,n.length>=l,"invalid length to lua_pushlstring"),a=oe(r,n.subarray(0,l))),d.pushsvalue2s(r,a),I(r,r.top<=r.ci.top,"stack overflow"),a.value},e.exports.lua_pushnil=function(r){r.stack[r.top]=new N(Ge,null),q(r)},e.exports.lua_pushnumber=function(r,n){ar(typeof n=="number"),r.stack[r.top]=new N(Ye,n),q(r)},e.exports.lua_pushstring=function(r,n){if(n==null)r.stack[r.top]=new N(Ge,null),r.top++;else{let l=oe(r,Ke(n));d.pushsvalue2s(r,l),n=l.getstr()}return I(r,r.top<=r.ci.top,"stack overflow"),n},e.exports.lua_pushthread=function(r){return r.stack[r.top]=new N(X,r),q(r),r.l_G.mainthread===r},e.exports.lua_pushvalue=function(r,n){d.pushobj2s(r,S(r,n)),I(r,r.top<=r.ci.top,"stack overflow")},e.exports.lua_pushvfstring=function(r,n,l){return n=Ke(n),d.luaO_pushvfstring(r,n,l)},e.exports.lua_rawequal=function(r,n,l){let a=S(r,n),u=S(r,l);return ke(a)&&ke(u)?rr.luaV_equalobj(null,a,u):0},e.exports.lua_rawget=function(r,n){let l=S(r,n);return I(r,l.ttistable(l),"table expected"),d.setobj2s(r,r.top-1,tr.luaH_get(r,l.value,r.stack[r.top-1])),r.stack[r.top-1].ttnov()},e.exports.lua_rawgeti=Cr,e.exports.lua_rawgetp=function(r,n,l){let a=S(r,n);I(r,a.ttistable(),"table expected");let u=new N(Ve,l);return d.pushobj2s(r,tr.luaH_get(r,a.value,u)),I(r,r.top<=r.ci.top,"stack overflow"),r.stack[r.top-1].ttnov()},e.exports.lua_rawlen=function(r,n){let l=S(r,n);switch(l.ttype()){case w:case ye:return l.vslen();case ee:return l.value.len;case Y:return tr.luaH_getn(l.value);default:return 0}},e.exports.lua_rawset=function(r,n){Re(r,2);let l=S(r,n);I(r,l.ttistable(),"table expected");let a=r.stack[r.top-2],u=r.stack[r.top-1];tr.luaH_setfrom(r,l.value,a,u),tr.invalidateTMcache(l.value),delete r.stack[--r.top],delete r.stack[--r.top]},e.exports.lua_rawseti=function(r,n,l){Je(l),Re(r,1);let a=S(r,n);I(r,a.ttistable(),"table expected"),tr.luaH_setint(a.value,l,r.stack[r.top-1]),delete r.stack[--r.top]},e.exports.lua_rawsetp=function(r,n,l){Re(r,1);let a=S(r,n);I(r,a.ttistable(),"table expected");let u=new N(Ve,l),f=r.stack[r.top-1];tr.luaH_setfrom(r,a.value,u,f),delete r.stack[--r.top]},e.exports.lua_register=function(r,n,l){or(r,l),Sr(r,n)},e.exports.lua_remove=function(r,n){A(r,n,-1),F(r,1)},e.exports.lua_replace=function(r,n){z(r,-1,n),F(r,1)},e.exports.lua_rotate=A,e.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},e.exports.lua_setfield=function(r,n,l){Ur(r,S(r,n),l)},e.exports.lua_setglobal=Sr,e.exports.lua_seti=function(r,n,l){Je(l),Re(r,1);let a=S(r,n);r.stack[r.top]=new N(x,l),q(r),rr.settable(r,a,r.stack[r.top-1],r.stack[r.top-2]),delete r.stack[--r.top],delete r.stack[--r.top]},e.exports.lua_setmetatable=function(r,n){let l;Re(r,1);let a=S(r,n);switch(r.stack[r.top-1].ttisnil()?l=null:(I(r,r.stack[r.top-1].ttistable(),"table expected"),l=r.stack[r.top-1].value),a.ttnov()){case ee:case Y:a.value.metatable=l;break;default:r.l_G.mt[a.ttnov()]=l}return delete r.stack[--r.top],!0},e.exports.lua_settable=function(r,n){Re(r,2);let l=S(r,n);rr.settable(r,l,r.stack[r.top-2],r.stack[r.top-1]),delete r.stack[--r.top],delete r.stack[--r.top]},e.exports.lua_settop=p,e.exports.lua_setupvalue=function(r,n,l){let a=S(r,n);Re(r,1);let u=Oe(0,a,l);if(u){let f=u.name;return u.val.setfrom(r.stack[r.top-1]),delete r.stack[--r.top],f}return null},e.exports.lua_setuservalue=function(r,n){Re(r,1);let l=S(r,n);I(r,l.ttisfulluserdata(),"full userdata expected"),l.value.uservalue.setfrom(r.stack[r.top-1]),delete r.stack[--r.top]},e.exports.lua_status=function(r){return r.status},e.exports.lua_stringtonumber=function(r,n){let l=new N,a=d.luaO_str2num(n,l);return a!==0&&(r.stack[r.top]=l,q(r)),a},e.exports.lua_toboolean=function(r,n){return!S(r,n).l_isfalse()},e.exports.lua_tocfunction=function(r,n){let l=S(r,n);return l.ttislcf()||l.ttisCclosure()?l.value:null},e.exports.lua_todataview=function(r,n){let l=be(r,n);return new DataView(l.buffer,l.byteOffset,l.byteLength)},e.exports.lua_tointeger=function(r,n){let l=ae(r,n);return l===!1?0:l},e.exports.lua_tointegerx=ae,e.exports.lua_tojsstring=function(r,n){let l=S(r,n);if(!l.ttisstring()){if(!rr.cvt2str(l))return null;d.luaO_tostring(r,l)}return l.jsstring()},e.exports.lua_tolstring=be,e.exports.lua_tonumber=function(r,n){let l=ie(r,n);return l===!1?0:l},e.exports.lua_tonumberx=ie,e.exports.lua_topointer=function(r,n){let l=S(r,n);switch(l.ttype()){case Y:case $:case he:case se:case X:case ee:case Ve:return l.value;default:return null}},e.exports.lua_toproxy=function(r,n){let l=S(r,n);return(function(a,u,f){let s=function(m){I(m,m instanceof k.lua_State&&a===m.l_G,"must be from same global state"),m.stack[m.top]=new N(u,f),q(m)};return Ce.set(s,a),s})(r.l_G,l.type,l.value)},e.exports.lua_tostring=ge,e.exports.lua_tothread=function(r,n){let l=S(r,n);return l.ttisthread()?l.value:null},e.exports.lua_touserdata=function(r,n){let l=S(r,n);switch(l.ttnov()){case ee:return l.value.data;case Ve:return l.value;default:return null}},e.exports.lua_type=dr,e.exports.lua_typename=function(r,n){return I(r,Me<=n&&n<we,"invalid tag"),nr.ttypename(n)},e.exports.lua_upvalueid=function(r,n,l){let a=S(r,n);switch(a.ttype()){case $:{let u=br(r,n,l);return u.f.upvals[u.i]}case he:{let u=a.value;return I(r,(0|l)===l&&l>0&&l<=u.nupvalues,"invalid upvalue index"),u.upvalue[l-1]}default:return I(r,!1,"closure expected"),null}},e.exports.lua_upvaluejoin=function(r,n,l,a,u){let f=br(r,n,l),s=br(r,a,u),m=s.f.upvals[s.i];f.f.upvals[f.i]=m},e.exports.lua_version=function(r){return r===null?B:r.l_G.version},e.exports.lua_xmove=function(r,n,l){if(r!==n){Re(r,l),I(r,r.l_G===n.l_G,"moving among independent states"),I(r,n.ci.top-n.top>=l,"stack overflow"),r.top-=l;for(let a=0;a<l;a++)n.stack[n.top]=new d.TValue,d.setobj2s(n,n.top,r.stack[r.top+a]),delete r.stack[r.top+a],n.top++}}},function(e,hr,h){const{lua_assert:b}=h(4),g=function(V){let K=V.reader(V.L,V.data);if(K===null)return-1;b(K instanceof Uint8Array,"Should only load binary of array of bytes");let _e=K.length;return _e===0?-1:(V.buffer=K,V.off=0,V.n=_e-1,V.buffer[V.off++])};e.exports.EOZ=-1,e.exports.luaZ_buffer=function(V){return V.buffer.subarray(0,V.n)},e.exports.luaZ_buffremove=function(V,K){V.n-=K},e.exports.luaZ_fill=g,e.exports.luaZ_read=function(V,K,_e,He){for(;He;){if(V.n===0){if(g(V)===-1)return He;V.n++,V.off--}let H=He<=V.n?He:V.n;for(let fe=0;fe<H;fe++)K[_e++]=V.buffer[V.off++];V.n-=H,V.n===0&&(V.buffer=null),He-=H}return 0},e.exports.luaZ_resetbuffer=function(V){V.n=0},e.exports.luaZ_resizebuffer=function(V,K,_e){let He=new Uint8Array(_e);K.buffer&&He.set(K.buffer),K.buffer=He},e.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},e.exports.ZIO=class{constructor(V,K,_e){this.L=V,b(typeof K=="function","ZIO requires a reader"),this.reader=K,this.data=_e,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:g(this)}}},function(e,hr,h){const{constant_types:{LUA_TBOOLEAN:b,LUA_TLNGSTR:g},thread_status:{LUA_ERRSYNTAX:V},to_luastring:K}=h(1),{LUA_MINBUFFER:_e,MAX_INT:He,lua_assert:H}=h(4),fe=h(11),B=h(8),{lisdigit:we,lislalnum:pe,lislalpha:he,lisspace:j,lisxdigit:se}=h(22),$=h(6),{luaS_bless:Ve,luaS_hash:ye,luaS_hashlongstr:Ge,luaS_new:Me}=h(10),Ye=h(9),{EOZ:x,luaZ_buffer:w,luaZ_buffremove:Y,luaZ_resetbuffer:X,luaZ_resizebuffer:ee}=h(19),Ne=K("_ENV",!0),Ke={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},je=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map((p,F)=>K(p));class I{constructor(){this.r=NaN,this.i=NaN,this.ts=null}}class Z{constructor(){this.token=NaN,this.seminfo=new I}}const me=function(p,F){let Le=p.buff;if(Le.n+1>Le.buffer.length){Le.buffer.length>=He/2&&tr(p,K("lexical element too long",!0),0);let A=2*Le.buffer.length;ee(p.L,Le,A)}Le.buffer[Le.n++]=F<0?255+F+1:F},W=function(p,F){if(F<257)return $.luaO_pushfstring(p.L,K("'%c'",!0),F);{let Le=je[F-257];return F<289?$.luaO_pushfstring(p.L,K("'%s'",!0),Le):Le}},Fe=function(p){return p.current===10||p.current===13},d=function(p){p.current=p.z.zgetc()},k=function(p){me(p,p.current),d(p)},U=new $.TValue(b,!0),oe=function(p,F){let Le=p.L,A=Me(Le,F),z=p.h.strong.get(Ge(A));if(z)A=z.key.tsvalue();else{let le=new $.TValue(g,A);Ye.luaH_setfrom(Le,p.h,le,U)}return A},ce=function(p){let F=p.current;H(Fe(p)),d(p),Fe(p)&&p.current!==F&&d(p),++p.linenumber>=He&&tr(p,K("chunk has too many lines",!0),0)},nr=function(p,F){return p.current===F&&(d(p),!0)},ze=function(p,F){return(p.current===F[0].charCodeAt(0)||p.current===F[1].charCodeAt(0))&&(k(p),!0)},rr=function(p,F){let Le="Ee",A=p.current;for(H(we(p.current)),k(p),A===48&&ze(p,"xX")&&(Le="Pp");;)if(ze(p,Le)&&ze(p,"-+"),se(p.current))k(p);else{if(p.current!==46)break;k(p)}let z=new $.TValue;return $.luaO_str2num(w(p.buff),z)===0&&tr(p,K("malformed number",!0),290),z.ttisinteger()?(F.i=z.value,291):(H(z.ttisfloat()),F.r=z.value,290)},tr=function(p,F,Le){F=fe.luaG_addinfo(p.L,F,p.source,p.linenumber),Le&&$.luaO_pushfstring(p.L,K("%s near %s"),F,(function(A,z){switch(z){case 292:case 293:case 290:case 291:return $.luaO_pushfstring(A.L,K("'%s'",!0),w(A.buff));default:return W(A,z)}})(p,Le)),B.luaD_throw(p.L,V)},R=function(p){let F=0,Le=p.current;for(H(Le===91||Le===93),k(p);p.current===61;)k(p),F++;return p.current===Le?F:-F-1},N=function(p,F,Le){let A=p.linenumber;k(p),Fe(p)&&ce(p);let z=!1;for(;!z;)switch(p.current){case x:tr(p,K(`unfinished long ${F?"string":"comment"} (starting at line ${A})`),289);break;case 93:R(p)===Le&&(k(p),z=!0);break;case 10:case 13:me(p,10),ce(p),F||X(p.buff);break;default:F?k(p):d(p)}F&&(F.ts=oe(p,p.buff.buffer.subarray(2+Le,p.buff.n-(2+Le))))},de=function(p,F,Le){F||(p.current!==x&&k(p),tr(p,Le,293))},q=function(p){return k(p),de(p,se(p.current),K("hexadecimal digit expected",!0)),$.luaO_hexavalue(p.current)},Re=function(p){let F=q(p);return F=(F<<4)+q(p),Y(p.buff,2),F},ar=function(p){let F=new Uint8Array($.UTF8BUFFSZ),Le=$.luaO_utf8esc(F,(function(A){let z=4;k(A),de(A,A.current===123,K("missing '{'",!0));let le=q(A);for(k(A);se(A.current);)z++,le=(le<<4)+$.luaO_hexavalue(A.current),de(A,le<=1114111,K("UTF-8 value too large",!0)),k(A);return de(A,A.current===125,K("missing '}'",!0)),d(A),Y(A.buff,z),le})(p));for(;Le>0;Le--)me(p,F[$.UTF8BUFFSZ-Le])},Je=function(p){let F,Le=0;for(F=0;F<3&&we(p.current);F++)Le=10*Le+p.current-48,k(p);return de(p,Le<=255,K("decimal escape too large",!0)),Y(p.buff,F),Le},ke=function(p,F,Le){for(k(p);p.current!==F;)switch(p.current){case x:tr(p,K("unfinished string",!0),289);break;case 10:case 13:tr(p,K("unfinished string",!0),293);break;case 92:{let A,z;switch(k(p),p.current){case 97:z=7,A="read_save";break;case 98:z=8,A="read_save";break;case 102:z=12,A="read_save";break;case 110:z=10,A="read_save";break;case 114:z=13,A="read_save";break;case 116:z=9,A="read_save";break;case 118:z=11,A="read_save";break;case 120:z=Re(p),A="read_save";break;case 117:ar(p),A="no_save";break;case 10:case 13:ce(p),z=10,A="only_save";break;case 92:case 34:case 39:z=p.current,A="read_save";break;case x:A="no_save";break;case 122:for(Y(p.buff,1),d(p);j(p.current);)Fe(p)?ce(p):d(p);A="no_save";break;default:de(p,we(p.current),K("invalid escape sequence",!0)),z=Je(p),A="only_save"}A==="read_save"&&d(p),A!=="read_save"&&A!=="only_save"||(Y(p.buff,1),me(p,z));break}default:k(p)}k(p),Le.ts=oe(p,p.buff.buffer.subarray(1,p.buff.n-1))},S=Object.create(null);je.forEach((p,F)=>S[ye(p)]=F);const ue=function(p,F){for(X(p.buff);;)switch(H(typeof p.current=="number"),p.current){case 10:case 13:ce(p);break;case 32:case 12:case 9:case 11:d(p);break;case 45:if(d(p),p.current!==45)return 45;if(d(p),p.current===91){let Le=R(p);if(X(p.buff),Le>=0){N(p,null,Le),X(p.buff);break}}for(;!Fe(p)&&p.current!==x;)d(p);break;case 91:{let Le=R(p);return Le>=0?(N(p,F,Le),293):(Le!==-1&&tr(p,K("invalid long string delimiter",!0),293),91)}case 61:return d(p),nr(p,61)?282:61;case 60:return d(p),nr(p,61)?284:nr(p,60)?286:60;case 62:return d(p),nr(p,61)?283:nr(p,62)?287:62;case 47:return d(p),nr(p,47)?279:47;case 126:return d(p),nr(p,61)?285:126;case 58:return d(p),nr(p,58)?288:58;case 34:case 39:return ke(p,p.current,F),293;case 46:return k(p),nr(p,46)?nr(p,46)?281:280:we(p.current)?rr(p,F):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return rr(p,F);case x:return 289;default:if(he(p.current)){do k(p);while(pe(p.current));let Le=oe(p,w(p.buff));F.ts=Le;let A=S[Ge(Le)];return A!==void 0&&A<=22?A+257:292}{let Le=p.current;return d(p),Le}}};e.exports.FIRST_RESERVED=257,e.exports.LUA_ENV=Ne,e.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new Z,this.lookahead=new Z,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},e.exports.RESERVED=Ke,e.exports.isreserved=function(p){let F=S[Ge(p)];return F!==void 0&&F<=22},e.exports.luaX_lookahead=function(p){return H(p.lookahead.token===289),p.lookahead.token=ue(p,p.lookahead.seminfo),p.lookahead.token},e.exports.luaX_newstring=oe,e.exports.luaX_next=function(p){p.lastline=p.linenumber,p.lookahead.token!==289?(p.t.token=p.lookahead.token,p.t.seminfo.i=p.lookahead.seminfo.i,p.t.seminfo.r=p.lookahead.seminfo.r,p.t.seminfo.ts=p.lookahead.seminfo.ts,p.lookahead.token=289):p.t.token=ue(p,p.t.seminfo)},e.exports.luaX_setinput=function(p,F,Le,A,z){F.t={token:0,seminfo:new I},F.L=p,F.current=z,F.lookahead={token:289,seminfo:new I},F.z=Le,F.fs=null,F.linenumber=1,F.lastline=1,F.source=A,F.envn=Ve(p,Ne),ee(p,F.buff,_e)},e.exports.luaX_syntaxerror=function(p,F){tr(p,F,p.t.token)},e.exports.luaX_token2str=W,e.exports.luaX_tokens=je},function(e,hr,h){const{lua:b,lauxlib:g,lualib:V,to_luastring:K}=h(0),{LUA_MULTRET:_e,LUA_OK:He,LUA_REGISTRYINDEX:H,LUA_RIDX_MAINTHREAD:fe,LUA_TBOOLEAN:B,LUA_TFUNCTION:we,LUA_TLIGHTUSERDATA:pe,LUA_TNIL:he,LUA_TNONE:j,LUA_TNUMBER:se,LUA_TSTRING:$,LUA_TTABLE:Ve,LUA_TTHREAD:ye,LUA_TUSERDATA:Ge,lua_atnativeerror:Me,lua_call:Ye,lua_getfield:x,lua_gettable:w,lua_gettop:Y,lua_isnil:X,lua_isproxy:ee,lua_newuserdata:Ne,lua_pcall:Ke,lua_pop:je,lua_pushboolean:I,lua_pushcfunction:Z,lua_pushinteger:me,lua_pushlightuserdata:W,lua_pushliteral:Fe,lua_pushnil:d,lua_pushnumber:k,lua_pushstring:U,lua_pushvalue:oe,lua_rawgeti:ce,lua_rawgetp:nr,lua_rawsetp:ze,lua_rotate:rr,lua_setfield:tr,lua_settable:R,lua_settop:N,lua_toboolean:de,lua_tojsstring:q,lua_tonumber:Re,lua_toproxy:ar,lua_tothread:Je,lua_touserdata:ke,lua_type:S}=b,{luaL_argerror:ue,luaL_checkany:p,luaL_checkoption:F,luaL_checkstack:Le,luaL_checkudata:A,luaL_error:z,luaL_getmetafield:le,luaL_newlib:sr,luaL_newmetatable:or,luaL_requiref:ir,luaL_setfuncs:Ur,luaL_setmetatable:Sr,luaL_testudata:Rr,luaL_tolstring:Cr}=g,{luaopen_base:_}=V,Oe=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:(0,eval)("this");let be,ge,ae;if(typeof Reflect<"u")be=Reflect.apply,ge=Reflect.construct,ae=Reflect.deleteProperty;else{const L=Function.apply,ne=Function.bind;be=function(M,Pe,cr){return L.call(M,Pe,cr)},ge=function(M,Pe){switch(Pe.length){case 0:return new M;case 1:return new M(Pe[0]);case 2:return new M(Pe[0],Pe[1]);case 3:return new M(Pe[0],Pe[1],Pe[2]);case 4:return new M(Pe[0],Pe[1],Pe[2],Pe[3])}let cr=[null];return cr.push.apply(cr,Pe),new(ne.apply(M,cr))},ae=Function("t","k","delete t[k]")}const ie=String.prototype.concat.bind(""),Ce=function(L){return typeof L=="object"?L!==null:typeof L=="function"},Lr=K("js object"),dr=function(L,ne){let M=Rr(L,ne,Lr);return M?M.data:void 0},xr=function(L,ne){return A(L,ne,Lr).data},Mr=function(L,ne){Ne(L).data=ne,Sr(L,Lr)},Qe=function(L){ce(L,H,fe);let ne=Je(L,-1);return je(L,1),ne},lr=new WeakMap,br=function(L,ne){switch(typeof ne){case"undefined":d(L);break;case"number":k(L,ne);break;case"string":U(L,K(ne));break;case"boolean":I(L,ne);break;case"symbol":W(L,ne);break;case"function":if(ee(ne,L)){ne(L);break}case"object":if(ne===null){if(nr(L,H,null)!==Ge)throw Error("js library not loaded into lua_State");break}default:{let M=lr.get(Qe(L));if(!M)throw Error("js library not loaded into lua_State");let Pe=M.get(ne);Pe?Pe(L):(Mr(L,ne),Pe=ar(L,-1),M.set(ne,Pe))}}},r=function(L){let ne=ke(L,1);return br(L,ne),1},n=function(L,ne){switch(S(L,ne)){case j:case he:return;case B:return de(L,ne);case pe:return ke(L,ne);case se:return Re(L,ne);case $:return q(L,ne);case Ge:{let M=dr(L,ne);if(M!==void 0)return M}case Ve:case we:case ye:default:return Tr(L,ar(L,ne))}},l=function(L,ne){let M=Ke(L,ne,1,0),Pe=n(L,-1);switch(je(L,1),M){case He:return Pe;default:throw Pe}},a=function(L,ne,M,Pe,cr){if(!Ce(Pe))throw new TypeError("`args` argument must be an object");let _r=+Pe.length;_r>=0||(_r=0),Le(L,2+_r,null);let ur=Y(L);ne(L),br(L,M);for(let kr=0;kr<_r;kr++)br(L,Pe[kr]);switch(Ke(L,1+_r,cr,0)){case He:{let kr=Y(L)-ur,Vr=new Array(kr);for(let pr=0;pr<kr;pr++)Vr[pr]=n(L,ur+pr+1);return N(L,ur),Vr}default:{let kr=n(L,-1);throw N(L,ur),kr}}},u=function(L){return w(L,1),1},f=function(L,ne,M){return Le(L,3,null),Z(L,u),ne(L),br(L,M),l(L,2)},s=function(L,ne,M){switch(Le(L,3,null),Z(L,u),ne(L),br(L,M),Ke(L,2,1,0)){case He:{let Pe=X(L,-1);return je(L,1),!Pe}default:{let Pe=n(L,-1);throw je(L,1),Pe}}},m=function(L,ne,M,Pe){switch(Le(L,4,null),Z(L,function(cr){return R(cr,1),0}),ne(L),br(L,M),br(L,Pe),Ke(L,3,0,0)){case He:return;default:{let cr=n(L,-1);throw je(L,1),cr}}},xe=function(L,ne,M){switch(Le(L,4,null),Z(L,function(Pe){return R(Pe,1),0}),ne(L),br(L,M),d(L),Ke(L,3,0,0)){case He:return;default:{let Pe=n(L,-1);throw je(L,1),Pe}}},Be=function(L,ne){return Le(L,2,null),Z(L,function(M){return Cr(M,1),1}),ne(L),l(L,1)},Ar=function(){let L=this.L;Le(L,3,null);let ne=Y(L);switch(this.iter(L),this.state(L),this.last(L),Ke(L,2,_e,0)){case He:{let M;if(this.last=ar(L,ne+1),X(L,-1))M={done:!0,value:void 0};else{let Pe=Y(L)-ne,cr=new Array(Pe);for(let _r=0;_r<Pe;_r++)cr[_r]=n(L,ne+_r+1);M={done:!1,value:cr}}return N(L,ne),M}default:{let M=n(L,-1);throw je(L,1),M}}},Tr=function(L,ne){const M=Qe(L);let Pe=function(){return a(M,ne,this,arguments,1)[0]};Pe.apply=function(_r,ur){return a(M,ne,_r,ur,1)[0]},Pe.invoke=function(_r,ur){return a(M,ne,_r,ur,_e)},Pe.get=function(_r){return f(M,ne,_r)},Pe.has=function(_r){return s(M,ne,_r)},Pe.set=function(_r,ur){return m(M,ne,_r,ur)},Pe.delete=function(_r){return xe(M,ne,_r)},Pe.toString=function(){return Be(M,ne)},typeof Symbol=="function"&&(Pe[Symbol.toStringTag]="Fengari object",Pe[Symbol.iterator]=function(){return(function(_r,ur){switch(Le(_r,1,null),Z(_r,function(kr){return ir(kr,K("_G"),_,0),x(kr,-1,K("pairs")),ur(kr),Ye(kr,1,3),3}),Ke(_r,0,3,0)){case He:{let kr=ar(_r,-3),Vr=ar(_r,-2),pr=ar(_r,-1);return je(_r,3),{L:_r,iter:kr,state:Vr,last:pr,next:Ar}}default:{let kr=n(_r,-1);throw je(_r,1),kr}}})(M,ne)},Symbol.toPrimitive&&(Pe[Symbol.toPrimitive]=function(_r){if(_r==="string")return Be(M,ne)}));let cr=lr.get(M);if(!cr)throw Error("js library not loaded into lua_State");return cr.set(Pe,ne),Pe},y={new:function(L){let ne=n(L,1),M=Y(L)-1,Pe=new Array(M);for(let cr=0;cr<M;cr++)Pe[cr]=n(L,cr+2);return br(L,ge(ne,Pe)),1},tonumber:function(L){let ne=n(L,1);return k(L,+ne),1},tostring:function(L){let ne=n(L,1);return Fe(L,ie(ne)),1},instanceof:function(L){let ne=n(L,1),M=n(L,2);return I(L,ne instanceof M),1},typeof:function(L){let ne=n(L,1);return Fe(L,typeof ne),1}};if(typeof Symbol=="function"&&Symbol.iterator){const L=function(M,Pe){let cr=xr(M,Pe),_r=cr[Symbol.iterator];_r||ue(M,Pe,K("object not iterable"));let ur=be(_r,cr,[]);return Ce(ur)||ue(M,Pe,K("Result of the Symbol.iterator method is not an object")),ur},ne=function(M){let Pe=n(M,1).next();return Pe.done?0:(br(M,Pe.value),1)};y.of=function(M){let Pe=L(M,1);return Z(M,ne),br(M,Pe),2}}if(typeof Proxy=="function"&&typeof Symbol=="function"){const L=Symbol("lua_State"),ne=Symbol("fengari-proxy"),M={apply:function(pr,Er,vr){return a(pr[L],pr[ne],Er,vr,1)[0]},construct:function(pr,Er){let vr=pr[L],wr=pr[ne],Ir=Er.length;Le(vr,2+Ir,null),wr(vr);let Fr=Y(vr);if(le(vr,Fr,K("construct"))===he)throw je(vr,1),new TypeError("not a constructor");rr(vr,Fr,1);for(let Dr=0;Dr<Ir;Dr++)br(vr,Er[Dr]);return l(vr,1+Ir)},defineProperty:function(pr,Er,vr){let wr=pr[L],Ir=pr[ne];return Le(wr,4,null),Ir(wr),le(wr,-1,K("defineProperty"))===he?(je(wr,1),!1):(rr(wr,-2,1),br(wr,Er),br(wr,vr),l(wr,3))},deleteProperty:function(pr,Er){return xe(pr[L],pr[ne],Er)},get:function(pr,Er){return f(pr[L],pr[ne],Er)},getOwnPropertyDescriptor:function(pr,Er){let vr=pr[L],wr=pr[ne];if(Le(vr,3,null),wr(vr),le(vr,-1,K("getOwnPropertyDescriptor"))!==he)return rr(vr,-2,1),br(vr,Er),l(vr,2);je(vr,1)},getPrototypeOf:function(pr){let Er=pr[L],vr=pr[ne];return Le(Er,2,null),vr(Er),le(Er,-1,K("getPrototypeOf"))===he?(je(Er,1),null):(rr(Er,-2,1),l(Er,1))},has:function(pr,Er){return s(pr[L],pr[ne],Er)},ownKeys:function(pr){let Er=pr[L],vr=pr[ne];if(Le(Er,2,null),vr(Er),le(Er,-1,K("ownKeys"))===he)throw je(Er,1),Error("ownKeys unknown for fengari object");return rr(Er,-2,1),l(Er,1)},set:function(pr,Er,vr){return m(pr[L],pr[ne],Er,vr),!0},setPrototypeOf:function(pr,Er){let vr=pr[L],wr=pr[ne];return Le(vr,3,null),wr(vr),le(vr,-1,K("setPrototypeOf"))===he?(je(vr,1),!1):(rr(vr,-2,1),br(vr,Er),l(vr,2))}},Pe=function(){let pr=(function(){}).bind();return delete pr.length,delete pr.name,pr},cr=Function("return ()=>void 0;"),_r=function(){let pr=cr();return delete pr.length,delete pr.name,pr},ur=function(pr,Er,vr){const wr=Qe(pr);let Ir;switch(vr){case"function":Ir=Pe();break;case"arrow_function":Ir=_r();break;case"object":Ir={};break;default:throw TypeError("invalid type to createproxy")}return Ir[ne]=Er,Ir[L]=wr,new Proxy(Ir,M)},kr=["function","arrow_function","object"],Vr=kr.map(pr=>K(pr));y.createproxy=function(pr){p(pr,1);let Er=kr[F(pr,2,Vr[0],Vr)],vr=ur(pr,ar(pr,1),Er);return br(pr,vr),1}}let Ue={__index:function(L){let ne=xr(L,1),M=n(L,2);return br(L,ne[M]),1},__newindex:function(L){let ne=xr(L,1),M=n(L,2),Pe=n(L,3);return Pe===void 0?ae(ne,M):ne[M]=Pe,0},__tostring:function(L){let ne=xr(L,1),M=ie(ne);return U(L,K(M)),1},__call:function(L){let ne,M=xr(L,1),Pe=Y(L)-1,cr=new Array(Math.max(0,Pe-1));if(Pe>0&&(ne=n(L,2),Pe-- >0))for(let _r=0;_r<Pe;_r++)cr[_r]=n(L,_r+3);return br(L,be(M,ne,cr)),1},__pairs:function(L){let ne,M,Pe,cr,_r=xr(L,1);if(typeof Symbol!="function"||(ne=_r[Symbol.for("__pairs")])===void 0)M=function(ur){if(this.index>=this.keys.length)return;let kr=this.keys[this.index++];return[kr,this.object[kr]]},Pe={object:_r,keys:Object.keys(_r),index:0};else{let ur=be(ne,_r,[]);ur===void 0&&z(L,K("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),(M=ur.iter)===void 0&&z(L,K("bad '__pairs' result (object.iter is missing)")),Pe=ur.state,cr=ur.first}return Z(L,function(){let ur=n(L,1),kr=n(L,2),Vr=be(M,ur,[kr]);if(Vr===void 0)return 0;Array.isArray(Vr)||z(L,K("bad iterator result (Array or undefined expected)")),Le(L,Vr.length,null);for(let pr=0;pr<Vr.length;pr++)br(L,Vr[pr]);return Vr.length}),br(L,Pe),br(L,cr),3},__len:function(L){let ne,M,Pe=xr(L,1);return M=typeof Symbol!="function"||(ne=Pe[Symbol.for("__len")])===void 0?Pe.length:be(ne,Pe,[]),br(L,M),1}};e.exports.FENGARI_INTEROP_VERSION="0.1",e.exports.FENGARI_INTEROP_VERSION_NUM=1,e.exports.FENGARI_INTEROP_RELEASE="0.1.2",e.exports.checkjs=xr,e.exports.testjs=dr,e.exports.pushjs=Mr,e.exports.push=br,e.exports.tojs=n,e.exports.luaopen_js=function(L){return lr.set(Qe(L),new WeakMap),Me(L,r),sr(L,y),Fe(L,"0.1"),tr(L,-2,K("_VERSION")),me(L,1),tr(L,-2,K("_VERSION_NUM")),Fe(L,"0.1.2"),tr(L,-2,K("_RELEASE")),or(L,Lr),Ur(L,Ue,0),je(L,1),Mr(L,null),oe(L,-1),ze(L,H,null),tr(L,-2,K("null")),br(L,Oe),tr(L,-2,K("global")),1}},function(e,hr,h){const{luastring_of:b}=h(1),g=b(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e.exports.lisdigit=function(V){return(2&g[V+1])!=0},e.exports.lislalnum=function(V){return(3&g[V+1])!=0},e.exports.lislalpha=function(V){return(1&g[V+1])!=0},e.exports.lisprint=function(V){return(4&g[V+1])!=0},e.exports.lisspace=function(V){return(8&g[V+1])!=0},e.exports.lisxdigit=function(V){return(16&g[V+1])!=0}},function(e,hr,h){const{LUA_MULTRET:b,to_luastring:g}=h(1),{BinOpr:{OPR_ADD:V,OPR_AND:K,OPR_BAND:_e,OPR_BOR:He,OPR_BXOR:H,OPR_CONCAT:fe,OPR_DIV:B,OPR_EQ:we,OPR_GE:pe,OPR_GT:he,OPR_IDIV:j,OPR_LE:se,OPR_LT:$,OPR_MOD:Ve,OPR_MUL:ye,OPR_NE:Ge,OPR_NOBINOPR:Me,OPR_OR:Ye,OPR_POW:x,OPR_SHL:w,OPR_SHR:Y,OPR_SUB:X},UnOpr:{OPR_BNOT:ee,OPR_LEN:Ne,OPR_MINUS:Ke,OPR_NOT:je,OPR_NOUNOPR:I},NO_JUMP:Z,getinstruction:me,luaK_checkstack:W,luaK_codeABC:Fe,luaK_codeABx:d,luaK_codeAsBx:k,luaK_codek:U,luaK_concat:oe,luaK_dischargevars:ce,luaK_exp2RK:nr,luaK_exp2anyreg:ze,luaK_exp2anyregup:rr,luaK_exp2nextreg:tr,luaK_exp2val:R,luaK_fixline:N,luaK_getlabel:de,luaK_goiffalse:q,luaK_goiftrue:Re,luaK_indexed:ar,luaK_infix:Je,luaK_intK:ke,luaK_jump:S,luaK_jumpto:ue,luaK_nil:p,luaK_patchclose:F,luaK_patchlist:Le,luaK_patchtohere:A,luaK_posfix:z,luaK_prefix:le,luaK_reserveregs:sr,luaK_ret:or,luaK_self:ir,luaK_setlist:Ur,luaK_setmultret:Sr,luaK_setoneret:Rr,luaK_setreturns:Cr,luaK_storevar:_,luaK_stringK:Oe}=h(35),be=h(8),ge=h(13),ae=h(20),{LUAI_MAXCCALLS:ie,MAX_INT:Ce,lua_assert:Lr}=h(4),dr=h(6),{OpCodesI:{OP_CALL:xr,OP_CLOSURE:Mr,OP_FORLOOP:Qe,OP_FORPREP:lr,OP_GETUPVAL:br,OP_MOVE:r,OP_NEWTABLE:n,OP_SETTABLE:l,OP_TAILCALL:a,OP_TFORCALL:u,OP_TFORLOOP:f,OP_VARARG:s},LFIELDS_PER_FLUSH:m,SETARG_B:xe,SETARG_C:Be,SET_OPCODE:Ar}=h(16),{luaS_eqlngstr:Tr,luaS_new:y,luaS_newliteral:Ue}=h(10),L=h(9),ne=ge.Proto,M=ae.RESERVED,Pe=function(i){return i===ur.VCALL||i===ur.VVARARG},cr=function(i,E){return Tr(i,E)};class _r{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}}const ur={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};class kr{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(E){this.k=E.k,this.u=E.u,this.t=E.t,this.f=E.f}}class Vr{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}}class pr{constructor(){this.arr=[],this.n=NaN,this.size=NaN}}const Er=function(i,E){i.t.token=0,ae.luaX_syntaxerror(i,E)},vr=function(i,E){ae.luaX_syntaxerror(i,dr.luaO_pushfstring(i.L,g("%s expected",!0),ae.luaX_token2str(i,E)))},wr=function(i,E,re,Te){E>re&&(function(te,J,De){let We=te.ls.L,mr=te.f.linedefined,Pr=mr===0?g("main function",!0):dr.luaO_pushfstring(We,g("function at line %d",!0),mr),Hr=dr.luaO_pushfstring(We,g("too many %s (limit is %d) in %s",!0),De,J,Pr);ae.luaX_syntaxerror(te.ls,Hr)})(i,re,Te)},Ir=function(i,E){return i.t.token===E&&(ae.luaX_next(i),!0)},Fr=function(i,E){i.t.token!==E&&vr(i,E)},Dr=function(i,E){Fr(i,E),ae.luaX_next(i)},jr=function(i,E,re){E||ae.luaX_syntaxerror(i,re)},Gr=function(i,E,re,Te){Ir(i,E)||(Te===i.linenumber?vr(i,E):ae.luaX_syntaxerror(i,dr.luaO_pushfstring(i.L,g("%s expected (to close %s at line %d)"),ae.luaX_token2str(i,E),ae.luaX_token2str(i,re),Te)))},c=function(i){Fr(i,M.TK_NAME);let E=i.t.seminfo.ts;return ae.luaX_next(i),E},P=function(i,E,re){i.f=i.t=Z,i.k=E,i.u.info=re},Ee=function(i,E,re){P(E,ur.VK,Oe(i.fs,re))},Ie=function(i,E){Ee(i,E,c(i))},Ze=function(i,E){let re=i.fs,Te=i.dyd,te=(function(J,De){let We=J.fs,mr=We.f;return mr.locvars[We.nlocvars]=new dr.LocVar,mr.locvars[We.nlocvars].varname=De,We.nlocvars++})(i,E);wr(re,Te.actvar.n+1-re.firstlocal,200,g("local variables",!0)),Te.actvar.arr[Te.actvar.n]=new class{constructor(){this.idx=NaN}},Te.actvar.arr[Te.actvar.n].idx=te,Te.actvar.n++},ve=function(i,E){Ze(i,ae.luaX_newstring(i,g(E,!0)))},Se=function(i,E){let re=i.ls.dyd.actvar.arr[i.firstlocal+E].idx;return Lr(re<i.nlocvars),i.f.locvars[re]},Ae=function(i,E){let re=i.fs;for(re.nactvar=re.nactvar+E;E;E--)Se(re,re.nactvar-E).startpc=re.pc},Xe=function(i,E,re){let Te=i.f;return wr(i,i.nups+1,ge.MAXUPVAL,g("upvalues",!0)),Te.upvalues[i.nups]={instack:re.k===ur.VLOCAL,idx:re.u.info,name:E},i.nups++},er=function(i,E,re,Te){if(i===null)P(re,ur.VVOID,0);else{let te=(function(J,De){for(let We=J.nactvar-1;We>=0;We--)if(cr(De,Se(J,We).varname))return We;return-1})(i,E);if(te>=0)P(re,ur.VLOCAL,te),Te||(function(J,De){let We=J.bl;for(;We.nactvar>De;)We=We.previous;We.upval=1})(i,te);else{let J=(function(De,We){let mr=De.f.upvalues;for(let Pr=0;Pr<De.nups;Pr++)if(cr(mr[Pr].name,We))return Pr;return-1})(i,E);if(J<0){if(er(i.prev,E,re,0),re.k===ur.VVOID)return;J=Xe(i,E,re)}P(re,ur.VUPVAL,J)}}},t=function(i,E){let re=c(i),Te=i.fs;if(er(Te,re,E,1),E.k===ur.VVOID){let te=new kr;er(Te,i.envn,E,1),Lr(E.k!==ur.VVOID),Ee(i,te,re),ar(Te,E,te)}},v=function(i,E,re,Te){let te=i.fs,J=E-re;if(Pe(Te.k))++J<0&&(J=0),Cr(te,Te,J),J>1&&sr(te,J-1);else if(Te.k!==ur.VVOID&&tr(te,Te),J>0){let De=te.freereg;sr(te,J),p(te,De,J)}re>E&&(i.fs.freereg-=re-E)},O=function(i){let E=i.L;++E.nCcalls,wr(i.fs,E.nCcalls,ie,g("JS levels",!0))},G=function(i){return i.L.nCcalls--},C=function(i,E,re){let Te=i.fs,te=i.dyd.gt,J=te.arr[E];if(Lr(cr(J.name,re.name)),J.nactvar<re.nactvar){let De=Se(Te,J.nactvar).varname,We=dr.luaO_pushfstring(i.L,g("<goto %s> at line %d jumps into the scope of local '%s'"),J.name.getstr(),J.line,De.getstr());Er(i,We)}Le(Te,J.pc,re.pc);for(let De=E;De<te.n-1;De++)te.arr[De]=te.arr[De+1];te.n--},D=function(i,E){let re=i.fs.bl,Te=i.dyd,te=Te.gt.arr[E];for(let J=re.firstlabel;J<Te.label.n;J++){let De=Te.label.arr[J];if(cr(De.name,te.name))return te.nactvar>De.nactvar&&(re.upval||Te.label.n>re.firstlabel)&&F(i.fs,te.pc,De.nactvar),C(i,E,De),!0}return!1},$e=function(i,E,re,Te,te){let J=E.n;return E.arr[J]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},E.arr[J].name=re,E.arr[J].line=Te,E.arr[J].nactvar=i.fs.nactvar,E.arr[J].pc=te,E.n=J+1,J},fr=function(i,E){let re=i.dyd.gt,Te=i.fs.bl.firstgoto;for(;Te<re.n;)cr(re.arr[Te].name,E.name)?C(i,Te,E):Te++},gr=function(i,E,re){E.isloop=re,E.nactvar=i.nactvar,E.firstlabel=i.ls.dyd.label.n,E.firstgoto=i.ls.dyd.gt.n,E.upval=0,E.previous=i.bl,i.bl=E,Lr(i.freereg===i.nactvar)},Nr=function(i,E,re){E.prev=i.fs,E.ls=i,i.fs=E,E.pc=0,E.lasttarget=0,E.jpc=Z,E.freereg=0,E.nk=0,E.np=0,E.nups=0,E.nlocvars=0,E.nactvar=0,E.firstlocal=i.dyd.actvar.n,E.bl=null;let Te=E.f;Te.source=i.source,Te.maxstacksize=2,gr(E,re,!1)},o=function(i){let E=i.bl,re=i.ls;if(E.previous&&E.upval){let Te=S(i);F(i,Te,E.nactvar),A(i,Te)}E.isloop&&(function(Te){let te=Ue(Te.L,"break"),J=$e(Te,Te.dyd.label,te,0,Te.fs.pc);fr(Te,Te.dyd.label.arr[J])})(re),i.bl=E.previous,(function(Te,te){for(Te.ls.dyd.actvar.n-=Te.nactvar-te;Te.nactvar>te;)Se(Te,--Te.nactvar).endpc=Te.pc})(i,E.nactvar),Lr(E.nactvar===i.nactvar),i.freereg=i.nactvar,re.dyd.label.n=E.firstlabel,E.previous?(function(Te,te){let J=te.firstgoto,De=Te.ls.dyd.gt;for(;J<De.n;){let We=De.arr[J];We.nactvar>te.nactvar&&(te.upval&&F(Te,We.pc,te.nactvar),We.nactvar=te.nactvar),D(Te.ls,J)||J++}})(i,E):E.firstgoto<re.dyd.gt.n&&(function(Te,te){let J=ae.isreserved(te.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d";J=dr.luaO_pushfstring(Te.L,g(J),te.name.getstr(),te.line),Er(Te,J)})(re,re.dyd.gt.arr[E.firstgoto])},T=function(i){let E=i.fs;or(E,0,0),o(E),Lr(E.bl===null),i.fs=E.prev},Q=function(i,E){switch(i.t.token){case M.TK_ELSE:case M.TK_ELSEIF:case M.TK_END:case M.TK_EOS:return!0;case M.TK_UNTIL:return E;default:return!1}},qe=function(i){for(;!Q(i,1);){if(i.t.token===M.TK_RETURN)return void an(i);an(i)}},Or=function(i,E){let re=i.fs,Te=new kr;rr(re,E),ae.luaX_next(i),Ie(i,Te),ar(re,E,Te)},yr=function(i,E){ae.luaX_next(i),Yr(i,E),R(i.fs,E),Dr(i,93)},Kr=function(i,E){let re=i.fs,Te=i.fs.freereg,te=new kr,J=new kr;i.t.token===M.TK_NAME?(wr(re,E.nh,Ce,g("items in a constructor",!0)),Ie(i,te)):yr(i,te),E.nh++,Dr(i,61);let De=nr(re,te);Yr(i,J),Fe(re,l,E.t.u.info,De,nr(re,J)),re.freereg=Te},Jr=function(i,E){E.v.k!==ur.VVOID&&(tr(i,E.v),E.v.k=ur.VVOID,E.tostore===m&&(Ur(i,E.t.u.info,E.na,E.tostore),E.tostore=0))},qr=function(i,E){Yr(i,E.v),wr(i.fs,E.na,Ce,g("items in a constructor",!0)),E.na++,E.tostore++},Zr=function(i,E){switch(i.t.token){case M.TK_NAME:ae.luaX_lookahead(i)!==61?qr(i,E):Kr(i,E);break;case 91:Kr(i,E);break;default:qr(i,E)}},Xr=function(i,E){let re=i.fs,Te=i.linenumber,te=Fe(re,n,0,0,0),J=new class{constructor(){this.v=new kr,this.t=new kr,this.nh=NaN,this.na=NaN,this.tostore=NaN}};J.na=J.nh=J.tostore=0,J.t=E,P(E,ur.VRELOCABLE,te),P(J.v,ur.VVOID,0),tr(i.fs,E),Dr(i,123);do{if(Lr(J.v.k===ur.VVOID||J.tostore>0),i.t.token===125)break;Jr(re,J),Zr(i,J)}while(Ir(i,44)||Ir(i,59));Gr(i,125,123,Te),(function(De,We){We.tostore!==0&&(Pe(We.v.k)?(Sr(De,We.v),Ur(De,We.t.u.info,We.na,b),We.na--):(We.v.k!==ur.VVOID&&tr(De,We.v),Ur(De,We.t.u.info,We.na,We.tostore)))})(re,J),xe(re.f.code[te],dr.luaO_int2fb(J.na)),Be(re.f.code[te],dr.luaO_int2fb(J.nh))},Br=function(i,E,re,Te){let te=new Vr,J=new _r;te.f=(function(De){let We=De.L,mr=new ne(We),Pr=De.fs;return Pr.f.p[Pr.np++]=mr,mr})(i),te.f.linedefined=Te,Nr(i,te,J),Dr(i,40),re&&(ve(i,"self"),Ae(i,1)),(function(De){let We=De.fs,mr=We.f,Pr=0;if(mr.is_vararg=!1,De.t.token!==41)do switch(De.t.token){case M.TK_NAME:Ze(De,c(De)),Pr++;break;case M.TK_DOTS:ae.luaX_next(De),mr.is_vararg=!0;break;default:ae.luaX_syntaxerror(De,g("<name> or '...' expected",!0))}while(!mr.is_vararg&&Ir(De,44));Ae(De,Pr),mr.numparams=We.nactvar,sr(We,We.nactvar)})(i),Dr(i,41),qe(i),te.f.lastlinedefined=i.linenumber,Gr(i,M.TK_END,M.TK_FUNCTION,Te),(function(De,We){let mr=De.fs.prev;P(We,ur.VRELOCABLE,d(mr,Mr,0,mr.np-1)),tr(mr,We)})(i,E),T(i)},zr=function(i,E){let re=1;for(Yr(i,E);Ir(i,44);)tr(i.fs,E),Yr(i,E),re++;return re},un=function(i,E,re){let Te,te=i.fs,J=new kr;switch(i.t.token){case 40:ae.luaX_next(i),i.t.token===41?J.k=ur.VVOID:(zr(i,J),Sr(te,J)),Gr(i,41,40,re);break;case 123:Xr(i,J);break;case M.TK_STRING:Ee(i,J,i.t.seminfo.ts),ae.luaX_next(i);break;default:ae.luaX_syntaxerror(i,g("function arguments expected",!0))}Lr(E.k===ur.VNONRELOC);let De=E.u.info;Pe(J.k)?Te=b:(J.k!==ur.VVOID&&tr(te,J),Te=te.freereg-(De+1)),P(E,ur.VCALL,Fe(te,xr,De,Te+1,2)),N(te,re),te.freereg=De+1},en=function(i,E){let re=i.fs,Te=i.linenumber;for(!(function(te,J){switch(te.t.token){case 40:{let De=te.linenumber;return ae.luaX_next(te),Yr(te,J),Gr(te,41,40,De),void ce(te.fs,J)}case M.TK_NAME:return void t(te,J);default:ae.luaX_syntaxerror(te,g("unexpected symbol",!0))}})(i,E);;)switch(i.t.token){case 46:Or(i,E);break;case 91:{let te=new kr;rr(re,E),yr(i,te),ar(re,E,te);break}case 58:{let te=new kr;ae.luaX_next(i),Ie(i,te),ir(re,E,te),un(i,E,Te);break}case 40:case M.TK_STRING:case 123:tr(re,E),un(i,E,Te);break;default:return}},ln=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],rn=function(i,E,re){O(i);let Te=(function(J){switch(J){case M.TK_NOT:return je;case 45:return Ke;case 126:return ee;case 35:return Ne;default:return I}})(i.t.token);if(Te!==I){let J=i.linenumber;ae.luaX_next(i),rn(i,E,12),le(i.fs,Te,E,J)}else(function(J,De){switch(J.t.token){case M.TK_FLT:P(De,ur.VKFLT,0),De.u.nval=J.t.seminfo.r;break;case M.TK_INT:P(De,ur.VKINT,0),De.u.ival=J.t.seminfo.i;break;case M.TK_STRING:Ee(J,De,J.t.seminfo.ts);break;case M.TK_NIL:P(De,ur.VNIL,0);break;case M.TK_TRUE:P(De,ur.VTRUE,0);break;case M.TK_FALSE:P(De,ur.VFALSE,0);break;case M.TK_DOTS:{let We=J.fs;jr(J,We.f.is_vararg,g("cannot use '...' outside a vararg function",!0)),P(De,ur.VVARARG,Fe(We,s,0,1,0));break}case 123:return void Xr(J,De);case M.TK_FUNCTION:return ae.luaX_next(J),void Br(J,De,0,J.linenumber);default:return void en(J,De)}ae.luaX_next(J)})(i,E);let te=(function(J){switch(J){case 43:return V;case 45:return X;case 42:return ye;case 37:return Ve;case 94:return x;case 47:return B;case M.TK_IDIV:return j;case 38:return _e;case 124:return He;case 126:return H;case M.TK_SHL:return w;case M.TK_SHR:return Y;case M.TK_CONCAT:return fe;case M.TK_NE:return Ge;case M.TK_EQ:return we;case 60:return $;case M.TK_LE:return se;case 62:return he;case M.TK_GE:return pe;case M.TK_AND:return K;case M.TK_OR:return Ye;default:return Me}})(i.t.token);for(;te!==Me&&ln[te].left>re;){let J=new kr,De=i.linenumber;ae.luaX_next(i),Je(i.fs,te,E);let We=rn(i,J,ln[te].right);z(i.fs,te,E,J,De),te=We}return G(i),te},Yr=function(i,E){rn(i,E,0)},$r=function(i){let E=i.fs,re=new _r;gr(E,re,0),qe(i),o(E)};class sn{constructor(){this.prev=null,this.v=new kr}}const on=function(i,E,re){let Te=new kr;if(jr(i,(function(te){return ur.VLOCAL<=te&&te<=ur.VINDEXED})(E.v.k),g("syntax error",!0)),Ir(i,44)){let te=new sn;te.prev=E,en(i,te.v),te.v.k!==ur.VINDEXED&&(function(J,De,We){let mr=J.fs,Pr=mr.freereg,Hr=!1;for(;De;De=De.prev)De.v.k===ur.VINDEXED&&(De.v.u.ind.vt===We.k&&De.v.u.ind.t===We.u.info&&(Hr=!0,De.v.u.ind.vt=ur.VLOCAL,De.v.u.ind.t=Pr),We.k===ur.VLOCAL&&De.v.u.ind.idx===We.u.info&&(Hr=!0,De.v.u.ind.idx=Pr));if(Hr){let Wr=We.k===ur.VLOCAL?r:br;Fe(mr,Wr,Pr,We.u.info,0),sr(mr,1)}})(i,E,te.v),wr(i.fs,re+i.L.nCcalls,ie,g("JS levels",!0)),on(i,te,re+1)}else{Dr(i,61);let te=zr(i,Te);if(te===re)return Rr(i.fs,Te),void _(i.fs,E.v,Te);v(i,re,te,Te)}P(Te,ur.VNONRELOC,i.fs.freereg-1),_(i.fs,E.v,Te)},cn=function(i){let E=new kr;return Yr(i,E),E.k===ur.VNIL&&(E.k=ur.VFALSE),Re(i.fs,E),E.f},_n=function(i,E){let re,Te=i.linenumber;Ir(i,M.TK_GOTO)?re=c(i):(ae.luaX_next(i),re=Ue(i.L,"break"));let te=$e(i,i.dyd.gt,re,Te,E);D(i,te)},dn=function(i,E,re){let Te,te=i.fs,J=i.dyd.label;(function(De,We,mr){for(let Pr=De.bl.firstlabel;Pr<We.n;Pr++)if(cr(mr,We.arr[Pr].name)){let Hr=dr.luaO_pushfstring(De.ls.L,g("label '%s' already defined on line %d",!0),mr.getstr(),We.arr[Pr].line);Er(De.ls,Hr)}})(te,J,E),Dr(i,M.TK_DBCOLON),Te=$e(i,J,E,re,de(te)),(function(De){for(;De.t.token===59||De.t.token===M.TK_DBCOLON;)an(De)})(i),Q(i,0)&&(J.arr[Te].nactvar=te.bl.nactvar),fr(i,J.arr[Te])},nn=function(i){let E=new kr;return Yr(i,E),tr(i.fs,E),Lr(E.k===ur.VNONRELOC),E.u.info},fn=function(i,E,re,Te,te){let J,De=new _r,We=i.fs;Ae(i,3),Dr(i,M.TK_DO);let mr=te?k(We,lr,E,Z):S(We);gr(We,De,0),Ae(i,Te),sr(We,Te),$r(i),o(We),A(We,mr),te?J=k(We,Qe,E,Z):(Fe(We,u,E,0,Te),N(We,re),J=k(We,f,E+2,Z)),Le(We,J,mr+1),N(We,re)},An=function(i,E){let re=i.fs,Te=new _r;gr(re,Te,1),ae.luaX_next(i);let te=c(i);switch(i.t.token){case 61:(function(J,De,We){let mr=J.fs,Pr=mr.freereg;ve(J,"(for index)"),ve(J,"(for limit)"),ve(J,"(for step)"),Ze(J,De),Dr(J,61),nn(J),Dr(J,44),nn(J),Ir(J,44)?nn(J):(U(mr,mr.freereg,ke(mr,1)),sr(mr,1)),fn(J,Pr,We,1,1)})(i,te,E);break;case 44:case M.TK_IN:(function(J,De){let We=J.fs,mr=new kr,Pr=4,Hr=We.freereg;for(ve(J,"(for generator)"),ve(J,"(for state)"),ve(J,"(for control)"),Ze(J,De);Ir(J,44);)Ze(J,c(J)),Pr++;Dr(J,M.TK_IN);let Wr=J.linenumber;v(J,3,zr(J,mr),mr),W(We,3),fn(J,Hr,Wr,Pr-3,0)})(i,te);break;default:ae.luaX_syntaxerror(i,g("'=' or 'in' expected",!0))}Gr(i,M.TK_END,M.TK_FOR,E),o(re)},pn=function(i,E){let re,Te=new _r,te=i.fs,J=new kr;if(ae.luaX_next(i),Yr(i,J),Dr(i,M.TK_THEN),i.t.token===M.TK_GOTO||i.t.token===M.TK_BREAK){for(q(i.fs,J),gr(te,Te,!1),_n(i,J.t);Ir(i,59););if(Q(i,0))return o(te),E;re=S(te)}else Re(i.fs,J),gr(te,Te,!1),re=J.f;return qe(i),o(te),i.t.token!==M.TK_ELSE&&i.t.token!==M.TK_ELSEIF||(E=oe(te,E,S(te))),A(te,re),E},gn=function(i,E){let re=new kr,Te=new kr;ae.luaX_next(i);let te=(function(J,De){let We=0;for(t(J,De);J.t.token===46;)Or(J,De);return J.t.token===58&&(We=1,Or(J,De)),We})(i,re);Br(i,Te,te,E),_(i.fs,re,Te),N(i.fs,E)},an=function(i){let E=i.linenumber;switch(O(i),i.t.token){case 59:ae.luaX_next(i);break;case M.TK_IF:(function(re,Te){let te=re.fs,J=Z;for(J=pn(re,J);re.t.token===M.TK_ELSEIF;)J=pn(re,J);Ir(re,M.TK_ELSE)&&$r(re),Gr(re,M.TK_END,M.TK_IF,Te),A(te,J)})(i,E);break;case M.TK_WHILE:(function(re,Te){let te=re.fs,J=new _r;ae.luaX_next(re);let De=de(te),We=cn(re);gr(te,J,1),Dr(re,M.TK_DO),$r(re),ue(te,De),Gr(re,M.TK_END,M.TK_WHILE,Te),o(te),A(te,We)})(i,E);break;case M.TK_DO:ae.luaX_next(i),$r(i),Gr(i,M.TK_END,M.TK_DO,E);break;case M.TK_FOR:An(i,E);break;case M.TK_REPEAT:(function(re,Te){let te=re.fs,J=de(te),De=new _r,We=new _r;gr(te,De,1),gr(te,We,0),ae.luaX_next(re),qe(re),Gr(re,M.TK_UNTIL,M.TK_REPEAT,Te);let mr=cn(re);We.upval&&F(te,mr,We.nactvar),o(te),Le(te,mr,J),o(te)})(i,E);break;case M.TK_FUNCTION:gn(i,E);break;case M.TK_LOCAL:ae.luaX_next(i),Ir(i,M.TK_FUNCTION)?(function(re){let Te=new kr,te=re.fs;Ze(re,c(re)),Ae(re,1),Br(re,Te,0,re.linenumber),Se(te,Te.u.info).startpc=te.pc})(i):(function(re){let Te,te=0,J=new kr;do Ze(re,c(re)),te++;while(Ir(re,44));Ir(re,61)?Te=zr(re,J):(J.k=ur.VVOID,Te=0),v(re,te,Te,J),Ae(re,te)})(i);break;case M.TK_DBCOLON:ae.luaX_next(i),dn(i,c(i),E);break;case M.TK_RETURN:ae.luaX_next(i),(function(re){let Te,te,J=re.fs,De=new kr;Q(re,1)||re.t.token===59?Te=te=0:(te=zr(re,De),Pe(De.k)?(Sr(J,De),De.k===ur.VCALL&&te===1&&(Ar(me(J,De),a),Lr(me(J,De).A===J.nactvar)),Te=J.nactvar,te=b):te===1?Te=ze(J,De):(tr(J,De),Te=J.nactvar,Lr(te===J.freereg-Te))),or(J,Te,te),Ir(re,59)})(i);break;case M.TK_BREAK:case M.TK_GOTO:_n(i,S(i.fs));break;default:(function(re){let Te=re.fs,te=new sn;en(re,te.v),re.t.token===61||re.t.token===44?(te.prev=null,on(re,te,1)):(jr(re,te.v.k===ur.VCALL,g("syntax error",!0)),Be(me(Te,te.v),1))})(i)}Lr(i.fs.f.maxstacksize>=i.fs.freereg&&i.fs.freereg>=i.fs.nactvar),i.fs.freereg=i.fs.nactvar,G(i)};e.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new pr,this.label=new pr}},e.exports.expkind=ur,e.exports.expdesc=kr,e.exports.luaY_parser=function(i,E,re,Te,te,J){let De=new ae.LexState,We=new Vr,mr=ge.luaF_newLclosure(i,1);return be.luaD_inctop(i),i.stack[i.top-1].setclLvalue(mr),De.h=L.luaH_new(i),be.luaD_inctop(i),i.stack[i.top-1].sethvalue(De.h),We.f=mr.p=new ne(i),We.f.source=y(i,te),De.buff=re,De.dyd=Te,Te.actvar.n=Te.gt.n=Te.label.n=0,ae.luaX_setinput(i,De,E,We.f.source,J),(function(Pr,Hr){let Wr=new _r,Ln=new kr;Nr(Pr,Hr,Wr),Hr.f.is_vararg=!0,P(Ln,ur.VLOCAL,0),Xe(Hr,Pr.envn,Ln),ae.luaX_next(Pr),qe(Pr),Fr(Pr,M.TK_EOS),T(Pr)})(De,We),Lr(!We.prev&&We.nups===1&&!De.fs),Lr(Te.actvar.n===0&&Te.gt.n===0&&Te.label.n===0),delete i.stack[--i.top],mr},e.exports.vkisinreg=function(i){return i===ur.VNONRELOC||i===ur.VLOCAL}},function(e,hr,h){const{LUA_MULTRET:b,LUA_OK:g,LUA_TFUNCTION:V,LUA_TNIL:K,LUA_TNONE:_e,LUA_TNUMBER:He,LUA_TSTRING:H,LUA_TTABLE:fe,LUA_VERSION:B,LUA_YIELD:we,lua_call:pe,lua_callk:he,lua_concat:j,lua_error:se,lua_getglobal:$,lua_geti:Ve,lua_getmetatable:ye,lua_gettop:Ge,lua_insert:Me,lua_isnil:Ye,lua_isnone:x,lua_isstring:w,lua_load:Y,lua_next:X,lua_pcallk:ee,lua_pop:Ne,lua_pushboolean:Ke,lua_pushcfunction:je,lua_pushglobaltable:I,lua_pushinteger:Z,lua_pushliteral:me,lua_pushnil:W,lua_pushstring:Fe,lua_pushvalue:d,lua_rawequal:k,lua_rawget:U,lua_rawlen:oe,lua_rawset:ce,lua_remove:nr,lua_replace:ze,lua_rotate:rr,lua_setfield:tr,lua_setmetatable:R,lua_settop:N,lua_setupvalue:de,lua_stringtonumber:q,lua_toboolean:Re,lua_tolstring:ar,lua_tostring:Je,lua_type:ke,lua_typename:S}=h(2),{luaL_argcheck:ue,luaL_checkany:p,luaL_checkinteger:F,luaL_checkoption:Le,luaL_checkstack:A,luaL_checktype:z,luaL_error:le,luaL_getmetafield:sr,luaL_loadbufferx:or,luaL_loadfile:ir,luaL_loadfilex:Ur,luaL_optinteger:Sr,luaL_optstring:Rr,luaL_setfuncs:Cr,luaL_tolstring:_,luaL_where:Oe}=h(7),{to_jsstring:be,to_luastring:ge}=h(5);let ae,ie;if(typeof TextDecoder=="function"){let n="",l=new TextDecoder("utf-8");ae=function(u){n+=l.decode(u,{stream:!0})};let a=new Uint8Array(0);ie=function(){n+=l.decode(a),console.log(n),n=""}}else{let n=[];ae=function(l){try{l=be(l)}catch{let u=new Uint8Array(l.length);u.set(l),l=u}n.push(l)},ie=function(){console.log.apply(console.log,n),n=[]}}const Ce=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map(n=>ge(n)),Lr=function(n){return z(n,1,fe),N(n,2),X(n,1)?2:(W(n),1)},dr=function(n){let l=F(n,2)+1;return Z(n,l),Ve(n,1,l)===K?1:2},xr=function(n){let l=Sr(n,2,1);return N(n,1),ke(n,1)===H&&l>0&&(Oe(n,l),d(n,1),j(n,2)),se(n)},Mr=function(n,l,a){return l!==g&&l!==we?(Ke(n,0),d(n,-2),2):Ge(n)-a},Qe=function(n,l,a){return l===g?(a!==0&&(d(n,a),de(n,-2,1)||Ne(n,1)),1):(W(n),Me(n,-2),2)},lr=function(n,l){return A(n,2,"too many nested functions"),d(n,1),pe(n,0,1),Ye(n,-1)?(Ne(n,1),null):(w(n,-1)||le(n,ge("reader function must return a string")),ze(n,5),Je(n,5))},br=function(n,l,a){return Ge(n)-1},r={assert:function(n){return Re(n,1)?Ge(n):(p(n,1),nr(n,1),me(n,"assertion failed!"),N(n,1),xr(n))},collectgarbage:function(n){Le(n,1,"collect",Ce),Sr(n,2,0),le(n,ge("lua_gc not implemented"))},dofile:function(n){let l=Rr(n,1,null);return N(n,1),ir(n,l)!==g?se(n):(he(n,0,b,0,br),br(n))},error:xr,getmetatable:function(n){return p(n,1),ye(n,1)?(sr(n,1,ge("__metatable",!0)),1):(W(n),1)},ipairs:function(n){return p(n,1),je(n,dr),d(n,1),Z(n,0),3},load:function(n){let l,a=Je(n,1),u=Rr(n,3,"bt"),f=x(n,4)?0:4;if(a!==null){let s=Rr(n,2,a);l=or(n,a,a.length,s,u)}else{let s=Rr(n,2,"=(load)");z(n,1,V),N(n,5),l=Y(n,lr,null,s,u)}return Qe(n,l,f)},loadfile:function(n){let l=Rr(n,1,null),a=Rr(n,2,null),u=x(n,3)?0:3,f=Ur(n,l,a);return Qe(n,f,u)},next:Lr,pairs:function(n){return(function(l,a,u,f){return p(l,1),sr(l,1,a)===K?(je(l,f),d(l,1),W(l)):(d(l,1),pe(l,1,3)),3})(n,ge("__pairs",!0),0,Lr)},pcall:function(n){p(n,1),Ke(n,1),Me(n,1);let l=ee(n,Ge(n)-2,b,0,0,Mr);return Mr(n,l,0)},print:function(n){let l=Ge(n);$(n,ge("tostring",!0));for(let a=1;a<=l;a++){d(n,-1),d(n,a),pe(n,1,1);let u=ar(n,-1);if(u===null)return le(n,ge("'tostring' must return a string to 'print'"));a>1&&ae(ge("	")),ae(u),Ne(n,1)}return ie(),0},rawequal:function(n){return p(n,1),p(n,2),Ke(n,k(n,1,2)),1},rawget:function(n){return z(n,1,fe),p(n,2),N(n,2),U(n,1),1},rawlen:function(n){let l=ke(n,1);return ue(n,l===fe||l===H,1,"table or string expected"),Z(n,oe(n,1)),1},rawset:function(n){return z(n,1,fe),p(n,2),p(n,3),N(n,3),ce(n,1),1},select:function(n){let l=Ge(n);if(ke(n,1)===H&&Je(n,1)[0]===35)return Z(n,l-1),1;{let a=F(n,1);return a<0?a=l+a:a>l&&(a=l),ue(n,1<=a,1,"index out of range"),l-a}},setmetatable:function(n){let l=ke(n,2);return z(n,1,fe),ue(n,l===K||l===fe,2,"nil or table expected"),sr(n,1,ge("__metatable",!0))!==K?le(n,ge("cannot change a protected metatable")):(N(n,2),R(n,1),1)},tonumber:function(n){if(ke(n,2)<=0){if(p(n,1),ke(n,1)===He)return N(n,1),1;{let l=Je(n,1);if(l!==null&&q(n,l)===l.length+1)return 1}}else{let l=F(n,2);z(n,1,H);let a=Je(n,1);ue(n,2<=l&&l<=36,2,"base out of range");let u=(function(f,s){try{f=be(f)}catch{return null}let m=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(f);if(!m)return null;let xe=parseInt(m[1]+m[2],s);return isNaN(xe)?null:0|xe})(a,l);if(u!==null)return Z(n,u),1}return W(n),1},tostring:function(n){return p(n,1),_(n,1),1},type:function(n){let l=ke(n,1);return ue(n,l!==_e,1,"value expected"),Fe(n,S(n,l)),1},xpcall:function(n){let l=Ge(n);z(n,2,V),Ke(n,1),d(n,1),rr(n,3,2);let a=ee(n,l-2,b,2,2,Mr);return Mr(n,a,2)}};e.exports.luaopen_base=function(n){return I(n),Cr(n,r,0),d(n,-1),tr(n,-2,ge("_G")),me(n,B),tr(n,-2,ge("_VERSION")),1}},function(e,hr,h){const{LUA_OK:b,LUA_TFUNCTION:g,LUA_TSTRING:V,LUA_YIELD:K,lua_Debug:_e,lua_checkstack:He,lua_concat:H,lua_error:fe,lua_getstack:B,lua_gettop:we,lua_insert:pe,lua_isyieldable:he,lua_newthread:j,lua_pop:se,lua_pushboolean:$,lua_pushcclosure:Ve,lua_pushliteral:ye,lua_pushthread:Ge,lua_pushvalue:Me,lua_resume:Ye,lua_status:x,lua_tothread:w,lua_type:Y,lua_upvalueindex:X,lua_xmove:ee,lua_yield:Ne}=h(2),{luaL_argcheck:Ke,luaL_checktype:je,luaL_newlib:I,luaL_where:Z}=h(7),me=function(U){let oe=w(U,1);return Ke(U,oe,1,"thread expected"),oe},W=function(U,oe,ce){if(!He(oe,ce))return ye(U,"too many arguments to resume"),-1;if(x(oe)===b&&we(oe)===0)return ye(U,"cannot resume dead coroutine"),-1;ee(U,oe,ce);let nr=Ye(oe,U,ce);if(nr===b||nr===K){let ze=we(oe);return He(U,ze+1)?(ee(oe,U,ze),ze):(se(oe,ze),ye(U,"too many results to resume"),-1)}return ee(oe,U,1),-1},Fe=function(U){let oe=w(U,X(1)),ce=W(U,oe,we(U));return ce<0?(Y(U,-1)===V&&(Z(U,1),pe(U,-2),H(U,2)),fe(U)):ce},d=function(U){je(U,1,g);let oe=j(U);return Me(U,1),ee(U,oe,1),1},k={create:d,isyieldable:function(U){return $(U,he(U)),1},resume:function(U){let oe=me(U),ce=W(U,oe,we(U)-1);return ce<0?($(U,0),pe(U,-2),2):($(U,1),pe(U,-(ce+1)),ce+1)},running:function(U){return $(U,Ge(U)),2},status:function(U){let oe=me(U);if(U===oe)ye(U,"running");else switch(x(oe)){case K:ye(U,"suspended");break;case b:{let ce=new _e;B(oe,0,ce)>0?ye(U,"normal"):we(oe)===0?ye(U,"dead"):ye(U,"suspended");break}default:ye(U,"dead")}return 1},wrap:function(U){return d(U),Ve(U,Fe,1),1},yield:function(U){return Ne(U,we(U))}};e.exports.luaopen_coroutine=function(U){return I(U,k),1}},function(e,hr,h){const{LUA_MAXINTEGER:b}=h(3),{LUA_OPEQ:g,LUA_OPLT:V,LUA_TFUNCTION:K,LUA_TNIL:_e,LUA_TTABLE:He,lua_call:H,lua_checkstack:fe,lua_compare:B,lua_createtable:we,lua_geti:pe,lua_getmetatable:he,lua_gettop:j,lua_insert:se,lua_isnil:$,lua_isnoneornil:Ve,lua_isstring:ye,lua_pop:Ge,lua_pushinteger:Me,lua_pushnil:Ye,lua_pushstring:x,lua_pushvalue:w,lua_rawget:Y,lua_setfield:X,lua_seti:ee,lua_settop:Ne,lua_toboolean:Ke,lua_type:je}=h(2),{luaL_Buffer:I,luaL_addlstring:Z,luaL_addvalue:me,luaL_argcheck:W,luaL_buffinit:Fe,luaL_checkinteger:d,luaL_checktype:k,luaL_error:U,luaL_len:oe,luaL_newlib:ce,luaL_opt:nr,luaL_optinteger:ze,luaL_optlstring:rr,luaL_pushresult:tr,luaL_typename:R}=h(7),N=h(17),{to_luastring:de}=h(5),q=function(A,z,le){return x(A,z),Y(A,-le)!==_e},Re=function(A,z,le){if(je(A,z)!==He){let sr=1;!he(A,z)||1&le&&!q(A,de("__index",!0),++sr)||2&le&&!q(A,de("__newindex",!0),++sr)||4&le&&!q(A,de("__len",!0),++sr)?k(A,z,He):Ge(A,sr)}},ar=function(A,z,le){return Re(A,z,4|le),oe(A,z)},Je=function(A,z,le){pe(A,1,le),ye(A,-1)||U(A,de("invalid value (%s) at index %d in table for 'concat'"),R(A,-1),le),me(z)},ke=function(A,z,le){ee(A,1,z),ee(A,1,le)},S=function(A,z,le){if($(A,2))return B(A,z,le,V);{w(A,2),w(A,z-1),w(A,le-2),H(A,2,1);let sr=Ke(A,-1);return Ge(A,1),sr}},ue=function(A,z,le){let sr=z,or=le-1;for(;;){for(;pe(A,1,++sr),S(A,-1,-2);)sr==le-1&&U(A,de("invalid order function for sorting")),Ge(A,1);for(;pe(A,1,--or),S(A,-3,-1);)or<sr&&U(A,de("invalid order function for sorting")),Ge(A,1);if(or<sr)return Ge(A,1),ke(A,le-1,sr),sr;ke(A,sr,or)}},p=function(A,z,le){let sr=Math.floor((z-A)/4),or=le%(2*sr)+(A+sr);return N.lua_assert(A+sr<=or&&or<=z-sr),or},F=function(A,z,le,sr){for(;z<le;){if(pe(A,1,z),pe(A,1,le),S(A,-1,-2)?ke(A,z,le):Ge(A,2),le-z==1)return;let or,ir;if(or=le-z<100||sr===0?Math.floor((z+le)/2):p(z,le,sr),pe(A,1,or),pe(A,1,z),S(A,-2,-1)?ke(A,or,z):(Ge(A,1),pe(A,1,le),S(A,-1,-2)?ke(A,or,le):Ge(A,2)),le-z==2)return;pe(A,1,or),w(A,-1),pe(A,1,le-1),ke(A,or,le-1),(or=ue(A,z,le))-z<le-or?(F(A,z,or-1,sr),ir=or-z,z=or+1):(F(A,or+1,le,sr),ir=le-or,le=or-1),(le-z)/128>ir&&(sr=Math.floor(4294967296*Math.random()))}},Le={concat:function(A){let z=ar(A,1,1),le=rr(A,2,""),sr=le.length,or=ze(A,3,1);z=ze(A,4,z);let ir=new I;for(Fe(A,ir);or<z;or++)Je(A,ir,or),Z(ir,le,sr);return or===z&&Je(A,ir,or),tr(ir),1},insert:function(A){let z,le=ar(A,1,3)+1;switch(j(A)){case 2:z=le;break;case 3:z=d(A,2),W(A,1<=z&&z<=le,2,"position out of bounds");for(let sr=le;sr>z;sr--)pe(A,1,sr-1),ee(A,1,sr);break;default:return U(A,"wrong number of arguments to 'insert'")}return ee(A,1,z),0},move:function(A){let z=d(A,2),le=d(A,3),sr=d(A,4),or=Ve(A,5)?1:5;if(Re(A,1,1),Re(A,or,2),le>=z){W(A,z>0||le<b+z,3,"too many elements to move");let ir=le-z+1;if(W(A,sr<=b-ir+1,4,"destination wrap around"),sr>le||sr<=z||or!==1&&B(A,1,or,g)!==1)for(let Ur=0;Ur<ir;Ur++)pe(A,1,z+Ur),ee(A,or,sr+Ur);else for(let Ur=ir-1;Ur>=0;Ur--)pe(A,1,z+Ur),ee(A,or,sr+Ur)}return w(A,or),1},pack:function(A){let z=j(A);we(A,z,1),se(A,1);for(let le=z;le>=1;le--)ee(A,1,le);return Me(A,z),X(A,1,de("n")),1},remove:function(A){let z=ar(A,1,3),le=ze(A,2,z);for(le!==z&&W(A,1<=le&&le<=z+1,1,"position out of bounds"),pe(A,1,le);le<z;le++)pe(A,1,le+1),ee(A,1,le);return Ye(A),ee(A,1,le),1},sort:function(A){let z=ar(A,1,3);return z>1&&(W(A,z<b,1,"array too big"),Ve(A,2)||k(A,2,K),Ne(A,2),F(A,1,z,0)),0},unpack:function(A){let z=ze(A,2,1),le=nr(A,d,3,oe(A,1));if(z>le)return 0;let sr=le-z;if(sr>=Number.MAX_SAFE_INTEGER||!fe(A,++sr))return U(A,de("too many results to unpack"));for(;z<le;z++)pe(A,1,z);return pe(A,1,le),sr}};e.exports.luaopen_table=function(A){return ce(A,Le),1}},function(e,hr,h){const{LUA_TNIL:b,LUA_TTABLE:g,lua_close:V,lua_createtable:K,lua_getfield:_e,lua_isboolean:He,lua_isnoneornil:H,lua_pop:fe,lua_pushboolean:B,lua_pushfstring:we,lua_pushinteger:pe,lua_pushliteral:he,lua_pushnil:j,lua_pushnumber:se,lua_pushstring:$,lua_setfield:Ve,lua_settop:ye,lua_toboolean:Ge,lua_tointegerx:Me}=h(2),{luaL_Buffer:Ye,luaL_addchar:x,luaL_addstring:w,luaL_argerror:Y,luaL_buffinit:X,luaL_checkinteger:ee,luaL_checkstring:Ne,luaL_checktype:Ke,luaL_error:je,luaL_execresult:I,luaL_fileresult:Z,luaL_newlib:me,luaL_optinteger:W,luaL_optlstring:Fe,luaL_optstring:d,luaL_pushresult:k}=h(7),{luastring_eq:U,to_jsstring:oe,to_luastring:ce}=h(5),nr=ce("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),ze=function(S,ue,p){pe(S,p),Ve(S,-2,ce(ue,!0))},rr=function(S,ue,p){ze(S,"sec",p?ue.getUTCSeconds():ue.getSeconds()),ze(S,"min",p?ue.getUTCMinutes():ue.getMinutes()),ze(S,"hour",p?ue.getUTCHours():ue.getHours()),ze(S,"day",p?ue.getUTCDate():ue.getDate()),ze(S,"month",(p?ue.getUTCMonth():ue.getMonth())+1),ze(S,"year",p?ue.getUTCFullYear():ue.getFullYear()),ze(S,"wday",(p?ue.getUTCDay():ue.getDay())+1),ze(S,"yday",Math.floor((ue-new Date(ue.getFullYear(),0,0))/864e5))},tr=Number.MAX_SAFE_INTEGER/2,R=function(S,ue,p,F){let Le=_e(S,-1,ce(ue,!0)),A=Me(S,-1);if(A===!1){if(Le!==b)return je(S,ce("field '%s' is not an integer"),ue);if(p<0)return je(S,ce("field '%s' missing in date table"),ue);A=p}else{if(!(-tr<=A&&A<=tr))return je(S,ce("field '%s' is out-of-bound"),ue);A-=F}return fe(S,1),A},N={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(S=>ce(S)),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(S=>ce(S)),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map(S=>ce(S)),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(S=>ce(S)),AM:ce("AM"),PM:ce("PM"),am:ce("am"),pm:ce("pm"),formats:{c:ce("%a %b %e %H:%M:%S %Y"),D:ce("%m/%d/%y"),F:ce("%Y-%m-%d"),R:ce("%H:%M"),r:ce("%I:%M:%S %p"),T:ce("%H:%M:%S"),X:ce("%T"),x:ce("%D")}},de=function(S,ue){let p=S.getDay();ue==="monday"&&(p===0?p=6:p--);let F=(S-new Date(S.getFullYear(),0,1))/864e5;return Math.floor((F+7-p)/7)},q=function(S,ue,p){ue<10&&x(S,p),w(S,ce(String(ue)))},Re=function(S,ue,p,F){let Le=0;for(;Le<p.length;)if(p[Le]!==37)x(ue,p[Le++]);else{let A=ar(S,p,++Le);switch(p[Le]){case 37:x(ue,37);break;case 65:w(ue,N.days[F.getDay()]);break;case 66:w(ue,N.months[F.getMonth()]);break;case 67:q(ue,Math.floor(F.getFullYear()/100),48);break;case 68:Re(S,ue,N.formats.D,F);break;case 70:Re(S,ue,N.formats.F,F);break;case 72:q(ue,F.getHours(),48);break;case 73:q(ue,(F.getHours()+11)%12+1,48);break;case 77:q(ue,F.getMinutes(),48);break;case 80:w(ue,F.getHours()<12?N.am:N.pm);break;case 82:Re(S,ue,N.formats.R,F);break;case 83:q(ue,F.getSeconds(),48);break;case 84:Re(S,ue,N.formats.T,F);break;case 85:q(ue,de(F,"sunday"),48);break;case 87:q(ue,de(F,"monday"),48);break;case 88:Re(S,ue,N.formats.X,F);break;case 89:w(ue,ce(String(F.getFullYear())));break;case 90:{let z=F.toString().match(/\(([\w\s]+)\)/);z&&w(ue,ce(z[1]));break}case 97:w(ue,N.shortDays[F.getDay()]);break;case 98:case 104:w(ue,N.shortMonths[F.getMonth()]);break;case 99:Re(S,ue,N.formats.c,F);break;case 100:q(ue,F.getDate(),48);break;case 101:q(ue,F.getDate(),32);break;case 106:{let z=Math.floor((F-new Date(F.getFullYear(),0,1))/864e5);z<100&&(z<10&&x(ue,48),x(ue,48)),w(ue,ce(String(z)));break}case 107:q(ue,F.getHours(),32);break;case 108:q(ue,(F.getHours()+11)%12+1,32);break;case 109:q(ue,F.getMonth()+1,48);break;case 110:x(ue,10);break;case 112:w(ue,F.getHours()<12?N.AM:N.PM);break;case 114:Re(S,ue,N.formats.r,F);break;case 115:w(ue,ce(String(Math.floor(F/1e3))));break;case 116:x(ue,8);break;case 117:{let z=F.getDay();w(ue,ce(String(z===0?7:z)));break}case 119:w(ue,ce(String(F.getDay())));break;case 120:Re(S,ue,N.formats.x,F);break;case 121:q(ue,F.getFullYear()%100,48);break;case 122:{let z=F.getTimezoneOffset();z>0?x(ue,45):(z=-z,x(ue,43)),q(ue,Math.floor(z/60),48),q(ue,z%60,48);break}}Le+=A}},ar=function(S,ue,p){let F=nr,Le=0,A=1;for(;Le<F.length&&A<=ue.length-p;Le+=A)if(F[Le]===124)A++;else if(U(ue.subarray(p,p+A),F.subarray(Le,Le+A)))return A;Y(S,1,we(S,ce("invalid conversion specifier '%%%s'"),ue))},Je=function(S,ue){return ee(S,ue)},ke={date:function(S){let ue=Fe(S,1,"%c"),p=H(S,2)?new Date:new Date(1e3*Je(S,2)),F=!1,Le=0;if(ue[Le]===33&&(F=!0,Le++),ue[Le]===42&&ue[Le+1]===116)K(S,0,9),rr(S,p,F);else{new Uint8Array(4)[0]=37;let A=new Ye;X(S,A),Re(S,A,ue,p),k(A)}return 1},difftime:function(S){let ue=Je(S,1),p=Je(S,2);return se(S,ue-p),1},time:function(S){let ue;return H(S,1)?ue=new Date:(Ke(S,1,g),ye(S,1),ue=new Date(R(S,"year",-1,0),R(S,"month",-1,1),R(S,"day",-1,0),R(S,"hour",12,0),R(S,"min",0,0),R(S,"sec",0,0)),rr(S,ue)),pe(S,Math.floor(ue/1e3)),1},clock:function(S){return se(S,performance.now()/1e3),1}};e.exports.luaopen_os=function(S){return me(S,ke),1}},function(e,hr,h){const{sprintf:b}=h(38),{LUA_INTEGER_FMT:g,LUA_INTEGER_FRMLEN:V,LUA_MININTEGER:K,LUA_NUMBER_FMT:_e,LUA_NUMBER_FRMLEN:He,frexp:H,lua_getlocaledecpoint:fe}=h(3),{LUA_TBOOLEAN:B,LUA_TFUNCTION:we,LUA_TNIL:pe,LUA_TNUMBER:he,LUA_TSTRING:j,LUA_TTABLE:se,lua_call:$,lua_createtable:Ve,lua_dump:ye,lua_gettable:Ge,lua_gettop:Me,lua_isinteger:Ye,lua_isstring:x,lua_pop:w,lua_pushcclosure:Y,lua_pushinteger:X,lua_pushlightuserdata:ee,lua_pushliteral:Ne,lua_pushlstring:Ke,lua_pushnil:je,lua_pushnumber:I,lua_pushstring:Z,lua_pushvalue:me,lua_remove:W,lua_setfield:Fe,lua_setmetatable:d,lua_settop:k,lua_toboolean:U,lua_tointeger:oe,lua_tonumber:ce,lua_tostring:nr,lua_touserdata:ze,lua_type:rr,lua_upvalueindex:tr}=h(2),{luaL_Buffer:R,luaL_addchar:N,luaL_addlstring:de,luaL_addsize:q,luaL_addstring:Re,luaL_addvalue:ar,luaL_argcheck:Je,luaL_argerror:ke,luaL_buffinit:S,luaL_buffinitsize:ue,luaL_checkinteger:p,luaL_checknumber:F,luaL_checkstack:Le,luaL_checkstring:A,luaL_checktype:z,luaL_error:le,luaL_newlib:sr,luaL_optinteger:or,luaL_optstring:ir,luaL_prepbuffsize:Ur,luaL_pushresult:Sr,luaL_pushresultsize:Rr,luaL_tolstring:Cr,luaL_typename:_}=h(7),Oe=h(17),{luastring_eq:be,luastring_indexOf:ge,to_jsstring:ae,to_luastring:ie}=h(5),Ce=37,Lr=function(t){let v=ge(t,0);return v>-1?v:t.length},dr=function(t,v){return t>=0?t:0-t>v?0:v+t+1},xr=function(t,v,O,G){return de(G,v,O),0},Mr=He.length+1,Qe=function(t,v,O){let G=(function(C){if(Object.is(C,1/0))return ie("inf");if(Object.is(C,-1/0))return ie("-inf");if(Number.isNaN(C))return ie("nan");if(C===0){let D=b(_e+"x0p+0",C);return Object.is(C,-0)&&(D="-"+D),ie(D)}{let D="",$e=H(C),fr=$e[0],gr=$e[1];return fr<0&&(D+="-",fr=-fr),D+="0x",D+=(2*fr).toString(16),D+=b("p%+d",gr-=1),ie(D)}})(O);if(v[Mr]===65)for(let C=0;C<G.length;C++){let D=G[C];D>=97&&(G[C]=223&D)}else v[Mr]!==97&&le(t,ie("modifiers for format '%%a'/'%%A' not implemented"));return G},lr=ie("-+ #0"),br=t=>97<=t&&t<=122||65<=t&&t<=90,r=t=>48<=t&&t<=57,n=t=>0<=t&&t<=31||t===127,l=t=>33<=t&&t<=126,a=t=>97<=t&&t<=122,u=t=>65<=t&&t<=90,f=t=>97<=t&&t<=122||65<=t&&t<=90||48<=t&&t<=57,s=t=>l(t)&&!f(t),m=t=>t===32||t>=9&&t<=13,xe=t=>48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102,Be=function(t,v,O){switch(rr(t,O)){case j:{let G=nr(t,O);(function(C,D,$e){N(C,34);let fr=0;for(;$e--;){if(D[fr]===34||D[fr]===92||D[fr]===10)N(C,92),N(C,D[fr]);else if(n(D[fr])){let gr=""+D[fr];r(D[fr+1])&&(gr="0".repeat(3-gr.length)+gr),Re(C,ie("\\"+gr))}else N(C,D[fr]);fr++}N(C,34)})(v,G,G.length);break}case he:{let G;if(Ye(t,O)){let C=oe(t,O);G=ie(b(C===K?"0x%"+V+"x":g,C))}else{let C=ce(t,O);(function(D){if(ge(D,46)<0){let $e=fe(),fr=ge(D,$e);fr&&(D[fr]=46)}})(G=Qe(t,ie(`%${V}a`),C))}Re(v,G);break}case pe:case B:Cr(t,O),ar(v);break;default:ke(t,O,ie("value has no literal form"))}},Ar=function(t,v,O,G){let C=O;for(;v[C]!==0&&ge(lr,v[C])>=0;)C++;C-O>=lr.length&&le(t,ie("invalid format (repeated flags)")),r(v[C])&&C++,r(v[C])&&C++,v[C]===46&&(r(v[++C])&&C++,r(v[C])&&C++),r(v[C])&&le(t,ie("invalid format (width or precision too long)")),G[0]=37;for(let D=0;D<C-O+1;D++)G[D+1]=v[O+D];return C},Tr=function(t,v){let O=t.length,G=v.length,C=t[O-1];for(let D=0;D<G;D++)t[D+O-1]=v[D];t[O+G-1]=C};class y{constructor(v){this.L=v,this.islittle=!0,this.maxalign=1}}const Ue=r,L=function(t,v){if(t.off>=t.s.length||!Ue(t.s[t.off]))return v;{let O=0;do O=10*O+(t.s[t.off++]-48);while(t.off<t.s.length&&Ue(t.s[t.off])&&O<=2147483638e-1);return O}},ne=function(t,v,O){let G=L(v,O);return(G>16||G<=0)&&le(t.L,ie("integral size (%d) out of limits [1,%d]"),G,16),G},M=function(t,v){let O={opt:v.s[v.off++],size:0};switch(O.opt){case 98:return O.size=1,O.opt=0,O;case 66:return O.size=1,O.opt=1,O;case 104:return O.size=2,O.opt=0,O;case 72:return O.size=2,O.opt=1,O;case 108:return O.size=4,O.opt=0,O;case 76:return O.size=4,O.opt=1,O;case 106:return O.size=4,O.opt=0,O;case 74:case 84:return O.size=4,O.opt=1,O;case 102:return O.size=4,O.opt=2,O;case 100:case 110:return O.size=8,O.opt=2,O;case 105:return O.size=ne(t,v,4),O.opt=0,O;case 73:return O.size=ne(t,v,4),O.opt=1,O;case 115:return O.size=ne(t,v,4),O.opt=4,O;case 99:return O.size=L(v,-1),O.size===-1&&le(t.L,ie("missing size for format option 'c'")),O.opt=3,O;case 122:return O.opt=5,O;case 120:return O.size=1,O.opt=6,O;case 88:return O.opt=7,O;case 32:break;case 60:t.islittle=!0;break;case 62:t.islittle=!1;break;case 61:t.islittle=!0;break;case 33:t.maxalign=ne(t,v,8);break;default:le(t.L,ie("invalid format option '%c'"),O.opt)}return O.opt=8,O},Pe=function(t,v,O){let G={opt:NaN,size:NaN,ntoalign:NaN},C=M(t,O);G.size=C.size,G.opt=C.opt;let D=G.size;if(G.opt===7)if(O.off>=O.s.length||O.s[O.off]===0)ke(t.L,1,ie("invalid next option for option 'X'"));else{let $e=M(t,O);D=$e.size,($e=$e.opt)!==3&&D!==0||ke(t.L,1,ie("invalid next option for option 'X'"))}return D<=1||G.opt===3?G.ntoalign=0:(D>t.maxalign&&(D=t.maxalign),(D&D-1)!=0&&ke(t.L,1,ie("format asks for alignment not power of 2")),G.ntoalign=D-(v&D-1)&D-1),G},cr=function(t,v,O,G,C){let D=Ur(t,G);D[O?0:G-1]=255&v;for(let $e=1;$e<G;$e++)v>>=8,D[O?$e:G-1-$e]=255&v;if(C&&G>4)for(let $e=4;$e<G;$e++)D[O?$e:G-1-$e]=255;q(t,G)},_r=function(t,v,O,G,C){let D=0,$e=G<=4?G:4;for(let fr=$e-1;fr>=0;fr--)D<<=8,D|=v[O?fr:G-1-fr];if(G<4){if(C){let fr=1<<8*G-1;D=(D^fr)-fr}}else if(G>4){let fr=!C||D>=0?0:255;for(let gr=$e;gr<G;gr++)v[O?gr:G-1-gr]!==fr&&le(t,ie("%d-byte integer does not fit into Lua Integer"),G)}return D},ur=function(t,v,O,G){Oe.lua_assert(v.length>=G);let C=new DataView(new ArrayBuffer(G));for(let D=0;D<G;D++)C.setUint8(D,v[D],O);return G==4?C.getFloat32(0,O):C.getFloat64(0,O)},kr=ie("^$*+?.([%-");class Vr{constructor(v){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=v,this.matchdepth=NaN,this.level=NaN,this.capture=[]}}const pr=function(t,v){switch(t.p[v++]){case Ce:return v===t.p_end&&le(t.L,ie("malformed pattern (ends with '%%')")),v+1;case 91:t.p[v]===94&&v++;do v===t.p_end&&le(t.L,ie("malformed pattern (missing ']')")),t.p[v++]===Ce&&v<t.p_end&&v++;while(t.p[v]!==93);return v+1;default:return v}},Er=function(t,v){switch(v){case 97:return br(t);case 65:return!br(t);case 99:return n(t);case 67:return!n(t);case 100:return r(t);case 68:return!r(t);case 103:return l(t);case 71:return!l(t);case 108:return a(t);case 76:return!a(t);case 112:return s(t);case 80:return!s(t);case 115:return m(t);case 83:return!m(t);case 117:return u(t);case 85:return!u(t);case 119:return f(t);case 87:return!f(t);case 120:return xe(t);case 88:return!xe(t);case 122:return t===0;case 90:return t!==0;default:return v===t}},vr=function(t,v,O,G){let C=!0;for(t.p[O+1]===94&&(C=!1,O++);++O<G;)if(t.p[O]===Ce){if(O++,Er(v,t.p[O]))return C}else if(t.p[O+1]===45&&O+2<G){if(O+=2,t.p[O-2]<=v&&v<=t.p[O])return C}else if(t.p[O]===v)return C;return!C},wr=function(t,v,O,G){if(v>=t.src_end)return!1;{let C=t.src[v];switch(t.p[O]){case 46:return!0;case Ce:return Er(C,t.p[O+1]);case 91:return vr(t,C,O,G-1);default:return t.p[O]===C}}},Ir=function(t,v,O){if(O>=t.p_end-1&&le(t.L,ie("malformed pattern (missing arguments to '%%b'")),t.src[v]!==t.p[O])return null;{let G=t.p[O],C=t.p[O+1],D=1;for(;++v<t.src_end;)if(t.src[v]===C){if(--D==0)return v+1}else t.src[v]===G&&D++}return null},Fr=function(t,v,O,G){let C=0;for(;wr(t,v+C,O,G);)C++;for(;C>=0;){let D=P(t,v+C,G+1);if(D)return D;C--}return null},Dr=function(t,v,O,G){for(;;){let C=P(t,v,G+1);if(C!==null)return C;if(!wr(t,v,O,G))return null;v++}},jr=function(t,v,O,G){let C,D=t.level;return D>=32&&le(t.L,ie("too many captures")),t.capture[D]=t.capture[D]?t.capture[D]:{},t.capture[D].init=v,t.capture[D].len=G,t.level=D+1,(C=P(t,v,O))===null&&t.level--,C},Gr=function(t,v,O){let G,C=(function(D){let $e=D.level;for($e--;$e>=0;$e--)if(D.capture[$e].len===-1)return $e;return le(D.L,ie("invalid pattern capture"))})(t);return t.capture[C].len=v-t.capture[C].init,(G=P(t,v,O))===null&&(t.capture[C].len=-1),G},c=function(t,v,O){O=(function(C,D){return(D-=49)<0||D>=C.level||C.capture[D].len===-1?le(C.L,ie("invalid capture index %%%d"),D+1):D})(t,O);let G=t.capture[O].len;return t.src_end-v>=G&&(function(C,D,$e,fr,gr){return be(C.subarray(D,D+gr),$e.subarray(fr,fr+gr))})(t.src,t.capture[O].init,t.src,v,G)?v+G:null},P=function(t,v,O){let G=!1,C=!0;for(t.matchdepth--==0&&le(t.L,ie("pattern too complex"));C||G;)if(C=!1,O!==t.p_end)switch(G?void 0:t.p[O]){case 40:v=t.p[O+1]===41?jr(t,v,O+2,-2):jr(t,v,O+1,-1);break;case 41:v=Gr(t,v,O+1);break;case 36:if(O+1!==t.p_end){G=!0;break}v=t.src.length-v==0?v:null;break;case Ce:switch(t.p[O+1]){case 98:(v=Ir(t,v,O+2))!==null&&(O+=4,C=!0);break;case 102:{O+=2,t.p[O]!==91&&le(t.L,ie("missing '[' after '%%f' in pattern"));let D=pr(t,O),$e=v===t.src_init?0:t.src[v-1];if(!vr(t,$e,O,D-1)&&vr(t,v===t.src_end?0:t.src[v],O,D-1)){O=D,C=!0;break}v=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:(v=c(t,v,t.p[O+1]))!==null&&(O+=2,C=!0);break;default:G=!0}break;default:{G=!1;let D=pr(t,O);if(wr(t,v,O,D))switch(t.p[D]){case 63:{let $e;($e=P(t,v+1,D+1))!==null?v=$e:(O=D+1,C=!0);break}case 43:v++;case 42:v=Fr(t,v,O,D);break;case 45:v=Dr(t,v,O,D);break;default:v++,O=D,C=!0}else{if(t.p[D]===42||t.p[D]===63||t.p[D]===45){O=D+1,C=!0;break}v=null}break}}return t.matchdepth++,v},Ee=function(t,v,O,G){if(v>=t.level)v===0?Ke(t.L,t.src.subarray(O,G),G-O):le(t.L,ie("invalid capture index %%%d"),v+1);else{let C=t.capture[v].len;C===-1&&le(t.L,ie("unfinished capture")),C===-2?X(t.L,t.capture[v].init-t.src_init+1):Ke(t.L,t.src.subarray(t.capture[v].init),C)}},Ie=function(t,v,O){let G=t.level===0&&t.src.subarray(v)?1:t.level;Le(t.L,G,"too many captures");for(let C=0;C<G;C++)Ee(t,C,v,O);return G},Ze=function(t,v,O,G,C,D){t.L=v,t.matchdepth=200,t.src=O,t.src_init=0,t.src_end=G,t.p=C,t.p_end=D},ve=function(t){t.level=0,Oe.lua_assert(t.matchdepth===200)},Se=function(t,v){let O=A(t,1),G=A(t,2),C=O.length,D=G.length,$e=dr(or(t,3,1),C);if($e<1)$e=1;else if($e>C+1)return je(t),1;if(v&&(U(t,4)||(function(fr,gr){for(let Nr=0;Nr<gr;Nr++)if(ge(kr,fr[Nr])!==-1)return!1;return!0})(G,D))){let fr=(function(gr,Nr,o){var T=o>>>0,Q=Nr.length;if(Q===0)return T;for(;(T=gr.indexOf(Nr[0],T))!==-1;T++)if(be(gr.subarray(T,T+Q),Nr))return T;return-1})(O.subarray($e-1),G,0);if(fr>-1)return X(t,$e+fr),X(t,$e+fr+D-1),2}else{let fr=new Vr(t),gr=$e-1,Nr=G[0]===94;Nr&&(G=G.subarray(1),D--),Ze(fr,t,O,C,G,D);do{let o;if(ve(fr),(o=P(fr,gr,0))!==null)return v?(X(t,gr+1),X(t,o),Ie(fr,null,0)+2):Ie(fr,gr,o)}while(gr++<fr.src_end&&!Nr)}return je(t),1},Ae=function(t){let v=ze(t,tr(3));v.ms.L=t;for(let O=v.src;O<=v.ms.src_end;O++){let G;if(ve(v.ms),(G=P(v.ms,O,v.p))!==null&&G!==v.lastmatch)return v.src=v.lastmatch=G,Ie(v.ms,O,G)}return 0},Xe=function(t,v,O,G,C){let D=t.L;switch(C){case we:{me(D,3);let $e=Ie(t,O,G);$(D,$e,1);break}case se:Ee(t,0,O,G),Ge(D,3);break;default:return void(function($e,fr,gr,Nr){let o=$e.L,T=nr(o,3),Q=T.length;for(let qe=0;qe<Q;qe++)T[qe]!==Ce?N(fr,T[qe]):r(T[++qe])?T[qe]===48?de(fr,$e.src.subarray(gr,Nr),Nr-gr):(Ee($e,T[qe]-49,gr,Nr),Cr(o,-1),W(o,-2),ar(fr)):(T[qe]!==Ce&&le(o,ie("invalid use of '%c' in replacement string"),Ce),N(fr,T[qe]))})(t,v,O,G)}U(D,-1)?x(D,-1)||le(D,ie("invalid replacement value (a %s)"),_(D,-1)):(w(D,1),Ke(D,t.src.subarray(O,G),G-O)),ar(v)},er={byte:function(t){let v=A(t,1),O=v.length,G=dr(or(t,2,1),O),C=dr(or(t,3,G),O);if(G<1&&(G=1),C>O&&(C=O),G>C)return 0;if(C-G>=Number.MAX_SAFE_INTEGER)return le(t,"string slice too long");let D=C-G+1;Le(t,D,"string slice too long");for(let $e=0;$e<D;$e++)X(t,v[G+$e-1]);return D},char:function(t){let v=Me(t),O=new R,G=ue(t,O,v);for(let C=1;C<=v;C++){let D=p(t,C);Je(t,D>=0&&D<=255,"value out of range"),G[C-1]=D}return Rr(O,v),1},dump:function(t){let v=new R,O=U(t,2);return z(t,1,we),k(t,1),S(t,v),ye(t,xr,v,O)!==0?le(t,ie("unable to dump given function")):(Sr(v),1)},find:function(t){return Se(t,1)},format:function(t){let v=Me(t),O=1,G=A(t,O),C=0,D=new R;for(S(t,D);C<G.length;)if(G[C]!==Ce)N(D,G[C++]);else if(G[++C]===Ce)N(D,G[C++]);else{let $e=[];switch(++O>v&&ke(t,O,ie("no value")),C=Ar(t,G,C,$e),String.fromCharCode(G[C++])){case"c":N(D,p(t,O));break;case"d":case"i":case"o":case"u":case"x":case"X":{let fr=p(t,O);Tr($e,ie(V,!0)),Re(D,ie(b(String.fromCharCode(...$e),fr)));break}case"a":case"A":Tr($e,ie(V,!0)),Re(D,Qe(t,$e,F(t,O)));break;case"e":case"E":case"f":case"g":case"G":{let fr=F(t,O);Tr($e,ie(V,!0)),Re(D,ie(b(String.fromCharCode(...$e),fr)));break}case"q":Be(t,D,O);break;case"s":{let fr=Cr(t,O);$e.length<=2||$e[2]===0?ar(D):(Je(t,fr.length===Lr(fr),O,"string contains zeros"),ge($e,46)<0&&fr.length>=100?ar(D):(Re(D,ie(b(String.fromCharCode(...$e),ae(fr)))),w(t,1)));break}default:return le(t,ie("invalid option '%%%c' to 'format'"),G[C-1])}}return Sr(D),1},gmatch:function(t){let v=A(t,1),O=A(t,2),G=v.length,C=O.length;k(t,2);let D=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Vr}};return ee(t,D),Ze(D.ms,t,v,G,O,C),D.src=0,D.p=0,D.lastmatch=null,Y(t,Ae,3),1},gsub:function(t){let v=A(t,1),O=v.length,G=A(t,2),C=G.length,D=null,$e=rr(t,3),fr=or(t,4,O+1),gr=G[0]===94,Nr=0,o=new Vr(t),T=new R;for(Je(t,$e===he||$e===j||$e===we||$e===se,3,"string/function/table expected"),S(t,T),gr&&(G=G.subarray(1),C--),Ze(o,t,v,O,G,C),v=0,G=0;Nr<fr;){let Q;if(ve(o),(Q=P(o,v,G))!==null&&Q!==D)Nr++,Xe(o,T,v,Q,$e),v=D=Q;else{if(!(v<o.src_end))break;N(T,o.src[v++])}if(gr)break}return de(T,o.src.subarray(v,o.src_end),o.src_end-v),Sr(T),X(t,Nr),2},len:function(t){return X(t,A(t,1).length),1},lower:function(t){let v=A(t,1),O=v.length,G=new Uint8Array(O);for(let C=0;C<O;C++){let D=v[C];u(D)&&(D|=32),G[C]=D}return Z(t,G),1},match:function(t){return Se(t,0)},pack:function(t){let v=new R,O=new y(t),G={s:A(t,1),off:0},C=1,D=0;for(je(t),S(t,v);G.off<G.s.length;){let $e=Pe(O,D,G),fr=$e.opt,gr=$e.size,Nr=$e.ntoalign;for(D+=Nr+gr;Nr-- >0;)N(v,0);switch(C++,fr){case 0:{let o=p(t,C);if(gr<4){let T=1<<8*gr-1;Je(t,-T<=o&&o<T,C,"integer overflow")}cr(v,o,O.islittle,gr,o<0);break}case 1:{let o=p(t,C);gr<4&&Je(t,o>>>0<1<<8*gr,C,"unsigned overflow"),cr(v,o>>>0,O.islittle,gr,!1);break}case 2:{let o=Ur(v,gr),T=F(t,C),Q=new DataView(o.buffer,o.byteOffset,o.byteLength);gr===4?Q.setFloat32(0,T,O.islittle):Q.setFloat64(0,T,O.islittle),q(v,gr);break}case 3:{let o=A(t,C),T=o.length;for(Je(t,T<=gr,C,"string longer than given size"),de(v,o,T);T++<gr;)N(v,0);break}case 4:{let o=A(t,C),T=o.length;Je(t,gr>=4||T<1<<8*gr,C,"string length does not fit in given size"),cr(v,T,O.islittle,gr,0),de(v,o,T),D+=T;break}case 5:{let o=A(t,C),T=o.length;Je(t,ge(o,0)<0,C,"strings contains zeros"),de(v,o,T),N(v,0),D+=T+1;break}case 6:N(v,0);case 7:case 8:C--}}return Sr(v),1},packsize:function(t){let v=new y(t),O={s:A(t,1),off:0},G=0;for(;O.off<O.s.length;){let C=Pe(v,G,O),D=C.opt,$e=C.size,fr=C.ntoalign;switch(Je(t,G<=2147483647-($e+=fr),1,"format result too large"),G+=$e,D){case 4:case 5:ke(t,1,"variable-length format")}}return X(t,G),1},rep:function(t){let v=A(t,1),O=v.length,G=p(t,2),C=ir(t,3,""),D=C.length;if(G<=0)Ne(t,"");else{if(O+D<O||O+D>2147483647/G)return le(t,ie("resulting string too large"));{let $e=G*O+(G-1)*D,fr=new R,gr=ue(t,fr,$e),Nr=0;for(;G-- >1;)gr.set(v,Nr),Nr+=O,D>0&&(gr.set(C,Nr),Nr+=D);gr.set(v,Nr),Rr(fr,$e)}}return 1},reverse:function(t){let v=A(t,1),O=v.length,G=new Uint8Array(O);for(let C=0;C<O;C++)G[C]=v[O-1-C];return Z(t,G),1},sub:function(t){let v=A(t,1),O=v.length,G=dr(p(t,2),O),C=dr(or(t,3,-1),O);return G<1&&(G=1),C>O&&(C=O),G<=C?Z(t,v.subarray(G-1,G-1+(C-G+1))):Ne(t,""),1},unpack:function(t){let v=new y(t),O={s:A(t,1),off:0},G=A(t,2),C=G.length,D=dr(or(t,3,1),C)-1,$e=0;for(Je(t,D<=C&&D>=0,3,"initial position out of string");O.off<O.s.length;){let fr=Pe(v,D,O),gr=fr.opt,Nr=fr.size,o=fr.ntoalign;switch(D+o+Nr>C&&ke(t,2,ie("data string too short")),D+=o,Le(t,2,"too many results"),$e++,gr){case 0:case 1:{let T=_r(t,G.subarray(D),v.islittle,Nr,gr===0);X(t,T);break}case 2:{let T=ur(0,G.subarray(D),v.islittle,Nr);I(t,T);break}case 3:Z(t,G.subarray(D,D+Nr));break;case 4:{let T=_r(t,G.subarray(D),v.islittle,Nr,0);Je(t,D+T+Nr<=C,2,"data string too short"),Z(t,G.subarray(D+Nr,D+Nr+T)),D+=T;break}case 5:{let T=ge(G,0,D);T===-1&&(T=G.length-D),Z(t,G.subarray(D,T)),D=T+1;break}case 7:case 6:case 8:$e--}D+=Nr}return X(t,D+1),$e+1},upper:function(t){let v=A(t,1),O=v.length,G=new Uint8Array(O);for(let C=0;C<O;C++){let D=v[C];a(D)&&(D&=223),G[C]=D}return Z(t,G),1}};e.exports.luaopen_string=function(t){return sr(t,er),(function(v){Ve(v,0,1),Ne(v,""),me(v,-2),d(v,-2),w(v,1),me(v,-2),Fe(v,-2,ie("__index",!0)),w(v,1)})(t),1}},function(e,hr,h){const{lua_gettop:b,lua_pushcfunction:g,lua_pushfstring:V,lua_pushinteger:K,lua_pushnil:_e,lua_pushstring:He,lua_pushvalue:H,lua_setfield:fe,lua_tointeger:B}=h(2),{luaL_Buffer:we,luaL_addvalue:pe,luaL_argcheck:he,luaL_buffinit:j,luaL_checkinteger:se,luaL_checkstack:$,luaL_checkstring:Ve,luaL_error:ye,luaL_newlib:Ge,luaL_optinteger:Me,luaL_pushresult:Ye}=h(7),{luastring_of:x,to_luastring:w}=h(5),Y=function(W){return(192&W)===128},X=function(W,Fe){return W>=0?W:0-W>Fe?0:Fe+W+1},ee=[255,127,2047,65535],Ne=function(W,Fe){let d=W[Fe],k=0;if(d<128)k=d;else{let U=0;for(;64&d;){let oe=W[Fe+ ++U];if((192&oe)!=128)return null;k=k<<6|63&oe,d<<=1}if(k|=(127&d)<<5*U,U>3||k>1114111||k<=ee[U])return null;Fe+=U}return{code:k,pos:Fe+1}},Ke=w("%U"),je=function(W,Fe){let d=se(W,Fe);he(W,0<=d&&d<=1114111,Fe,"value out of range"),V(W,Ke,d)},I=function(W){let Fe=Ve(W,1),d=Fe.length,k=B(W,2)-1;if(k<0)k=0;else if(k<d)for(k++;Y(Fe[k]);)k++;if(k>=d)return 0;{let U=Ne(Fe,k);return U===null||Y(Fe[U.pos])?ye(W,w("invalid UTF-8 code")):(K(W,k+1),K(W,U.code),2)}},Z={char:function(W){let Fe=b(W);if(Fe===1)je(W,1);else{let d=new we;j(W,d);for(let k=1;k<=Fe;k++)je(W,k),pe(d);Ye(d)}return 1},codepoint:function(W){let Fe=Ve(W,1),d=X(Me(W,2,1),Fe.length),k=X(Me(W,3,d),Fe.length);if(he(W,d>=1,2,"out of range"),he(W,k<=Fe.length,3,"out of range"),d>k)return 0;if(k-d>=Number.MAX_SAFE_INTEGER)return ye(W,"string slice too long");let U=k-d+1;for($(W,U,"string slice too long"),U=0,d-=1;d<k;){let oe=Ne(Fe,d);if(oe===null)return ye(W,"invalid UTF-8 code");K(W,oe.code),d=oe.pos,U++}return U},codes:function(W){return Ve(W,1),g(W,I),H(W,1),K(W,0),3},len:function(W){let Fe=0,d=Ve(W,1),k=d.length,U=X(Me(W,2,1),k),oe=X(Me(W,3,-1),k);for(he(W,1<=U&&--U<=k,2,"initial position out of string"),he(W,--oe<k,3,"final position out of string");U<=oe;){let ce=Ne(d,U);if(ce===null)return _e(W),K(W,U+1),2;U=ce.pos,Fe++}return K(W,Fe),1},offset:function(W){let Fe=Ve(W,1),d=se(W,2),k=d>=0?1:Fe.length+1;if(k=X(Me(W,3,k),Fe.length),he(W,1<=k&&--k<=Fe.length,3,"position out of range"),d===0)for(;k>0&&Y(Fe[k]);)k--;else if(Y(Fe[k])&&ye(W,"initial position is a continuation byte"),d<0)for(;d<0&&k>0;){do k--;while(k>0&&Y(Fe[k]));d++}else for(d--;d>0&&k<Fe.length;){do k++;while(Y(Fe[k]));d--}return d===0?K(W,k+1):_e(W),1}},me=x(91,0,45,127,194,45,244,93,91,128,45,191,93,42);e.exports.luaopen_utf8=function(W){return Ge(W,Z),He(W,me),fe(W,-2,w("charpattern",!0)),1}},function(e,hr,h){const{LUA_OPLT:b,LUA_TNUMBER:g,lua_compare:V,lua_gettop:K,lua_isinteger:_e,lua_isnoneornil:He,lua_pushboolean:H,lua_pushinteger:fe,lua_pushliteral:B,lua_pushnil:we,lua_pushnumber:pe,lua_pushvalue:he,lua_setfield:j,lua_settop:se,lua_tointeger:$,lua_tointegerx:Ve,lua_type:ye}=h(2),{luaL_argcheck:Ge,luaL_argerror:Me,luaL_checkany:Ye,luaL_checkinteger:x,luaL_checknumber:w,luaL_error:Y,luaL_newlib:X,luaL_optnumber:ee}=h(7),{LUA_MAXINTEGER:Ne,LUA_MININTEGER:Ke,lua_numbertointeger:je}=h(3),{to_luastring:I}=h(5);let Z;const me=function(){return Z=1103515245*Z+12345&2147483647},W=function(d,k){let U=je(k);U!==!1?fe(d,U):pe(d,k)},Fe={abs:function(d){if(_e(d,1)){let k=$(d,1);k<0&&(k=0|-k),fe(d,k)}else pe(d,Math.abs(w(d,1)));return 1},acos:function(d){return pe(d,Math.acos(w(d,1))),1},asin:function(d){return pe(d,Math.asin(w(d,1))),1},atan:function(d){let k=w(d,1),U=ee(d,2,1);return pe(d,Math.atan2(k,U)),1},ceil:function(d){return _e(d,1)?se(d,1):W(d,Math.ceil(w(d,1))),1},cos:function(d){return pe(d,Math.cos(w(d,1))),1},deg:function(d){return pe(d,w(d,1)*(180/Math.PI)),1},exp:function(d){return pe(d,Math.exp(w(d,1))),1},floor:function(d){return _e(d,1)?se(d,1):W(d,Math.floor(w(d,1))),1},fmod:function(d){if(_e(d,1)&&_e(d,2)){let k=$(d,2);k===0?Me(d,2,"zero"):fe(d,$(d,1)%k|0)}else{let k=w(d,1),U=w(d,2);pe(d,k%U)}return 1},log:function(d){let k,U=w(d,1);if(He(d,2))k=Math.log(U);else{let oe=w(d,2);k=oe===2?Math.log2(U):oe===10?Math.log10(U):Math.log(U)/Math.log(oe)}return pe(d,k),1},max:function(d){let k=K(d),U=1;Ge(d,k>=1,1,"value expected");for(let oe=2;oe<=k;oe++)V(d,U,oe,b)&&(U=oe);return he(d,U),1},min:function(d){let k=K(d),U=1;Ge(d,k>=1,1,"value expected");for(let oe=2;oe<=k;oe++)V(d,oe,U,b)&&(U=oe);return he(d,U),1},modf:function(d){if(_e(d,1))se(d,1),pe(d,0);else{let k=w(d,1),U=k<0?Math.ceil(k):Math.floor(k);W(d,U),pe(d,k===U?0:k-U)}return 2},rad:function(d){return pe(d,w(d,1)*(Math.PI/180)),1},random:function(d){let k,U,oe=Z===void 0?Math.random():me()/2147483648;switch(K(d)){case 0:return pe(d,oe),1;case 1:k=1,U=x(d,1);break;case 2:k=x(d,1),U=x(d,2);break;default:return Y(d,"wrong number of arguments")}return Ge(d,k<=U,1,"interval is empty"),Ge(d,k>=0||U<=Ne+k,1,"interval too large"),oe*=U-k+1,fe(d,Math.floor(oe)+k),1},randomseed:function(d){return(function(k){(Z=0|k)==0&&(Z=1)})(w(d,1)),me(),0},sin:function(d){return pe(d,Math.sin(w(d,1))),1},sqrt:function(d){return pe(d,Math.sqrt(w(d,1))),1},tan:function(d){return pe(d,Math.tan(w(d,1))),1},tointeger:function(d){let k=Ve(d,1);return k!==!1?fe(d,k):(Ye(d,1),we(d)),1},type:function(d){return ye(d,1)===g?_e(d,1)?B(d,"integer"):B(d,"float"):(Ye(d,1),we(d)),1},ult:function(d){let k=x(d,1),U=x(d,2);return H(d,k>=0?U<0||k<U:U<0&&k<U),1}};e.exports.luaopen_math=function(d){return X(d,Fe),pe(d,Math.PI),j(d,-2,I("pi",!0)),pe(d,1/0),j(d,-2,I("huge",!0)),fe(d,Ne),j(d,-2,I("maxinteger",!0)),fe(d,Ke),j(d,-2,I("mininteger",!0)),1}},function(e,hr,h){const{LUA_MASKCALL:b,LUA_MASKCOUNT:g,LUA_MASKLINE:V,LUA_MASKRET:K,LUA_REGISTRYINDEX:_e,LUA_TFUNCTION:He,LUA_TNIL:H,LUA_TTABLE:fe,LUA_TUSERDATA:B,lua_Debug:we,lua_call:pe,lua_checkstack:he,lua_gethook:j,lua_gethookcount:se,lua_gethookmask:$,lua_getinfo:Ve,lua_getlocal:ye,lua_getmetatable:Ge,lua_getstack:Me,lua_getupvalue:Ye,lua_getuservalue:x,lua_insert:w,lua_iscfunction:Y,lua_isfunction:X,lua_isnoneornil:ee,lua_isthread:Ne,lua_newtable:Ke,lua_pcall:je,lua_pop:I,lua_pushboolean:Z,lua_pushfstring:me,lua_pushinteger:W,lua_pushlightuserdata:Fe,lua_pushliteral:d,lua_pushnil:k,lua_pushstring:U,lua_pushvalue:oe,lua_rawgetp:ce,lua_rawsetp:nr,lua_rotate:ze,lua_setfield:rr,lua_sethook:tr,lua_setlocal:R,lua_setmetatable:N,lua_settop:de,lua_setupvalue:q,lua_setuservalue:Re,lua_tojsstring:ar,lua_toproxy:Je,lua_tostring:ke,lua_tothread:S,lua_touserdata:ue,lua_type:p,lua_upvalueid:F,lua_upvaluejoin:Le,lua_xmove:A}=h(2),{luaL_argcheck:z,luaL_argerror:le,luaL_checkany:sr,luaL_checkinteger:or,luaL_checkstring:ir,luaL_checktype:Ur,luaL_error:Sr,luaL_loadbuffer:Rr,luaL_newlib:Cr,luaL_optinteger:_,luaL_optstring:Oe,luaL_traceback:be,lua_writestringerror:ge}=h(7),ae=h(17),{luastring_indexOf:ie,to_luastring:Ce}=h(5),Lr=function(s,m,xe){s===m||he(m,xe)||Sr(s,Ce("stack overflow",!0))},dr=function(s){return Ne(s,1)?{arg:1,thread:S(s,1)}:{arg:0,thread:s}},xr=function(s,m,xe){U(s,xe),rr(s,-2,m)},Mr=function(s,m,xe){W(s,xe),rr(s,-2,m)},Qe=function(s,m,xe){Z(s,xe),rr(s,-2,m)},lr=function(s,m,xe){s==m?ze(s,-2,1):A(m,s,1),rr(s,-2,xe)},br=function(s,m){let xe=or(s,2);Ur(s,1,He);let Be=m?Ye(s,1,xe):q(s,1,xe);return Be===null?0:(U(s,Be),w(s,-(m+1)),m+1)},r=function(s,m,xe){let Be=or(s,xe);return Ur(s,m,He),z(s,Ye(s,m,Be)!==null,xe,"invalid upvalue index"),Be},n=Ce("__hooks__",!0),l=["call","return","line","count","tail call"].map(s=>Ce(s)),a=function(s,m){ce(s,_e,n);let xe=ue(s,-1).get(s);xe&&(xe(s),U(s,l[m.event]),m.currentline>=0?W(s,m.currentline):k(s),ae.lua_assert(Ve(s,Ce("lS"),m)),pe(s,2,0))},u={gethook:function(s){let m=dr(s).thread,xe=new Uint8Array(5),Be=$(m),Ar=j(m);return Ar===null?k(s):Ar!==a?d(s,"external hook"):(ce(s,_e,n),ue(s,-1).get(m)(s)),U(s,(function(Tr,y){let Ue=0;return Tr&b&&(y[Ue++]=99),Tr&K&&(y[Ue++]=114),Tr&V&&(y[Ue++]=108),y.subarray(0,Ue)})(Be,xe)),W(s,se(m)),3},getinfo:function(s){let m=new we,xe=dr(s),Be=xe.arg,Ar=xe.thread,Tr=Oe(s,Be+2,"flnStu");if(Lr(s,Ar,3),X(s,Be+1))Tr=me(s,Ce(">%s"),Tr),oe(s,Be+1),A(s,Ar,1);else if(!Me(Ar,or(s,Be+1),m))return k(s),1;return Ve(Ar,Tr,m)||le(s,Be+2,"invalid option"),Ke(s),ie(Tr,83)>-1&&(xr(s,Ce("source",!0),m.source),xr(s,Ce("short_src",!0),m.short_src),Mr(s,Ce("linedefined",!0),m.linedefined),Mr(s,Ce("lastlinedefined",!0),m.lastlinedefined),xr(s,Ce("what",!0),m.what)),ie(Tr,108)>-1&&Mr(s,Ce("currentline",!0),m.currentline),ie(Tr,117)>-1&&(Mr(s,Ce("nups",!0),m.nups),Mr(s,Ce("nparams",!0),m.nparams),Qe(s,Ce("isvararg",!0),m.isvararg)),ie(Tr,110)>-1&&(xr(s,Ce("name",!0),m.name),xr(s,Ce("namewhat",!0),m.namewhat)),ie(Tr,116)>-1&&Qe(s,Ce("istailcall",!0),m.istailcall),ie(Tr,76)>-1&&lr(s,Ar,Ce("activelines",!0)),ie(Tr,102)>-1&&lr(s,Ar,Ce("func",!0)),1},getlocal:function(s){let m=dr(s),xe=m.thread,Be=m.arg,Ar=new we,Tr=or(s,Be+2);if(X(s,Be+1))return oe(s,Be+1),U(s,ye(s,null,Tr)),1;{let y=or(s,Be+1);if(!Me(xe,y,Ar))return le(s,Be+1,"level out of range");Lr(s,xe,1);let Ue=ye(xe,Ar,Tr);return Ue?(A(xe,s,1),U(s,Ue),ze(s,-2,1),2):(k(s),1)}},getmetatable:function(s){return sr(s,1),Ge(s,1)||k(s),1},getregistry:function(s){return oe(s,_e),1},getupvalue:function(s){return br(s,1)},getuservalue:function(s){return p(s,1)!==B?k(s):x(s,1),1},sethook:function(s){let m,xe,Be,Ar,Tr=dr(s),y=Tr.thread,Ue=Tr.arg;if(ee(s,Ue+1))de(s,Ue+1),Be=null,m=0,xe=0;else{const ne=ir(s,Ue+2);Ur(s,Ue+1,He),xe=_(s,Ue+3,0),Be=a,m=(function(M,Pe){let cr=0;return ie(M,99)>-1&&(cr|=b),ie(M,114)>-1&&(cr|=K),ie(M,108)>-1&&(cr|=V),Pe>0&&(cr|=g),cr})(ne,xe)}ce(s,_e,n)===H?(Ar=new WeakMap,Fe(s,Ar),nr(s,_e,n)):Ar=ue(s,-1);let L=Je(s,Ue+1);return Ar.set(y,L),tr(y,Be,m,xe),0},setlocal:function(s){let m=dr(s),xe=m.thread,Be=m.arg,Ar=new we,Tr=or(s,Be+1),y=or(s,Be+2);if(!Me(xe,Tr,Ar))return le(s,Be+1,"level out of range");sr(s,Be+3),de(s,Be+3),Lr(s,xe,1),A(s,xe,1);let Ue=R(xe,Ar,y);return Ue===null&&I(xe,1),U(s,Ue),1},setmetatable:function(s){const m=p(s,2);return z(s,m==H||m==fe,2,"nil or table expected"),de(s,2),N(s,1),1},setupvalue:function(s){return sr(s,3),br(s,0)},setuservalue:function(s){return Ur(s,1,B),sr(s,2),de(s,2),Re(s,1),1},traceback:function(s){let m=dr(s),xe=m.thread,Be=m.arg,Ar=ke(s,Be+1);if(Ar!==null||ee(s,Be+1)){let Tr=_(s,Be+2,s===xe?1:0);be(s,xe,Ar,Tr)}else oe(s,Be+1);return 1},upvalueid:function(s){let m=r(s,1,2);return Fe(s,F(s,1,m)),1},upvaluejoin:function(s){let m=r(s,1,2),xe=r(s,3,4);return z(s,!Y(s,1),1,"Lua function expected"),z(s,!Y(s,3),3,"Lua function expected"),Le(s,1,m,3,xe),0}};let f;typeof window<"u"&&(f=function(){let s=prompt("lua_debug>","");return s!==null?s:""}),f&&(u.debug=function(s){for(;;){let m=f();if(m==="cont")return 0;if(m.length===0)continue;let xe=Ce(m);(Rr(s,xe,xe.length,Ce("=(debug command)",!0))||je(s,0,0,0))&&ge(ar(s,-1),`
`),de(s,0)}}),e.exports.luaopen_debug=function(s){return Cr(s,u),1}},function(e,hr,h){const{LUA_DIRSEP:b,LUA_EXEC_DIR:g,LUA_JSPATH_DEFAULT:V,LUA_PATH_DEFAULT:K,LUA_PATH_MARK:_e,LUA_PATH_SEP:He}=h(3),{LUA_OK:H,LUA_REGISTRYINDEX:fe,LUA_TNIL:B,LUA_TTABLE:we,lua_callk:pe,lua_createtable:he,lua_getfield:j,lua_insert:se,lua_isfunction:$,lua_isnil:Ve,lua_isstring:ye,lua_newtable:Ge,lua_pop:Me,lua_pushboolean:Ye,lua_pushcclosure:x,lua_pushcfunction:w,lua_pushfstring:Y,lua_pushglobaltable:X,lua_pushlightuserdata:ee,lua_pushliteral:Ne,lua_pushlstring:Ke,lua_pushnil:je,lua_pushstring:I,lua_pushvalue:Z,lua_rawgeti:me,lua_rawgetp:W,lua_rawseti:Fe,lua_rawsetp:d,lua_remove:k,lua_setfield:U,lua_setmetatable:oe,lua_settop:ce,lua_toboolean:nr,lua_tostring:ze,lua_touserdata:rr,lua_upvalueindex:tr}=h(2),{LUA_LOADED_TABLE:R,LUA_PRELOAD_TABLE:N,luaL_Buffer:de,luaL_addvalue:q,luaL_buffinit:Re,luaL_checkstring:ar,luaL_error:Je,luaL_getsubtable:ke,luaL_gsub:S,luaL_len:ue,luaL_loadfile:p,luaL_newlib:F,luaL_optstring:Le,luaL_pushresult:A,luaL_setfuncs:z}=h(7),le=h(17),{luastring_indexOf:sr,to_jsstring:or,to_luastring:ir,to_uristring:Ur}=h(5),Sr=h(0),Rr=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),Cr=ir("__JSLIBS__"),_=b,Oe=b,be=ir("luaopen_"),ge=ir("_"),ae=ir("");let ie;ie=function(y,Ue,L){Ue=Ur(Ue);let ne=new XMLHttpRequest;if(ne.open("GET",Ue,!1),ne.send(),ne.status<200||ne.status>=300)return I(y,ir(`${ne.status}: ${ne.statusText}`)),null;let M,Pe=ne.response;/\/\/[#@] sourceURL=/.test(Pe)||(Pe+=" //# sourceURL="+Ue);try{M=Function("fengari",Pe)}catch(_r){return I(y,ir(`${_r.name}: ${_r.message}`)),null}let cr=M(Sr);return typeof cr=="function"||typeof cr=="object"&&cr!==null?cr:cr===void 0?Rr:(I(y,ir(`library returned unexpected type (${typeof cr})`)),null)};let Ce;Ce=function(y){y=Ur(y);let Ue=new XMLHttpRequest;return Ue.open("GET",y,!1),Ue.send(),Ue.status>=200&&Ue.status<=299};const Lr=function(y,Ue,L){let ne=Mr(y,Ue);if(ne===null){if((ne=ie(y,Ue,L[0]===42))===null)return 1;Qe(y,Ue,ne)}if(L[0]===42)return Ye(y,1),0;{let M=(function(Pe,cr,_r){let ur=cr[or(_r)];return ur&&typeof ur=="function"?ur:(Y(Pe,ir("undefined symbol: %s"),_r),null)})(y,ne,L);return M===null?2:(w(y,M),0)}},dr=Rr,xr=function(y,Ue,L,ne){let M=`${L}${le.LUA_VERSUFFIX}`;I(y,ir(M));let Pe=dr[M];Pe===void 0&&(Pe=dr[L]),Pe===void 0||(function(cr){j(cr,fe,ir("LUA_NOENV"));let _r=nr(cr,-1);return Me(cr,1),_r})(y)?I(y,ne):(Pe=S(y,ir(Pe),ir(He+He,!0),ir(He+or(ae)+He,!0)),S(y,Pe,ae,ne),k(y,-2)),U(y,-3,Ue),Me(y,1)},Mr=function(y,Ue){W(y,fe,Cr),j(y,-1,Ue);let L=rr(y,-1);return Me(y,2),L},Qe=function(y,Ue,L){W(y,fe,Cr),ee(y,L),Z(y,-1),U(y,-3,Ue),Fe(y,-2,ue(y,-2)+1),Me(y,1)},lr=function(y,Ue){for(;Ue[0]===He.charCodeAt(0);)Ue=Ue.subarray(1);if(Ue.length===0)return null;let L=sr(Ue,He.charCodeAt(0));return L<0&&(L=Ue.length),Ke(y,Ue,L),Ue.subarray(L)},br=function(y,Ue,L,ne,M){let Pe=new de;for(Re(y,Pe),ne[0]!==0&&(Ue=S(y,Ue,ne,M));(L=lr(y,L))!==null;){let cr=S(y,ze(y,-1),ir(_e,!0),Ue);if(k(y,-2),Ce(cr))return cr;Y(y,ir(`
	no file '%s'`),cr),k(y,-2),q(Pe)}return A(Pe),null},r=function(y,Ue,L,ne){j(y,tr(1),L);let M=ze(y,-1);return M===null&&Je(y,ir("'package.%s' must be a string"),L),br(y,Ue,M,ir("."),ne)},n=function(y,Ue,L){return Ue?(I(y,L),2):Je(y,ir(`error loading module '%s' from file '%s':
	%s`),ze(y,1),L,ze(y,-1))},l=function(y){let Ue=ar(y,1),L=r(y,Ue,ir("path",!0),ir(Oe,!0));return L===null?1:n(y,p(y,L)===H,L)},a=function(y,Ue,L){let ne;L=S(y,L,ir("."),ge);let M=sr(L,45);if(M>=0){ne=Ke(y,L,M),ne=Y(y,ir("%s%s"),be,ne);let Pe=Lr(y,Ue,ne);if(Pe!==2)return Pe;L=M+1}return ne=Y(y,ir("%s%s"),be,L),Lr(y,Ue,ne)},u=function(y){let Ue=ar(y,1),L=r(y,Ue,ir("jspath",!0),ir(_,!0));return L===null?1:n(y,a(y,L,Ue)===0,L)},f=function(y){let Ue,L=ar(y,1),ne=sr(L,46);if(ne<0)return 0;Ke(y,L,ne);let M=r(y,ze(y,-1),ir("jspath",!0),ir(_,!0));return M===null?1:(Ue=a(y,M,L))!==0?Ue!=2?n(y,0,M):(I(y,ir(`
	no module '%s' in file '%s'`),L,M),1):(I(y,M),2)},s=function(y){let Ue=ar(y,1);return j(y,fe,N),j(y,-1,Ue)===B&&Y(y,ir(`
	no field package.preload['%s']`),Ue),1},m=function(y,Ue,L){for(;Ue===H?(me(y,3,L.i)===B&&(Me(y,1),A(L.msg),Je(y,ir("module '%s' not found:%s"),L.name,ze(y,-1))),I(y,L.name),pe(y,1,2,L,m)):Ue=H,!$(y,-2);L.i++)ye(y,-2)?(Me(y,1),q(L.msg)):Me(y,2);return L.k(y,H,L.ctx)},xe=function(y,Ue,L){return I(y,L),se(y,-2),pe(y,2,1,L,Be),Be(y,H,L)},Be=function(y,Ue,L){let ne=L;return Ve(y,-1)||U(y,2,ne),j(y,2,ne)==B&&(Ye(y,1),Z(y,-1),U(y,2,ne)),1},Ar={loadlib:function(y){let Ue=ar(y,1),L=ar(y,2),ne=Lr(y,Ue,L);return ne===0?1:(je(y),se(y,-2),Ne(y,ne===1?"open":"init"),3)},searchpath:function(y){return br(y,ar(y,1),ar(y,2),Le(y,3,"."),Le(y,4,b))!==null?1:(je(y),se(y,-2),2)}},Tr={require:function(y){let Ue=ar(y,1);return ce(y,1),j(y,fe,R),j(y,2,Ue),nr(y,-1)?1:(Me(y,1),(function(L,ne,M,Pe){let cr=new de;return Re(L,cr),j(L,tr(1),ir("searchers",!0))!==we&&Je(L,ir("'package.searchers' must be a table")),m(L,H,{name:ne,i:1,msg:cr,ctx:M,k:Pe})})(y,Ue,Ue,xe))}};e.exports.luaopen_package=function(y){return(function(Ue){Ge(Ue),he(Ue,0,1),oe(Ue,-2),d(Ue,fe,Cr)})(y),F(y,Ar),(function(Ue){let L=[s,l,u,f,null];he(Ue);for(let ne=0;L[ne];ne++)Z(Ue,-2),x(Ue,L[ne],1),Fe(Ue,-2,ne+1);U(Ue,-2,ir("searchers",!0))})(y),xr(y,ir("path",!0),"LUA_PATH",K),xr(y,ir("jspath",!0),"LUA_JSPATH",V),Ne(y,b+`
`+He+`
`+_e+`
`+g+`
-
`),U(y,-2,ir("config",!0)),ke(y,fe,R),U(y,-2,ir("loaded",!0)),ke(y,fe,N),U(y,-2,ir("preload",!0)),X(y),Z(y,-2),z(y,Tr,1),Me(y,1),1}},function(e,hr,h){const{lua_pushinteger:b,lua_pushliteral:g,lua_setfield:V}=h(2),{luaL_newlib:K}=h(7),{FENGARI_AUTHORS:_e,FENGARI_COPYRIGHT:He,FENGARI_RELEASE:H,FENGARI_VERSION:fe,FENGARI_VERSION_MAJOR:B,FENGARI_VERSION_MINOR:we,FENGARI_VERSION_NUM:pe,FENGARI_VERSION_RELEASE:he,to_luastring:j}=h(5);e.exports.luaopen_fengari=function(se){return K(se,{}),g(se,_e),V(se,-2,j("AUTHORS")),g(se,He),V(se,-2,j("COPYRIGHT")),g(se,H),V(se,-2,j("RELEASE")),g(se,fe),V(se,-2,j("VERSION")),g(se,B),V(se,-2,j("VERSION_MAJOR")),g(se,we),V(se,-2,j("VERSION_MINOR")),b(se,pe),V(se,-2,j("VERSION_NUM")),g(se,he),V(se,-2,j("VERSION_RELEASE")),1}},function(e,hr,h){h.r(hr),h.d(hr,"L",function(){return Ke}),h.d(hr,"load",function(){return je});var b=h(0);h.d(hr,"FENGARI_AUTHORS",function(){return b.FENGARI_AUTHORS}),h.d(hr,"FENGARI_COPYRIGHT",function(){return b.FENGARI_COPYRIGHT}),h.d(hr,"FENGARI_RELEASE",function(){return b.FENGARI_RELEASE}),h.d(hr,"FENGARI_VERSION",function(){return b.FENGARI_VERSION}),h.d(hr,"FENGARI_VERSION_MAJOR",function(){return b.FENGARI_VERSION_MAJOR}),h.d(hr,"FENGARI_VERSION_MINOR",function(){return b.FENGARI_VERSION_MINOR}),h.d(hr,"FENGARI_VERSION_NUM",function(){return b.FENGARI_VERSION_NUM}),h.d(hr,"FENGARI_VERSION_RELEASE",function(){return b.FENGARI_VERSION_RELEASE}),h.d(hr,"luastring_eq",function(){return b.luastring_eq}),h.d(hr,"luastring_indexOf",function(){return b.luastring_indexOf}),h.d(hr,"luastring_of",function(){return b.luastring_of}),h.d(hr,"to_jsstring",function(){return b.to_jsstring}),h.d(hr,"to_luastring",function(){return b.to_luastring}),h.d(hr,"to_uristring",function(){return b.to_uristring}),h.d(hr,"lua",function(){return b.lua}),h.d(hr,"lauxlib",function(){return b.lauxlib}),h.d(hr,"lualib",function(){return b.lualib});var g=h(21);h.d(hr,"interop",function(){return g});const{LUA_ERRRUN:V,LUA_ERRSYNTAX:K,LUA_OK:_e,LUA_VERSION_MAJOR:He,LUA_VERSION_MINOR:H,lua_Debug:fe,lua_getinfo:B,lua_getstack:we,lua_gettop:pe,lua_insert:he,lua_pcall:j,lua_pop:se,lua_pushcfunction:$,lua_pushstring:Ve,lua_remove:ye,lua_setglobal:Ge,lua_tojsstring:Me}=b.lua,{luaL_loadbuffer:Ye,luaL_newstate:x,luaL_requiref:w}=b.lauxlib,{checkjs:Y,luaopen_js:X,push:ee,tojs:Ne}=g,Ke=x();function je(I,Z){if(typeof I=="string")I=Object(b.to_luastring)(I);else if(!(I instanceof Uint8Array))throw new TypeError("expects an array of bytes or javascript string");Z=Z?Object(b.to_luastring)(Z):null;let me,W=Ye(Ke,I,null,Z);if(me=W===K?new SyntaxError(Me(Ke,-1)):Ne(Ke,-1),se(Ke,1),W!==_e)throw me;return me}if(b.lualib.luaL_openlibs(Ke),w(Ke,Object(b.to_luastring)("js"),X,1),se(Ke,1),Ve(Ke,Object(b.to_luastring)(b.FENGARI_COPYRIGHT)),Ge(Ke,Object(b.to_luastring)("_COPYRIGHT")),typeof document<"u"&&document instanceof HTMLDocument){const I=function(ce){switch(ce){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},Z=function(ce){let nr=new fe;return we(ce,2,nr)&&B(ce,Object(b.to_luastring)("Sl"),nr),ee(ce,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:Me(ce,1),error:Ne(ce,1),filename:nr.short_src?Object(b.to_jsstring)(nr.short_src):void 0,lineno:nr.currentline>0?nr.currentline:void 0})),1},me=function(ce,nr,ze){let rr,tr=Ye(Ke,nr,null,ze);if(tr===K){let R=Me(Ke,-1),N=ce.src?ce.src:document.location,de,q=new SyntaxError(R,N,de);rr=new ErrorEvent("error",{message:R,error:q,filename:N,lineno:de})}else if(tr===_e){let R=pe(Ke);$(Ke,Z),he(Ke,R),Object.defineProperty(document,"currentScript",{value:ce,configurable:!0}),tr=j(Ke,0,0,R),delete document.currentScript,ye(Ke,R),tr===V&&(rr=Y(Ke,-1))}tr!==_e&&(rr===void 0&&(rr=new ErrorEvent("error",{message:Me(Ke,-1),error:Ne(Ke,-1)})),se(Ke,1),window.dispatchEvent(rr)&&console.error("uncaught exception",rr.error))},W=function(ce,nr,ze){if(ce.status>=200&&ce.status<300){let rr=ce.response;rr=typeof rr=="string"?Object(b.to_luastring)(ce.response):new Uint8Array(rr),me(nr,rr,ze)}else nr.dispatchEvent(new Event("error"))},Fe=function(ce){if(ce.src){let nr=Object(b.to_luastring)("@"+ce.src);if(document.readyState==="complete"||ce.async)if(typeof fetch=="function")fetch(ce.src,{method:"GET",credentials:I(ce.crossorigin),redirect:"follow",integrity:ce.integrity}).then(function(ze){if(ze.ok)return ze.arrayBuffer();throw new Error("unable to fetch")}).then(function(ze){let rr=new Uint8Array(ze);me(ce,rr,nr)}).catch(function(ze){ce.dispatchEvent(new Event("error"))});else{let ze=new XMLHttpRequest;ze.open("GET",ce.src,!0),ze.responseType="arraybuffer",ze.onreadystatechange=function(){ze.readyState===4&&W(ze,ce,nr)},ze.send()}else{let ze=new XMLHttpRequest;ze.open("GET",ce.src,!1),ze.send(),W(ze,ce,nr)}}else{let nr=Object(b.to_luastring)(ce.innerHTML),ze=ce.id?Object(b.to_luastring)("="+ce.id):nr;me(ce,nr,ze)}},d=/^(.*?\/.*?)([\t ]*;.*)?$/,k=/^(\d+)\.(\d+)$/,U=function(ce){if(ce.tagName!=="SCRIPT")return;let nr=d.exec(ce.type);if(!nr)return;let ze=nr[1];if(ze==="application/lua"||ze==="text/lua"){if(ce.hasAttribute("lua-version")){let rr=k.exec(ce.getAttribute("lua-version"));if(!rr||rr[1]!==He||rr[2]!==H)return}Fe(ce)}};typeof MutationObserver<"u"?new MutationObserver(function(ce,nr){for(let ze=0;ze<ce.length;ze++){let rr=ce[ze];for(let tr=0;tr<rr.addedNodes.length;tr++)U(rr.addedNodes[tr])}}).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted"),Array.prototype.forEach.call(document.querySelectorAll('script[type^="application/lua"], script[type^="text/lua"]'),U)}},function(e,hr,h){const{LUA_MULTRET:b,LUA_OPADD:g,LUA_OPBAND:V,LUA_OPBNOT:K,LUA_OPBOR:_e,LUA_OPBXOR:He,LUA_OPDIV:H,LUA_OPIDIV:fe,LUA_OPMOD:B,LUA_OPSHL:we,LUA_OPSHR:pe,LUA_OPUNM:he,constant_types:{LUA_TBOOLEAN:j,LUA_TLIGHTUSERDATA:se,LUA_TLNGSTR:$,LUA_TNIL:Ve,LUA_TNUMFLT:ye,LUA_TNUMINT:Ge,LUA_TTABLE:Me},to_luastring:Ye}=h(1),{lua_assert:x}=h(4),w=h(20),Y=h(6),X=h(16),ee=h(23),Ne=h(9),Ke=h(15),je=X.OpCodesI,I=Y.TValue,Z={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},me={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},W=function(a){return a.t!==a.f},Fe=function(a,u){let f=ee.expkind;if(W(a))return!1;switch(a.k){case f.VKINT:return!u||new I(Ge,a.u.ival);case f.VKFLT:return!u||new I(ye,a.u.nval);default:return!1}},d=function(a,u,f){let s,m=u+f-1;if(a.pc>a.lasttarget&&(s=a.f.code[a.pc-1]).opcode===je.OP_LOADNIL){let xe=s.A,Be=xe+s.B;if(xe<=u&&u<=Be+1||u<=xe&&xe<=m+1)return xe<u&&(u=xe),Be>m&&(m=Be),X.SETARG_A(s,u),void X.SETARG_B(s,m-u)}ke(a,je.OP_LOADNIL,u,f-1,0)},k=function(a,u){return a.f.code[u.u.info]},U=function(a,u){let f=a.f.code[u].sBx;return f===-1?-1:u+1+f},oe=function(a,u,f){let s=a.f.code[u],m=f-(u+1);x(f!==-1),Math.abs(m)>X.MAXARG_sBx&&w.luaX_syntaxerror(a.ls,Ye("control structure too long",!0)),X.SETARG_sBx(s,m)},ce=function(a,u,f){if(f===-1)return u;if(u===-1)u=f;else{let s=u,m=U(a,s);for(;m!==-1;)m=U(a,s=m);oe(a,s,f)}return u},nr=function(a){let u=a.jpc;a.jpc=-1;let f=ue(a,je.OP_JMP,0,-1);return f=ce(a,f,u)},ze=function(a,u,f,s,m){return ke(a,u,f,s,m),nr(a)},rr=function(a){return a.lasttarget=a.pc,a.pc},tr=function(a,u){return u>=1&&X.testTMode(a.f.code[u-1].opcode)?u-1:u},R=function(a,u){return a.f.code[tr(a,u)]},N=function(a,u,f){let s=tr(a,u),m=a.f.code[s];return m.opcode===je.OP_TESTSET&&(f!==X.NO_REG&&f!==m.B?X.SETARG_A(m,f):a.f.code[s]=X.CREATE_ABC(je.OP_TEST,m.B,0,m.C),!0)},de=function(a,u){for(;u!==-1;u=U(a,u))N(a,u,X.NO_REG)},q=function(a,u,f,s,m){for(;u!==-1;){let xe=U(a,u);N(a,u,s)?oe(a,u,f):oe(a,u,m),u=xe}},Re=function(a,u){rr(a),a.jpc=ce(a,a.jpc,u)},ar=function(a,u,f){f===a.pc?Re(a,u):(x(f<a.pc),q(a,u,f,X.NO_REG,f))},Je=function(a,u){let f=a.f;return(function(s){q(s,s.jpc,s.pc,X.NO_REG,s.pc),s.jpc=-1})(a),f.code[a.pc]=u,f.lineinfo[a.pc]=a.ls.lastline,a.pc++},ke=function(a,u,f,s,m){return x(X.getOpMode(u)===X.iABC),x(X.getBMode(u)!==X.OpArgN||s===0),x(X.getCMode(u)!==X.OpArgN||m===0),x(f<=X.MAXARG_A&&s<=X.MAXARG_B&&m<=X.MAXARG_C),Je(a,X.CREATE_ABC(u,f,s,m))},S=function(a,u,f,s){return x(X.getOpMode(u)===X.iABx||X.getOpMode(u)===X.iAsBx),x(X.getCMode(u)===X.OpArgN),x(f<=X.MAXARG_A&&s<=X.MAXARG_Bx),Je(a,X.CREATE_ABx(u,f,s))},ue=function(a,u,f,s){return S(a,u,f,s+X.MAXARG_sBx)},p=function(a,u){return x(u<=X.MAXARG_Ax),Je(a,X.CREATE_Ax(je.OP_EXTRAARG,u))},F=function(a,u,f){if(f<=X.MAXARG_Bx)return S(a,je.OP_LOADK,u,f);{let s=S(a,je.OP_LOADKX,u,0);return p(a,f),s}},Le=function(a,u){let f=a.freereg+u;f>a.f.maxstacksize&&(f>=255&&w.luaX_syntaxerror(a.ls,Ye("function or expression needs too many registers",!0)),a.f.maxstacksize=f)},A=function(a,u){Le(a,u),a.freereg+=u},z=function(a,u){!X.ISK(u)&&u>=a.nactvar&&(a.freereg--,x(u===a.freereg))},le=function(a,u){u.k===ee.expkind.VNONRELOC&&z(a,u.u.info)},sr=function(a,u,f){let s=u.k===ee.expkind.VNONRELOC?u.u.info:-1,m=f.k===ee.expkind.VNONRELOC?f.u.info:-1;s>m?(z(a,s),z(a,m)):(z(a,m),z(a,s))},or=function(a,u,f){let s=a.f,m=Ne.luaH_get(a.L,a.ls.h,u);if(m.ttisinteger()){let Be=m.value;if(Be<a.nk&&s.k[Be].ttype()===f.ttype()&&s.k[Be].value===f.value)return Be}let xe=a.nk;return Ne.luaH_setfrom(a.L,a.ls.h,u,new Y.TValue(Ge,xe)),s.k[xe]=f,a.nk++,xe},ir=function(a,u){let f=new I(se,u),s=new I(Ge,u);return or(a,f,s)},Ur=function(a,u){let f=new I(ye,u);return or(a,f,f)},Sr=function(a,u){let f=new I(j,u);return or(a,f,f)},Rr=function(a,u,f){let s=ee.expkind;if(u.k===s.VCALL)X.SETARG_C(k(a,u),f+1);else if(u.k===s.VVARARG){let m=k(a,u);X.SETARG_B(m,f+1),X.SETARG_A(m,a.freereg),A(a,1)}else x(f===b)},Cr=function(a,u){let f=ee.expkind;u.k===f.VCALL?(x(k(a,u).C===2),u.k=f.VNONRELOC,u.u.info=k(a,u).A):u.k===f.VVARARG&&(X.SETARG_B(k(a,u),2),u.k=f.VRELOCABLE)},_=function(a,u){let f=ee.expkind;switch(u.k){case f.VLOCAL:u.k=f.VNONRELOC;break;case f.VUPVAL:u.u.info=ke(a,je.OP_GETUPVAL,0,u.u.info,0),u.k=f.VRELOCABLE;break;case f.VINDEXED:{let s;z(a,u.u.ind.idx),u.u.ind.vt===f.VLOCAL?(z(a,u.u.ind.t),s=je.OP_GETTABLE):(x(u.u.ind.vt===f.VUPVAL),s=je.OP_GETTABUP),u.u.info=ke(a,s,0,u.u.ind.t,u.u.ind.idx),u.k=f.VRELOCABLE;break}case f.VVARARG:case f.VCALL:Cr(a,u)}},Oe=function(a,u,f,s){return rr(a),ke(a,je.OP_LOADBOOL,u,f,s)},be=function(a,u,f){let s=ee.expkind;switch(_(a,u),u.k){case s.VNIL:d(a,f,1);break;case s.VFALSE:case s.VTRUE:ke(a,je.OP_LOADBOOL,f,u.k===s.VTRUE,0);break;case s.VK:F(a,f,u.u.info);break;case s.VKFLT:F(a,f,Ur(a,u.u.nval));break;case s.VKINT:F(a,f,ir(a,u.u.ival));break;case s.VRELOCABLE:{let m=k(a,u);X.SETARG_A(m,f);break}case s.VNONRELOC:f!==u.u.info&&ke(a,je.OP_MOVE,f,u.u.info,0);break;default:return void x(u.k===s.VJMP)}u.u.info=f,u.k=s.VNONRELOC},ge=function(a,u){u.k!==ee.expkind.VNONRELOC&&(A(a,1),be(a,u,a.freereg-1))},ae=function(a,u){for(;u!==-1;u=U(a,u))if(R(a,u).opcode!==je.OP_TESTSET)return!0;return!1},ie=function(a,u,f){let s=ee.expkind;if(be(a,u,f),u.k===s.VJMP&&(u.t=ce(a,u.t,u.u.info)),W(u)){let m,xe=-1,Be=-1;if(ae(a,u.t)||ae(a,u.f)){let Ar=u.k===s.VJMP?-1:nr(a);xe=Oe(a,f,0,1),Be=Oe(a,f,1,0),Re(a,Ar)}m=rr(a),q(a,u.f,m,f,xe),q(a,u.t,m,f,Be)}u.f=u.t=-1,u.u.info=f,u.k=s.VNONRELOC},Ce=function(a,u){_(a,u),le(a,u),A(a,1),ie(a,u,a.freereg-1)},Lr=function(a,u){if(_(a,u),u.k===ee.expkind.VNONRELOC){if(!W(u))return u.u.info;if(u.u.info>=a.nactvar)return ie(a,u,u.u.info),u.u.info}return Ce(a,u),u.u.info},dr=function(a,u){W(u)?Lr(a,u):_(a,u)},xr=function(a,u){let f=ee.expkind,s=!1;switch(dr(a,u),u.k){case f.VTRUE:u.u.info=Sr(a,!0),s=!0;break;case f.VFALSE:u.u.info=Sr(a,!1),s=!0;break;case f.VNIL:u.u.info=(function(m){let xe=new I(Ve,null),Be=new I(Me,m.ls.h);return or(m,Be,xe)})(a),s=!0;break;case f.VKINT:u.u.info=ir(a,u.u.ival),s=!0;break;case f.VKFLT:u.u.info=Ur(a,u.u.nval),s=!0;break;case f.VK:s=!0}return s&&(u.k=f.VK,u.u.info<=X.MAXINDEXRK)?X.RKASK(u.u.info):Lr(a,u)},Mr=function(a,u){let f=R(a,u.u.info);x(X.testTMode(f.opcode)&&f.opcode!==je.OP_TESTSET&&f.opcode!==je.OP_TEST),X.SETARG_A(f,!f.A)},Qe=function(a,u,f){if(u.k===ee.expkind.VRELOCABLE){let s=k(a,u);if(s.opcode===je.OP_NOT)return a.pc--,ze(a,je.OP_TEST,s.B,0,!f)}return ge(a,u),le(a,u),ze(a,je.OP_TESTSET,X.NO_REG,u.u.info,f)},lr=function(a,u){let f,s=ee.expkind;switch(_(a,u),u.k){case s.VJMP:Mr(a,u),f=u.u.info;break;case s.VK:case s.VKFLT:case s.VKINT:case s.VTRUE:f=-1;break;default:f=Qe(a,u,0)}u.f=ce(a,u.f,f),Re(a,u.t),u.t=-1},br=function(a,u){let f,s=ee.expkind;switch(_(a,u),u.k){case s.VJMP:f=u.u.info;break;case s.VNIL:case s.VFALSE:f=-1;break;default:f=Qe(a,u,1)}u.t=ce(a,u.t,f),Re(a,u.f),u.f=-1},r=function(a,u,f){let s,m,xe=ee.expkind;if(!(s=Fe(u,!0))||!(m=Fe(f,!0))||!(function(Ar,Tr,y){switch(Ar){case V:case _e:case He:case we:case pe:case K:return Ke.tointeger(Tr)!==!1&&Ke.tointeger(y)!==!1;case H:case fe:case B:return y.value!==0;default:return 1}})(a,s,m))return 0;let Be=new I;if(Y.luaO_arith(null,a,s,m,Be),Be.ttisinteger())u.k=xe.VKINT,u.u.ival=Be.value;else{let Ar=Be.value;if(isNaN(Ar)||Ar===0)return!1;u.k=xe.VKFLT,u.u.nval=Ar}return!0},n=function(a,u,f,s,m){let xe=xr(a,s),Be=xr(a,f);sr(a,f,s),f.u.info=ke(a,u,0,Be,xe),f.k=ee.expkind.VRELOCABLE,l(a,m)},l=function(a,u){a.f.lineinfo[a.pc-1]=u};e.exports.BinOpr=Z,e.exports.NO_JUMP=-1,e.exports.UnOpr=me,e.exports.getinstruction=k,e.exports.luaK_checkstack=Le,e.exports.luaK_code=Je,e.exports.luaK_codeABC=ke,e.exports.luaK_codeABx=S,e.exports.luaK_codeAsBx=ue,e.exports.luaK_codek=F,e.exports.luaK_concat=ce,e.exports.luaK_dischargevars=_,e.exports.luaK_exp2RK=xr,e.exports.luaK_exp2anyreg=Lr,e.exports.luaK_exp2anyregup=function(a,u){(u.k!==ee.expkind.VUPVAL||W(u))&&Lr(a,u)},e.exports.luaK_exp2nextreg=Ce,e.exports.luaK_exp2val=dr,e.exports.luaK_fixline=l,e.exports.luaK_getlabel=rr,e.exports.luaK_goiffalse=br,e.exports.luaK_goiftrue=lr,e.exports.luaK_indexed=function(a,u,f){let s=ee.expkind;x(!W(u)&&(ee.vkisinreg(u.k)||u.k===s.VUPVAL)),u.u.ind.t=u.u.info,u.u.ind.idx=xr(a,f),u.u.ind.vt=u.k===s.VUPVAL?s.VUPVAL:s.VLOCAL,u.k=s.VINDEXED},e.exports.luaK_infix=function(a,u,f){switch(u){case Z.OPR_AND:lr(a,f);break;case Z.OPR_OR:br(a,f);break;case Z.OPR_CONCAT:Ce(a,f);break;case Z.OPR_ADD:case Z.OPR_SUB:case Z.OPR_MUL:case Z.OPR_DIV:case Z.OPR_IDIV:case Z.OPR_MOD:case Z.OPR_POW:case Z.OPR_BAND:case Z.OPR_BOR:case Z.OPR_BXOR:case Z.OPR_SHL:case Z.OPR_SHR:Fe(f,!1)||xr(a,f);break;default:xr(a,f)}},e.exports.luaK_intK=ir,e.exports.luaK_jump=nr,e.exports.luaK_jumpto=function(a,u){return ar(a,nr(a),u)},e.exports.luaK_nil=d,e.exports.luaK_numberK=Ur,e.exports.luaK_patchclose=function(a,u,f){for(f++;u!==-1;u=U(a,u)){let s=a.f.code[u];x(s.opcode===je.OP_JMP&&(s.A===0||s.A>=f)),X.SETARG_A(s,f)}},e.exports.luaK_patchlist=ar,e.exports.luaK_patchtohere=Re,e.exports.luaK_posfix=function(a,u,f,s,m){let xe=ee.expkind;switch(u){case Z.OPR_AND:x(f.t===-1),_(a,s),s.f=ce(a,s.f,f.f),f.to(s);break;case Z.OPR_OR:x(f.f===-1),_(a,s),s.t=ce(a,s.t,f.t),f.to(s);break;case Z.OPR_CONCAT:{dr(a,s);let Be=k(a,s);s.k===xe.VRELOCABLE&&Be.opcode===je.OP_CONCAT?(x(f.u.info===Be.B-1),le(a,f),X.SETARG_B(Be,f.u.info),f.k=xe.VRELOCABLE,f.u.info=s.u.info):(Ce(a,s),n(a,je.OP_CONCAT,f,s,m));break}case Z.OPR_ADD:case Z.OPR_SUB:case Z.OPR_MUL:case Z.OPR_DIV:case Z.OPR_IDIV:case Z.OPR_MOD:case Z.OPR_POW:case Z.OPR_BAND:case Z.OPR_BOR:case Z.OPR_BXOR:case Z.OPR_SHL:case Z.OPR_SHR:r(u+g,f,s)||n(a,u+je.OP_ADD,f,s,m);break;case Z.OPR_EQ:case Z.OPR_LT:case Z.OPR_LE:case Z.OPR_NE:case Z.OPR_GT:case Z.OPR_GE:(function(Be,Ar,Tr,y){let Ue,L=ee.expkind;Tr.k===L.VK?Ue=X.RKASK(Tr.u.info):(x(Tr.k===L.VNONRELOC),Ue=Tr.u.info);let ne=xr(Be,y);switch(sr(Be,Tr,y),Ar){case Z.OPR_NE:Tr.u.info=ze(Be,je.OP_EQ,0,Ue,ne);break;case Z.OPR_GT:case Z.OPR_GE:{let M=Ar-Z.OPR_NE+je.OP_EQ;Tr.u.info=ze(Be,M,1,ne,Ue);break}default:{let M=Ar-Z.OPR_EQ+je.OP_EQ;Tr.u.info=ze(Be,M,1,Ue,ne);break}}Tr.k=L.VJMP})(a,u,f,s)}return f},e.exports.luaK_prefix=function(a,u,f,s){let m=new ee.expdesc;switch(m.k=ee.expkind.VKINT,m.u.ival=m.u.nval=m.u.info=0,m.t=-1,m.f=-1,u){case me.OPR_MINUS:case me.OPR_BNOT:if(r(u+he,f,m))break;case me.OPR_LEN:(function(xe,Be,Ar,Tr){let y=Lr(xe,Ar);le(xe,Ar),Ar.u.info=ke(xe,Be,0,y,0),Ar.k=ee.expkind.VRELOCABLE,l(xe,Tr)})(a,u+je.OP_UNM,f,s);break;case me.OPR_NOT:(function(xe,Be){let Ar=ee.expkind;switch(_(xe,Be),Be.k){case Ar.VNIL:case Ar.VFALSE:Be.k=Ar.VTRUE;break;case Ar.VK:case Ar.VKFLT:case Ar.VKINT:case Ar.VTRUE:Be.k=Ar.VFALSE;break;case Ar.VJMP:Mr(xe,Be);break;case Ar.VRELOCABLE:case Ar.VNONRELOC:ge(xe,Be),le(xe,Be),Be.u.info=ke(xe,je.OP_NOT,0,Be.u.info,0),Be.k=Ar.VRELOCABLE}{let Tr=Be.f;Be.f=Be.t,Be.t=Tr}de(xe,Be.f),de(xe,Be.t)})(a,f)}},e.exports.luaK_reserveregs=A,e.exports.luaK_ret=function(a,u,f){ke(a,je.OP_RETURN,u,f+1,0)},e.exports.luaK_self=function(a,u,f){Lr(a,u);let s=u.u.info;le(a,u),u.u.info=a.freereg,u.k=ee.expkind.VNONRELOC,A(a,2),ke(a,je.OP_SELF,u.u.info,s,xr(a,f)),le(a,f)},e.exports.luaK_setlist=function(a,u,f,s){let m=(f-1)/X.LFIELDS_PER_FLUSH+1,xe=s===b?0:s;x(s!==0&&s<=X.LFIELDS_PER_FLUSH),m<=X.MAXARG_C?ke(a,je.OP_SETLIST,u,xe,m):m<=X.MAXARG_Ax?(ke(a,je.OP_SETLIST,u,xe,0),p(a,m)):w.luaX_syntaxerror(a.ls,Ye("constructor too long",!0)),a.freereg=u+1},e.exports.luaK_setmultret=function(a,u){Rr(a,u,b)},e.exports.luaK_setoneret=Cr,e.exports.luaK_setreturns=Rr,e.exports.luaK_storevar=function(a,u,f){let s=ee.expkind;switch(u.k){case s.VLOCAL:return le(a,f),void ie(a,f,u.u.info);case s.VUPVAL:{let m=Lr(a,f);ke(a,je.OP_SETUPVAL,m,u.u.info,0);break}case s.VINDEXED:{let m=u.u.ind.vt===s.VLOCAL?je.OP_SETTABLE:je.OP_SETTABUP,xe=xr(a,f);ke(a,m,u.u.ind.t,u.u.ind.idx,xe);break}}le(a,f)},e.exports.luaK_stringK=function(a,u){let f=new I($,u);return or(a,f,f)}},function(e,hr,h){const{LUA_SIGNATURE:b,constant_types:{LUA_TBOOLEAN:g,LUA_TLNGSTR:V,LUA_TNIL:K,LUA_TNUMFLT:_e,LUA_TNUMINT:He,LUA_TSHRSTR:H},thread_status:{LUA_ERRSYNTAX:fe},is_luastring:B,luastring_eq:we,to_luastring:pe}=h(1),he=h(8),j=h(13),se=h(6),{MAXARG_sBx:$,POS_A:Ve,POS_Ax:ye,POS_B:Ge,POS_Bx:Me,POS_C:Ye,POS_OP:x,SIZE_A:w,SIZE_Ax:Y,SIZE_B:X,SIZE_Bx:ee,SIZE_C:Ne,SIZE_OP:Ke}=h(16),{lua_assert:je}=h(4),{luaS_bless:I}=h(10),{luaZ_read:Z,ZIO:me}=h(19);let W=[25,147,13,10,26,10];class Fe{constructor(k,U,oe){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,je(U instanceof me,"BytecodeParser only operates on a ZIO"),je(B(oe)),oe[0]===64||oe[0]===61?this.name=oe.subarray(1):oe[0]==b[0]?this.name=pe("binary string",!0):this.name=oe,this.L=k,this.Z=U,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(k){let U=new Uint8Array(k);return Z(this.Z,U,0,k)!==0&&this.error("truncated"),U}LoadByte(){return Z(this.Z,this.u8,0,1)!==0&&this.error("truncated"),this.u8[0]}LoadInt(){return Z(this.Z,this.u8,0,this.intSize)!==0&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return Z(this.Z,this.u8,0,this.numberSize)!==0&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return Z(this.Z,this.u8,0,this.integerSize)!==0&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let k=this.LoadByte();return k===255&&(k=this.LoadSize_t()),k===0?null:I(this.L,this.read(k-1))}static MASK1(k,U){return~(-1<<k)<<U}LoadCode(k){let U=this.LoadInt(),oe=Fe;for(let ce=0;ce<U;ce++){Z(this.Z,this.u8,0,this.instructionSize)!==0&&this.error("truncated");let nr=this.dv.getUint32(0,!0);k.code[ce]={code:nr,opcode:nr>>x&oe.MASK1(Ke,0),A:nr>>Ve&oe.MASK1(w,0),B:nr>>Ge&oe.MASK1(X,0),C:nr>>Ye&oe.MASK1(Ne,0),Bx:nr>>Me&oe.MASK1(ee,0),Ax:nr>>ye&oe.MASK1(Y,0),sBx:(nr>>Me&oe.MASK1(ee,0))-$}}}LoadConstants(k){let U=this.LoadInt();for(let oe=0;oe<U;oe++){let ce=this.LoadByte();switch(ce){case K:k.k.push(new se.TValue(K,null));break;case g:k.k.push(new se.TValue(g,this.LoadByte()!==0));break;case _e:k.k.push(new se.TValue(_e,this.LoadNumber()));break;case He:k.k.push(new se.TValue(He,this.LoadInteger()));break;case H:case V:k.k.push(new se.TValue(V,this.LoadString()));break;default:this.error(`unrecognized constant '${ce}'`)}}}LoadProtos(k){let U=this.LoadInt();for(let oe=0;oe<U;oe++)k.p[oe]=new j.Proto(this.L),this.LoadFunction(k.p[oe],k.source)}LoadUpvalues(k){let U=this.LoadInt();for(let oe=0;oe<U;oe++)k.upvalues[oe]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(k){let U=this.LoadInt();for(let oe=0;oe<U;oe++)k.lineinfo[oe]=this.LoadInt();U=this.LoadInt();for(let oe=0;oe<U;oe++)k.locvars[oe]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};U=this.LoadInt();for(let oe=0;oe<U;oe++)k.upvalues[oe].name=this.LoadString()}LoadFunction(k,U){k.source=this.LoadString(),k.source===null&&(k.source=U),k.linedefined=this.LoadInt(),k.lastlinedefined=this.LoadInt(),k.numparams=this.LoadByte(),k.is_vararg=this.LoadByte()!==0,k.maxstacksize=this.LoadByte(),this.LoadCode(k),this.LoadConstants(k),this.LoadUpvalues(k),this.LoadProtos(k),this.LoadDebug(k)}checkliteral(k,U){let oe=this.read(k.length);we(oe,k)||this.error(U)}checkHeader(){this.checkliteral(b.subarray(1),"not a"),this.LoadByte()!==83&&this.error("version mismatch in"),this.LoadByte()!==0&&this.error("format mismatch in"),this.checkliteral(W,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),this.LoadInteger()!==22136&&this.error("endianness mismatch in"),this.LoadNumber()!==370.5&&this.error("float format mismatch in")}error(k){se.luaO_pushfstring(this.L,pe("%s: %s precompiled chunk"),this.name,pe(k)),he.luaD_throw(this.L,fe)}checksize(k,U,oe){k!==U&&this.error(`${oe} size mismatch in`)}}e.exports.luaU_undump=function(d,k,U){let oe=new Fe(d,k,U);oe.checkHeader();let ce=j.luaF_newLclosure(d,oe.LoadByte());return he.luaD_inctop(d),d.stack[d.top-1].setclLvalue(ce),ce.p=new j.Proto(d),oe.LoadFunction(ce.p,null),je(ce.nupvalues===ce.p.upvalues.length),ce}},function(e,hr,h){const{LUA_SIGNATURE:b,LUA_VERSION_MAJOR:g,LUA_VERSION_MINOR:V,constant_types:{LUA_TBOOLEAN:K,LUA_TLNGSTR:_e,LUA_TNIL:He,LUA_TNUMFLT:H,LUA_TNUMINT:fe,LUA_TSHRSTR:B},luastring_of:we}=h(1),pe=we(25,147,13,10,26,10),he=16*Number(g)+Number(V),j=function(Ye,x,w){w.status===0&&x>0&&(w.status=w.writer(w.L,Ye,x,w.data))},se=function(Ye,x){j(we(Ye),1,x)},$=function(Ye,x){let w=new ArrayBuffer(4);new DataView(w).setInt32(0,Ye,!0);let Y=new Uint8Array(w);j(Y,4,x)},Ve=function(Ye,x){let w=new ArrayBuffer(4);new DataView(w).setInt32(0,Ye,!0);let Y=new Uint8Array(w);j(Y,4,x)},ye=function(Ye,x){let w=new ArrayBuffer(8);new DataView(w).setFloat64(0,Ye,!0);let Y=new Uint8Array(w);j(Y,8,x)},Ge=function(Ye,x){if(Ye===null)se(0,x);else{let w=Ye.tsslen()+1,Y=Ye.getstr();w<255?se(w,x):(se(255,x),Ve(w,x)),j(Y,w-1,x)}},Me=function(Ye,x,w){w.strip||Ye.source===x?Ge(null,w):Ge(Ye.source,w),$(Ye.linedefined,w),$(Ye.lastlinedefined,w),se(Ye.numparams,w),se(Ye.is_vararg?1:0,w),se(Ye.maxstacksize,w),(function(Y,X){let ee=Y.code.map(Ne=>Ne.code);$(ee.length,X);for(let Ne=0;Ne<ee.length;Ne++)$(ee[Ne],X)})(Ye,w),(function(Y,X){let ee=Y.k.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++){let Ke=Y.k[Ne];switch(se(Ke.ttype(),X),Ke.ttype()){case He:break;case K:se(Ke.value?1:0,X);break;case H:ye(Ke.value,X);break;case fe:Ve(Ke.value,X);break;case B:case _e:Ge(Ke.tsvalue(),X)}}})(Ye,w),(function(Y,X){let ee=Y.upvalues.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++)se(Y.upvalues[Ne].instack?1:0,X),se(Y.upvalues[Ne].idx,X)})(Ye,w),(function(Y,X){let ee=Y.p.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++)Me(Y.p[Ne],Y.source,X)})(Ye,w),(function(Y,X){let ee=X.strip?0:Y.lineinfo.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++)$(Y.lineinfo[Ne],X);ee=X.strip?0:Y.locvars.length,$(ee,X);for(let Ne=0;Ne<ee;Ne++)Ge(Y.locvars[Ne].varname,X),$(Y.locvars[Ne].startpc,X),$(Y.locvars[Ne].endpc,X);ee=X.strip?0:Y.upvalues.length,$(ee,X);for(let Ne=0;Ne<ee;Ne++)Ge(Y.upvalues[Ne].name,X)})(Ye,w)};e.exports.luaU_dump=function(Ye,x,w,Y,X){let ee=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return ee.L=Ye,ee.writer=w,ee.data=Y,ee.strip=X,ee.status=0,(function(Ne){j(b,b.length,Ne),se(he,Ne),se(0,Ne),j(pe,pe.length,Ne),se(4,Ne),se(4,Ne),se(4,Ne),se(4,Ne),se(8,Ne),Ve(22136,Ne),ye(370.5,Ne)})(ee),se(x.upvalues.length,ee),Me(x,null,ee),ee.status}},function(e,hr,h){var b;(function(){var g={not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function V(He){return(function(H,fe){var B,we,pe,he,j,se,$,Ve,ye,Ge=1,Me=H.length,Ye="";for(we=0;we<Me;we++)if(typeof H[we]=="string")Ye+=H[we];else if(Array.isArray(H[we])){if((he=H[we])[2])for(B=fe[Ge],pe=0;pe<he[2].length;pe++){if(!B.hasOwnProperty(he[2][pe]))throw new Error(V('[sprintf] property "%s" does not exist',he[2][pe]));B=B[he[2][pe]]}else B=he[1]?fe[he[1]]:fe[Ge++];if(g.not_type.test(he[8])&&g.not_primitive.test(he[8])&&B instanceof Function&&(B=B()),g.numeric_arg.test(he[8])&&typeof B!="number"&&isNaN(B))throw new TypeError(V("[sprintf] expecting number but found %T",B));switch(g.number.test(he[8])&&(Ve=B>=0),he[8]){case"b":B=parseInt(B,10).toString(2);break;case"c":B=String.fromCharCode(parseInt(B,10));break;case"d":case"i":B=parseInt(B,10);break;case"j":B=JSON.stringify(B,null,he[6]?parseInt(he[6]):0);break;case"e":B=he[7]?parseFloat(B).toExponential(he[7]):parseFloat(B).toExponential();break;case"f":B=he[7]?parseFloat(B).toFixed(he[7]):parseFloat(B);break;case"g":B=he[7]?String(Number(B.toPrecision(he[7]))):parseFloat(B);break;case"o":B=(parseInt(B,10)>>>0).toString(8);break;case"s":B=String(B),B=he[7]?B.substring(0,he[7]):B;break;case"t":B=String(!!B),B=he[7]?B.substring(0,he[7]):B;break;case"T":B=Object.prototype.toString.call(B).slice(8,-1).toLowerCase(),B=he[7]?B.substring(0,he[7]):B;break;case"u":B=parseInt(B,10)>>>0;break;case"v":B=B.valueOf(),B=he[7]?B.substring(0,he[7]):B;break;case"x":B=(parseInt(B,10)>>>0).toString(16);break;case"X":B=(parseInt(B,10)>>>0).toString(16).toUpperCase()}g.json.test(he[8])?Ye+=B:(!g.number.test(he[8])||Ve&&!he[3]?ye="":(ye=Ve?"+":"-",B=B.toString().replace(g.sign,"")),se=he[4]?he[4]==="0"?"0":he[4].charAt(1):" ",$=he[6]-(ye+B).length,j=he[6]&&$>0?se.repeat($):"",Ye+=he[5]?ye+B+j:se==="0"?ye+j+B:j+ye+B)}return Ye})((function(H){if(_e[H])return _e[H];for(var fe,B=H,we=[],pe=0;B;){if((fe=g.text.exec(B))!==null)we.push(fe[0]);else if((fe=g.modulo.exec(B))!==null)we.push("%");else{if((fe=g.placeholder.exec(B))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(fe[2]){pe|=1;var he=[],j=fe[2],se=[];if((se=g.key.exec(j))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(he.push(se[1]);(j=j.substring(se[0].length))!=="";)if((se=g.key_access.exec(j))!==null)he.push(se[1]);else{if((se=g.index_access.exec(j))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");he.push(se[1])}fe[2]=he}else pe|=2;if(pe===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");we.push(fe)}B=B.substring(fe[0].length)}return _e[H]=we})(He),arguments)}function K(He,H){return V.apply(null,[He].concat(H||[]))}var _e=Object.create(null);hr.sprintf=V,hr.vsprintf=K,typeof window<"u"&&(window.sprintf=V,window.vsprintf=K,(b=(function(){return{sprintf:V,vsprintf:K}}).call(hr,h,hr,e))===void 0||(e.exports=b))})()},function(e,hr,h){const{lua_pop:b}=h(2),{luaL_requiref:g}=h(7),{to_luastring:V}=h(5),K={};e.exports.luaL_openlibs=function(Ve){for(let ye in K)g(Ve,V(ye),K[ye],1),b(Ve,1)};const _e=h(17),{luaopen_base:He}=h(24),{luaopen_coroutine:H}=h(25),{luaopen_debug:fe}=h(31),{luaopen_math:B}=h(30),{luaopen_package:we}=h(32),{luaopen_os:pe}=h(27),{luaopen_string:he}=h(28),{luaopen_table:j}=h(26),{luaopen_utf8:se}=h(29);K._G=He,K[_e.LUA_LOADLIBNAME]=we,K[_e.LUA_COLIBNAME]=H,K[_e.LUA_TABLIBNAME]=j,K[_e.LUA_OSLIBNAME]=pe,K[_e.LUA_STRLIBNAME]=he,K[_e.LUA_MATHLIBNAME]=B,K[_e.LUA_UTF8LIBNAME]=se,K[_e.LUA_DBLIBNAME]=fe;const{luaopen_fengari:$}=h(33);K[_e.LUA_FENGARILIBNAME]=$}])),tn}var Qr=Tn();const{LUA_ERRRUN:xn,LUA_ERRSYNTAX:bn,LUA_OK:On,LUA_VERSION_MAJOR:kn,LUA_VERSION_MINOR:vn,LUA_REGISTRYINDEX:En,lua_Debug:Un,lua_getinfo:mn,lua_getstack:Nn,lua_gettop:Rn,lua_insert:Sn,lua_pcall:wn,lua_pop:In,lua_pushcfunction:yn,lua_remove:Mn,lua_setglobal:Pn,lua_tojsstring:Cn,lua_atnativeerror:Dn,lua_getglobal:Vn,lua_rawgeti:Bn,thread_status:Gn,to_jsstring:Kn,to_luastring:Fn}=Qr.lua,{lua_register:jn,lua_pushinteger:Hn,lua_pushnumber:Xn,lua_pushstring:zn,lua_pushlightuserdata:Yn,lua_touserdata:Jn,lua_pushboolean:qn,lua_pushnil:Zn,lua_toboolean:Wn}=Qr.lua,{luaL_checknumber:Qn,luaL_loadstring:$n,luaL_newstate:ea,luaL_tolstring:ra,luaL_loadbuffer:na,luaL_requiref:aa,luaL_checkstring:ta,luaL_checkinteger:ua,luaL_ref:la,luaL_unref:sa}=Qr.lauxlib,{lua_resume:oa,lua_yield:ia}=Qr.lua,{lua_newthread:ca}=Qr.lua;export{$n as A,Fn as B,En as L,ua as a,Yn as b,Zn as c,ta as d,Hn as e,zn as f,Qn as g,Xn as h,Jn as i,Wn as j,qn as k,jn as l,la as m,sa as n,ia as o,ca as p,ea as q,Dn as r,Bn as s,oa as t,Gn as u,Kn as v,ra as w,In as x,Vn as y,wn as z};
